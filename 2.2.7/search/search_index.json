{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"ads-tec Industrial IT JSON-RPC API","text":"<p>JSON-RPC 2.0 API for ads-tec Industrial IT devices over HTTPS. This documentation covers the full device API and provides a Python reference implementation.</p>"},{"location":"#supported-devices","title":"Supported Devices","text":"Device Family Models Firmware Version Firewalls IRF1000, IRF2000, IRF3000 IRF 2.2.7 Web Terminals All ads-tec Web terminals AWT 14.2.7"},{"location":"#api-capabilities","title":"API Capabilities","text":"<ul> <li>Authentication \u2014 Session-based login with SID management</li> <li>Configuration \u2014 Read and write device configuration variables with transactional sessions</li> <li>Status Monitoring \u2014 Query device status properties (firmware version, CPU stats, network state, etc.)</li> <li>Table Operations \u2014 CRUD operations on device tables (users, routing, etc.)</li> <li>File Transfer \u2014 Upload firmware, certificates, settings; download diagnostics and backups</li> <li>GPIO Control \u2014 Read digital inputs and control LEDs (firewall models)</li> <li>Password Strength \u2014 Validate passwords using the built-in zxcvbn algorithm</li> </ul>"},{"location":"#quick-example-python-reference-implementation","title":"Quick Example (Python Reference Implementation)","text":"<pre><code>import jsonrpcdevice\n\n# Connect to device\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# Query status\nversion = dev.status(\"imageversion\")\nprint(f\"Firmware: {version}\")\n\n# Change configuration\ndev.config_set_commit({\"ntp_service\": \"enabled\", \"ntp_server\": \"pool.ntp.org\"})\n\n# Clean up\ndev.logout()\n</code></pre>"},{"location":"#documentation-structure","title":"Documentation Structure","text":"<p>The documentation is organized into three sections by device category:</p> <ul> <li>All Devices \u2014 API reference and guides that apply to every ads-tec Industrial IT device</li> <li>Firewalls (IRF1000 / IRF2000 / IRF3000) \u2014 GPIO, IPsec, OpenVPN, CUT &amp; ALARM, 3G/4G, GNSS</li> <li>Web Terminals \u2014 Web Panel display and browser configuration</li> </ul>"},{"location":"#next-steps","title":"Next Steps","text":"<ul> <li>Getting Started \u2014 Installation and first connection</li> <li>JSON-RPC Methods \u2014 Core API method reference (all devices)</li> <li>JSON Schemas \u2014 Machine-readable request/response schemas</li> <li>Python Reference Implementation \u2014 Python client documentation</li> <li>Firewall Methods \u2014 GPIO and IPsec (firewalls only)</li> <li>Web Terminal Config \u2014 Web Panel (terminals only)</li> </ul>"},{"location":"getting-started/","title":"Getting Started","text":""},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.6+</li> <li>Network access to an ads-tec device</li> <li>Valid device credentials (username and password)</li> </ul>"},{"location":"getting-started/#installation","title":"Installation","text":"<p>Clone the repository:</p> <pre><code>git clone https://github.com/ads-tec/Python-AdstecJSONRPCDevice.git\ncd Python-AdstecJSONRPCDevice\n</code></pre> <p>Install the required dependency:</p> <pre><code>pip install requests\n</code></pre>"},{"location":"getting-started/#first-connection","title":"First Connection","text":"<pre><code>import jsonrpcdevice\n\n# Create a device instance\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\n    target=\"192.168.0.254\",   # Device IP address\n    user=\"admin\",             # Username\n    pw=\"admin\",               # Password\n    timeout=120.0,            # Request timeout in seconds (optional)\n    verify=False              # SSL certificate verification (optional)\n)\n\n# Query the firmware version\nversion = dev.status(\"imageversion\")\nprint(f\"Firmware version: {version}\")\n\n# Always log out when done\ndev.logout()\n</code></pre> <p>SSL Verification</p> <p>By default, SSL certificate verification is disabled (<code>verify=False</code>) because ads-tec devices typically use self-signed certificates. Set <code>verify=True</code> if your device has a trusted certificate installed.</p> <p>Automatic Authentication</p> <p>You do not need to call <code>get_sid()</code> manually. The library automatically authenticates on the first API call.</p>"},{"location":"getting-started/#understanding-configuration-sessions","title":"Understanding Configuration Sessions","text":"<p>Changing device configuration requires a configuration session. This ensures that multiple changes are applied atomically.</p>"},{"location":"getting-started/#manual-session-management","title":"Manual Session Management","text":"<pre><code># 1. Start a session\ncfg_session_id = dev.sess_start()\n\n# 2. Set values within the session\ndev.config_set(cfg_session_id, {\n    \"ntp_service\": \"enabled\",\n    \"ntp_server\": \"pool.ntp.org\"\n})\n\n# 3. Commit the session to apply changes\ndev.sess_commit(cfg_session_id)\n</code></pre>"},{"location":"getting-started/#convenience-method","title":"Convenience Method","text":"<p>For simple changes, use <code>config_set_commit()</code> which handles session management automatically:</p> <pre><code>dev.config_set_commit({\n    \"ntp_service\": \"enabled\",\n    \"ntp_server\": \"pool.ntp.org\"\n})\n</code></pre>"},{"location":"getting-started/#error-handling","title":"Error Handling","text":"<pre><code>try:\n    dev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"wrong_password\")\n    dev.get_sid()\nexcept Exception as e:\n    print(f\"Login failed: {e}\")\n</code></pre>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<ul> <li>JSON-RPC Methods \u2014 Full API method reference</li> <li>Python Reference Implementation \u2014 All methods and parameters</li> <li>Configuration Variables \u2014 Available configuration keys</li> <li>Status Properties \u2014 Available status queries</li> </ul>"},{"location":"api-reference/config-variables/","title":"Configuration Variables","text":"<p>Configuration variables are read with <code>config.get()</code> and written with <code>config.set()</code> within a configuration session.</p>"},{"location":"api-reference/config-variables/#reading-configuration","title":"Reading Configuration","text":"<pre><code>result = dev.config_get([\"lan_ipaddr\", \"timezone\", \"ntp_service\"])\n</code></pre>"},{"location":"api-reference/config-variables/#writing-configuration","title":"Writing Configuration","text":"<pre><code>dev.config_set_commit({\"timezone\": \"Europe/Berlin\", \"ntp_service\": \"enabled\"})\n</code></pre>"},{"location":"api-reference/config-variables/#operation-mode","title":"Operation Mode","text":"Variable Values Description <code>opmode</code> <code>\"transbridge\"</code> / <code>\"iprouter\"</code> / <code>\"iprouter5port\"</code> Device operation mode. <code>transbridge</code> = Layer 2 managed switch; <code>iprouter</code> = Layer 3 LAN/WAN; <code>iprouter5port</code> = Layer 3 all ports with independent IPs <p>Warning</p> <p>Changing <code>opmode</code> has side effects on filter rules and static routes.</p>"},{"location":"api-reference/config-variables/#network","title":"Network","text":""},{"location":"api-reference/config-variables/#interface-configuration","title":"Interface Configuration","text":"<p>Interface variables use a prefix pattern: <code>(wan|lan|lan_port1|lan_port2|lan_port3|lan_port4)_&lt;variable&gt;</code>.</p> Variable Values Description <code>(wan\\|lan\\|lan_port[1-4])_proto</code> <code>\"static\"</code> / <code>\"dhcp\"</code> / <code>\"dhcpstatic\"</code> / <code>\"dhcpovpn\"</code> / <code>\"pppoedyn\"</code> Interface protocol. <code>static</code> = manual config; <code>dhcp</code> = dynamic; <code>dhcpstatic</code> = DHCP with static fallback; <code>dhcpovpn</code> = IP via OpenVPN tunnel; <code>pppoedyn</code> = PPPoE for DSL <code>(wan\\|lan\\|lan_port[1-4])_ipaddr</code> IP address Interface IP address (e.g., <code>\"192.168.0.254\"</code>) <code>(wan\\|lan\\|lan_port[1-4])_netmask</code> Netmask Interface subnet mask (e.g., <code>\"255.255.255.0\"</code>) <code>lan_gateway</code> IP address Default gateway (applies to all interfaces despite the <code>lan_</code> prefix) <code>splitbridge_port[1-4]</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> In <code>iprouter5port</code> mode: whether LAN-out port forms a bridge with LAN-in <p>IP Address Changes</p> <p>When changing <code>lan_ipaddr</code>, use <code>config_set_commit_with_ip_change()</code> in the Python reference implementation. The device becomes unreachable at the old IP after the change. See Networking Guide.</p>"},{"location":"api-reference/config-variables/#dns","title":"DNS","text":"Variable Values Description <code>dns1</code> IP address Primary DNS server <code>dns2</code> IP address Secondary DNS server <code>dns3</code> IP address Tertiary DNS server <code>dns_domain</code> string Local network subdomain (e.g., <code>\"intranet.company.de\"</code>). Auto-appended to bare hostname DNS queries <code>dns_request_all</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Query all DNS servers simultaneously (otherwise sequential with timeout fallover) <code>dns_proxy</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Activate DNS relay service on device <code>gw_dhcp_interface</code> interface name or <code>\"\"</code> Which DHCP interface provides the default gateway <code>dns_dhcp_interface</code> interface name or <code>\"\"</code> Which DHCP interface provides DNS settings"},{"location":"api-reference/config-variables/#pppoe-dsl","title":"PPPoE (DSL)","text":"Variable Values Description <code>wan_pppoe_userid</code> string DSL user ID <code>wan_pppoe_password</code> string DSL password"},{"location":"api-reference/config-variables/#date-time","title":"Date &amp; Time","text":"Variable Values Description <code>timezone</code> string Timezone (e.g., <code>\"Europe/Berlin\"</code>). Query <code>timezone_list</code> status for available values <code>ntp_service</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Enable NTP time synchronization <code>ntp_relay</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Enable NTP relay (device acts as NTP server) <code>ntp_server</code> string Primary NTP server <code>ntp_server2</code> string Secondary NTP server <code>ntp_server3</code> string Tertiary NTP server <code>day</code> string Day of month, zero-padded (e.g., <code>\"01\"</code>) \u2014 only when NTP is disabled <code>month</code> string Month, zero-padded (e.g., <code>\"01\"</code>) <code>year</code> string Year (e.g., <code>\"2026\"</code>) <code>hour</code> string Hour, zero-padded (e.g., <code>\"00\"</code>) <code>minute</code> string Minute, zero-padded (e.g., <code>\"00\"</code>) <code>second</code> string Second, zero-padded (e.g., <code>\"00\"</code>)"},{"location":"api-reference/config-variables/#password-authentication","title":"Password &amp; Authentication","text":"Variable Values Description <code>webpwd_user</code> string Username for the password change operation <code>webpwd_user_old</code> string Current password (required when changing own password) <code>webpwd_user_new</code> string New password <code>webpwd_user_checked</code> string New password confirmation (must match <code>webpwd_user_new</code>) <code>password_mode</code> string Password hashing mode (e.g., <code>\"argon2\"</code>) <code>password_policy</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Enable password policy enforcement"},{"location":"api-reference/config-variables/#firewall-only-variables","title":"Firewall-Only Variables","text":"<p>OpenVPN, CUT &amp; ALARM, GPIO Automatic Control, and 3G/4G UMTS/LTE variables are available on firewall models only. See Configuration Variables (Firewalls).</p>"},{"location":"api-reference/config-variables/#big-linx","title":"Big-LinX","text":""},{"location":"api-reference/config-variables/#connection-configuration","title":"Connection Configuration","text":"Variable Values Description <code>vpn_list_10</code> slash-separated string Big-LinX VPN connection. Last field: <code>\"active\"</code> (permanent) or <code>\"switched\"</code> (triggered remotely) <code>vpn_ida_proxy</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> HTTP proxy for Big-LinX <code>vpn_ida_proxyip</code> IP or hostname Proxy address <code>vpn_ida_proxyport</code> TCP port Proxy port <code>vpn_ida_proxyauth</code> <code>\"ntlm\"</code> / <code>\"basic\"</code> / <code>\"none\"</code> Proxy auth method <code>vpn_ida_proxyuser</code> string Proxy username <code>vpn_ida_proxypass</code> string Proxy password"},{"location":"api-reference/config-variables/#smart-card","title":"Smart Card","text":"Variable Values Description <code>sc_autopin</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Autopin for smart cards <code>sc_savepin</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Must be <code>\"enabled\"</code> for cards without autopin <code>sc_pin</code> string Big-LinX smart card PIN. Legacy only \u2014 older cards required a manually configured PIN. Current cards use auto-PIN and do not need this variable"},{"location":"api-reference/config-variables/#approval-mode-4-eyes-principle","title":"Approval Mode (4-Eyes Principle)","text":"Variable Values Description <code>vpn_approval_mode</code> <code>\"disabled\"</code> / <code>\"vpnswitch\"</code> / <code>\"api\"</code> <code>\"vpnswitch\"</code> = physical key switch required; <code>\"api\"</code> = remote acknowledgement via API <code>vpn_approve_now</code> any Trigger: approve a pending VPN connection"},{"location":"api-reference/config-variables/#scep-certificate-enrollment","title":"SCEP (Certificate Enrollment)","text":"Variable Values Description <code>scep_service</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Activate SCEP service <code>scep_url</code> URL SCEP server API URL <code>scep_sncn</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Include device serial number in certificate CN <code>scep_subject</code> formatted string Format: <code>\"dns:NAME/C=DE, O=ads-tec\"</code> <code>scep_autocrl</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Automatic CRL retrieval from SCEP server <code>scep_autorenew</code> number of days Auto-renew certificate N days before expiry <code>scep_keybits</code> <code>\"1024\"</code> / <code>\"2048\"</code> / <code>\"3072\"</code> / <code>\"4096\"</code> Key length for certificate <code>scep_challenge</code> string One-time challenge password for SCEP server"},{"location":"api-reference/config-variables/#certificates","title":"Certificates","text":"Variable Values Description <code>to_be_deleted</code> string Path of certificate to delete (e.g., <code>\"ca/cert.pem\"</code>) <code>cert_delete</code> <code>\"1\"</code> Trigger certificate deletion <code>upload_cert_file_now</code> any Trigger: process an uploaded certificate file <code>upload_cert_file_sha256</code> SHA256 hex string SHA256 checksum of the uploaded certificate file <code>filename_password</code> string Passphrase for password-protected p12/pem files"},{"location":"api-reference/config-variables/#web-terminal-variables","title":"Web Terminal Variables","text":"<p>Web Panel configuration variables are available on web terminals only. See Configuration Variables (Web Terminals).</p>"},{"location":"api-reference/config-variables/#remote-capture-rpcap","title":"Remote Capture (rpcap)","text":"Variable Values Description <code>rpcap_status</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Enable remote packet capture <code>rpcap_hostlist</code> string Comma-separated list of allowed capture hosts <code>rpcap_access</code> string Space-separated native interface names to block from capture"},{"location":"api-reference/config-variables/#web-server","title":"Web Server","text":"Variable Values Description <code>service_https</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> HTTPS access on port 443 <code>service_http</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> If disabled, both HTTPS (443) and HTTP (80) are disabled <code>service_http_port</code> TCP port HTTP port (default: <code>\"80\"</code>). HTTPS 443 is unaffected"},{"location":"api-reference/config-variables/#system","title":"System","text":""},{"location":"api-reference/config-variables/#general","title":"General","text":"Variable Values Description <code>system_name</code> string Device system name (default: product name) <code>system_contact</code> string Contact information <code>systemname_sndyn</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Use serial number as system name <code>hostname</code> string Network hostname (default: product name) <code>hostname_sndyn</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Use serial number as hostname <code>nvram_mode</code> <code>\"save\"</code> / <code>\"commit\"</code> <code>\"save\"</code> = changes saved persistently, applied after reboot; <code>\"commit\"</code> = changes applied immediately, saved only after <code>save_now</code>"},{"location":"api-reference/config-variables/#firmware-update-from-server","title":"Firmware Update from Server","text":"Variable Values Description <code>update_proto</code> <code>\"http\"</code> / <code>\"ftp\"</code> / <code>\"tftp\"</code> Protocol for firmware download <code>update_server</code> IP address Server providing the firmware <code>update_restoredefaults</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Reset to factory defaults after firmware install <code>fw_update_now</code> any Trigger: start firmware update"},{"location":"api-reference/config-variables/#reboot-watchdog","title":"Reboot &amp; Watchdog","text":"Variable Values Description <code>reboot_now</code> any Trigger: system reboot (immediately, or after <code>reboot_wait</code> minutes) <code>reboot_wait</code> minutes Wait time before reboot. Set to <code>\"0\"</code> to cancel a running timer <code>firmware_switch_now</code> any Trigger: activate switchover to alternative firmware on next reboot"},{"location":"api-reference/config-variables/#settings-backup-restore","title":"Settings Backup &amp; Restore","text":"Variable Values Description <code>save_now</code> any Trigger: save running config to NVRAM <code>save_settings_now</code> any Trigger: prepare settings.cf2 for download <code>restore_settings_now</code> any Trigger: parse an uploaded .cf2 settings file <code>restore_settings_sha256</code> SHA256 hex string SHA256 checksum of the uploaded .cf2 file"},{"location":"api-reference/config-variables/#diagnostics","title":"Diagnostics","text":"Variable Values Description <code>generate_diag_now</code> <code>\"1\"</code> Trigger: generate diagnostic archive for download"},{"location":"api-reference/jsonrpc-methods/","title":"JSON-RPC Methods","text":"<p>This page documents the JSON-RPC 2.0 methods available on ads-tec Industrial IT devices. The Python reference implementation wraps these methods for convenience, but any HTTP client that can send JSON-RPC requests can use this API.</p>"},{"location":"api-reference/jsonrpc-methods/#protocol","title":"Protocol","text":"<p>All requests are sent as <code>POST https://&lt;device-ip&gt;/rpc</code> with <code>Content-Type: application/json</code>.</p>"},{"location":"api-reference/jsonrpc-methods/#request-format","title":"Request Format","text":"<pre><code>{\n    \"id\": \"req-1\",\n    \"jsonrpc\": \"2.0\",\n    \"method\": \"call\",\n    \"params\": [\"&lt;session_id&gt;\", \"&lt;object&gt;\", \"&lt;method&gt;\", {&lt;parameters&gt;}]\n}\n</code></pre> <p>Use <code>\"method\": \"list\"</code> instead of <code>\"call\"</code> to get a description of an object and its available methods.</p>"},{"location":"api-reference/jsonrpc-methods/#response-format","title":"Response Format","text":"<pre><code>{\n    \"id\": \"req-1\",\n    \"jsonrpc\": \"2.0\",\n    \"result\": [0, {&lt;result_data&gt;}]\n}\n</code></pre> <p>The first element of <code>result</code> is the return code (<code>0</code> = success). The second element contains the response data.</p>"},{"location":"api-reference/jsonrpc-methods/#error-response","title":"Error Response","text":"<pre><code>{\n    \"id\": \"req-1\",\n    \"jsonrpc\": \"2.0\",\n    \"error\": {\"code\": -32000, \"message\": \"error description\"}\n}\n</code></pre>"},{"location":"api-reference/jsonrpc-methods/#available-objects","title":"Available Objects","text":"Object Description <code>session</code> Authentication and session management <code>config</code> Configuration read/write and table operations <code>status</code> Device status queries <code>gpio</code> LEDs, buttons, digital I/O \u2014 firewalls only <code>network.ipsec.control</code> IPsec VPN tunnel control \u2014 firewalls only <code>statusd</code> Big-LinX VPN control <code>blxpush</code> Big-LinX IIoT dashboard data push <code>file</code> Base64 file upload/download via JSON-RPC <code>datacollection</code> Real-time traffic statistics and time-series data <code>zxcvbn</code> Password strength checking"},{"location":"api-reference/jsonrpc-methods/#session-authentication","title":"<code>session</code> \u2014 Authentication","text":"Method Parameters Description <code>create</code> <code>user</code>, <code>password</code>, <code>timeout</code> (optional) Authenticate and get a session ID <code>list</code> \u2014 List all active sessions <code>destroy</code> <code>sid</code> Destroy a session (logout) <p><code>session.create</code> is the only call that may use the null SID <code>00000000000000000000000000000000</code>.</p> <p>Parameters for <code>create</code>:</p> Parameter Type Required Description <code>user</code> string yes Username <code>password</code> string yes Password <code>timeout</code> integer no Session timeout in seconds (default: 600) <p>Response: Returns <code>sid</code> (32-char hex string) and <code>acls</code> (access rights for this user).</p> <p>Python:</p> <pre><code>dev.get_sid()    # session.create\ndev.logout()     # session.destroy\n</code></pre>"},{"location":"api-reference/jsonrpc-methods/#config-configuration","title":"<code>config</code> \u2014 Configuration","text":""},{"location":"api-reference/jsonrpc-methods/#session-management","title":"Session Management","text":"Method Parameters Description <code>sess_start</code> \u2014 Start a configuration session. Returns <code>cfg_session_id</code> <code>sess_commit</code> <code>cfg_session_id</code> Commit and apply changes atomically <code>sess_abort</code> <code>cfg_session_id</code> Cancel all changes in the session <p>All-or-Nothing</p> <p>On conflict (e.g., invalid combination of settings), <code>sess_commit</code> discards the entire config set and returns an error.</p>"},{"location":"api-reference/jsonrpc-methods/#read-operations","title":"Read Operations","text":"Method Parameters Description <code>get</code> <code>keys</code> (list) Read configuration variable values. Non-existing variables return empty string <code>get_values</code> <code>keys</code> (list) Extended read: returns default value, permissions, JSON-interpreted value, and raw string <code>get_default</code> <code>keys</code> (list) Get default value for each variable (firmware/product-specific) <code>export_pages</code> <code>pages</code> (list) Export all settings for given page IDs. Output can be fed to <code>import_config</code>"},{"location":"api-reference/jsonrpc-methods/#write-operations","title":"Write Operations","text":"Method Parameters Description <code>set</code> <code>cfg_session_id</code>, <code>values</code> (dict), <code>verbose</code> (bool, optional) Write configuration variables. Values are regex-validated; on failure the entire call is aborted. With <code>verbose=true</code>, returns all errors instead of just the first <code>import_config</code> <code>jsondata</code> (complex) Bulk import: does NOT need a config session. All-or-nothing \u2014 aborts on any error <p><code>import_config</code> structure:</p> <pre><code>{\n    \"jsondata\": {\n        \"configdata\": {\"var1\": \"val1\", \"var2\": \"val2\"},\n        \"tableinsert\": { ... },\n        \"tableupdate\": { ... },\n        \"tabledelete\": { ... }\n    }\n}\n</code></pre>"},{"location":"api-reference/jsonrpc-methods/#table-operations","title":"Table Operations","text":"Method Parameters Description <code>table_get</code> <code>tablename</code>, <code>condition</code> (dict, max 2 keys) Read matching rows <code>table_set</code> <code>tablename</code>, <code>cfg_session_id</code>, <code>row</code> (array) Insert a new row (all columns required). Integer <code>id</code> columns require an explicit value \u2014 there is no auto-increment <code>table_up</code> <code>tablename</code>, <code>cfg_session_id</code>, <code>condition</code> (dict), <code>values</code> (dict) Update matching rows <code>table_del</code> <code>tablename</code>, <code>cfg_session_id</code>, <code>condition</code> (dict) Delete matching rows <p>See Tables for known table schemas.</p> <p>Python:</p> <pre><code>dev.sess_start()                          # config.sess_start\ndev.sess_commit(cfg_session_id)           # config.sess_commit\ndev.config_get([\"lan_ipaddr\", \"timezone\"])  # config.get\ndev.config_set(cfg_session_id, values)    # config.set\ndev.config_set_commit(values)             # sess_start + set + sess_commit\n</code></pre>"},{"location":"api-reference/jsonrpc-methods/#status-device-status","title":"<code>status</code> \u2014 Device Status","text":"Method Parameters Description <code>get</code> <code>function</code>, <code>parameters</code> (list, optional) Query a status property <p>Python:</p> <pre><code>dev.status(\"imageversion\")              # No parameters\ndev.status(\"ping4\", \"127.0.0.1\", \"3\")  # With parameters\n</code></pre> <p>See Status Properties for the full list.</p>"},{"location":"api-reference/jsonrpc-methods/#firewall-only-methods","title":"Firewall-Only Methods","text":"<p>The <code>gpio</code> and <code>network.ipsec.control</code> objects are available on firewall models (IRF1000, IRF2000, IRF3000) only. See JSON-RPC Methods (Firewalls).</p>"},{"location":"api-reference/jsonrpc-methods/#statusd-big-linx-vpn-control","title":"<code>statusd</code> \u2014 Big-LinX VPN Control","text":"Method Parameters Description <code>blx_status</code> \u2014 Full Big-LinX diagnostic status <code>blx_vpn_up</code> \u2014 Start Big-LinX VPN connection <code>vpn_down</code> \u2014 Stop Big-LinX VPN connection"},{"location":"api-reference/jsonrpc-methods/#blx_status-response-fields","title":"<code>blx_status</code> Response Fields","text":"Field Type Description <code>cardstate</code> string Smart card state. <code>\"VPNSC_CS_READY\"</code> = VPN can be activated <code>tokenlabel</code> string Common Name of Big-LinX X.509 certificate <code>vpn_state_name</code> string Current OpenVPN state (see Big-LinX status values) <code>vpn_ip</code> string VPN interface IP (empty if down) <code>vpn_server_ip</code> string VPN server public IP and port <code>vpn_ctrl_state</code> integer Target state: <code>1</code> = should be up, <code>0</code> = should be down <p>Python:</p> <pre><code>blx = dev.call(\"statusd\", \"blx_status\")\ndev.call(\"statusd\", \"blx_vpn_up\")\ndev.call(\"statusd\", \"vpn_down\")\n</code></pre>"},{"location":"api-reference/jsonrpc-methods/#blxpush-big-linx-iiot-data-push","title":"<code>blxpush</code> \u2014 Big-LinX IIoT Data Push","text":"<p>Push measurement data to the Big-LinX IIoT dashboard.</p> <p>Note</p> <p>Requires Big-LinX connection configured and Big-LinX IoT feature enabled.</p> Method Parameters Description <code>status</code> \u2014 Connection state and buffer status <code>push</code> <code>measurement</code>, <code>tags</code>, <code>values</code> Push data to Big-LinX database"},{"location":"api-reference/jsonrpc-methods/#push-parameters","title":"<code>push</code> Parameters","text":"Parameter Type Description <code>measurement</code> string Measurement name in the Big-LinX database <code>tags</code> array Additional tags for the data <code>values</code> array of objects Key-value pairs of integer/float data. Must include <code>\"ts\"</code> key with millisecond-resolution timestamp <p>Python:</p> <pre><code>status = dev.call(\"blxpush\", \"status\")\ndev.call(\"blxpush\", \"push\",\n    measurement=\"temperature\",\n    tags=[\"sensor1\"],\n    values=[{\"ts\": 1708099200000, \"temp_celsius\": 23.5}]\n)\n</code></pre>"},{"location":"api-reference/jsonrpc-methods/#file-base64-file-transfer","title":"<code>file</code> \u2014 Base64 File Transfer","text":"<p>Upload and download files via JSON-RPC using Base64 encoding. Alternative to the HTTP upload/download endpoints.</p> Method Parameters Description <code>write</code> <code>path</code>, <code>data</code> Upload a Base64-encoded file <code>read</code> <code>path</code> Download a file as Base64 <code>delete</code> <code>path</code> Delete a file to free RAM"},{"location":"api-reference/jsonrpc-methods/#allowed-paths","title":"Allowed Paths","text":"Path Purpose <code>/tmp/upsettigs</code> Settings (.cf2) upload <code>/tmp/upcerts</code> Certificate upload <code>/tmp/root/settings.cf2</code> Settings download (read/delete only) <p>Python:</p> <pre><code>import base64\n\n# Upload a certificate via JSON-RPC\nwith open(\"cert.pem\", \"rb\") as f:\n    data = base64.b64encode(f.read()).decode()\ndev.call(\"file\", \"write\", path=\"/tmp/upcerts\", data=data)\n\n# Download settings via JSON-RPC\nresult = dev.call(\"file\", \"read\", path=\"/tmp/root/settings.cf2\")\n# result[\"data\"] contains Base64-encoded content\n</code></pre>"},{"location":"api-reference/jsonrpc-methods/#datacollection-traffic-statistics","title":"<code>datacollection</code> \u2014 Traffic Statistics","text":"<p>The <code>datacollection</code> object provides real-time time-series data for network interface traffic (bytes, packets) on all devices. On firewalls (IRF), it additionally includes packet filter byte counters.</p> <p>Data is collected every 10 seconds and stored in a ring buffer with 1-second resolution, retaining approximately the last 10 minutes of data.</p>"},{"location":"api-reference/jsonrpc-methods/#metric-names","title":"Metric Names","text":"<p>Metric names follow a dot-separated naming convention. Use <code>get_metrics</code> to discover all available metrics on a device.</p> <p>Network traffic (all devices):</p> Pattern Example Description <code>{interface}.rx_bytes</code> <code>ETH1.rx_bytes</code> Received bytes (delta per interval) <code>{interface}.tx_bytes</code> <code>ETH1.tx_bytes</code> Transmitted bytes (delta per interval) <code>{interface}.rx_packets</code> <code>ETH1.rx_packets</code> Received packets (delta per interval) <code>{interface}.tx_packets</code> <code>ETH1.tx_packets</code> Transmitted packets (delta per interval) <p>Packet filter counters (firewalls only):</p> Pattern Example Description <code>filter.rule.{chain}.{target}.{index}.bcnt</code> <code>filter.rule.INPUT.DROP.10.bcnt</code> Byte count delta for a specific filter rule <code>filter.policy.{chain}.{action}.bcnt</code> <code>filter.policy.INPUT.ACCEPT.bcnt</code> Byte count delta for a chain's default policy <p>All values represent deltas per collection interval (typically 10 seconds), not absolute counters.</p>"},{"location":"api-reference/jsonrpc-methods/#methods","title":"Methods","text":"Method Parameters Description <code>get_metrics</code> \u2014 List all known metric names <code>get_values_as_table</code> <code>metrics</code>, <code>from</code>, <code>to</code>, <code>resolution</code> Query time-series data grouped by metric"},{"location":"api-reference/jsonrpc-methods/#get_metrics","title":"<code>get_metrics</code>","text":"<p>List all known metric names on the device.</p> <pre><code>result = dev.call(\"datacollection\", \"get_metrics\")\nmetrics = result[\"result\"]\n# [\"ETH1.rx_bytes\", \"ETH1.tx_bytes\", \"filter.rule.INPUT.DROP.10.bcnt\", ...]\n</code></pre>"},{"location":"api-reference/jsonrpc-methods/#get_values_as_table","title":"<code>get_values_as_table</code>","text":"<p>Query time-series data grouped by metric with timestamps.</p> Parameter Type Description <code>metrics</code> array of string Metric names to query <code>from</code> integer Start time (Unix timestamp) <code>to</code> integer End time (Unix timestamp) <code>resolution</code> integer Buffer resolution in seconds (use <code>1</code>) <pre><code>import time\n\nnow = int(time.time())\nraw = dev.call(\"datacollection\", \"get_values_as_table\",\n    metrics=[\"ETH1.rx_bytes\", \"ETH1.tx_bytes\"],\n    **{\"from\": now - 600, \"to\": now, \"resolution\": 1})\ndata = raw[\"result\"]\n# {\"ETH1.rx_bytes\": [{\"ts\": 1771510200, \"val\": 3323.0}, ...],\n#  \"ETH1.tx_bytes\": [{\"ts\": 1771510200, \"val\": 240.0}, ...]}\n</code></pre> <p>Each metric key maps to an array of <code>{\"ts\": &lt;unix_timestamp&gt;, \"val\": &lt;value&gt;}</code> objects. <code>val</code> is <code>null</code> when no data was collected for that time slot.</p> <p><code>from</code> is a Python keyword</p> <p>Use <code>**{\"from\": ...}</code> syntax since <code>from</code> is a reserved word in Python.</p>"},{"location":"api-reference/jsonrpc-methods/#zxcvbn-password-strength","title":"<code>zxcvbn</code> \u2014 Password Strength","text":"Method Parameters Description <code>get</code> <code>password</code> Check password strength, returns <code>entropy</code> score <p>Threshold: entropy &gt;= 75.0 = strong password.</p> <p>Python:</p> <pre><code>result = dev.call(\"zxcvbn\", \"get\", password=\"mypassword\")\nentropy = result[\"entropy\"]\n</code></pre>"},{"location":"api-reference/jsonrpc-methods/#raw-call-example","title":"Raw Call Example","text":"<p>For any method, use <code>dev.call()</code> directly:</p> <pre><code># dev.call(object, method, **params)\nresult = dev.call(\"gpio\", \"get_bool\", signal=\"DI2\")\n</code></pre> <p>This sends:</p> <pre><code>{\n    \"id\": \"req-1\",\n    \"jsonrpc\": \"2.0\",\n    \"method\": \"call\",\n    \"params\": [\"&lt;sid&gt;\", \"gpio\", \"get_bool\", {\"signal\": \"DI2\"}]\n}\n</code></pre>"},{"location":"api-reference/python-client/","title":"Python Reference Implementation","text":""},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice","title":"<code>jsonrpcdevice.AdstecJSONRPCDevice</code>","text":""},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.get_sid","title":"<code>get_sid()</code>","text":"<p>Authenticate and acquire a session ID (SID).</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.set_target","title":"<code>set_target(target)</code>","text":"<p>set the target device IP address i.e., when changing the IP address of the device</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.call","title":"<code>call(obj, method, **params)</code>","text":"<p>Make a JSON/RPC call.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.send_request","title":"<code>send_request(payload)</code>","text":"<p>Send a JSON/RPC request to the target device.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.sess_start","title":"<code>sess_start()</code>","text":"<p>Start a configuration session.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.sess_commit","title":"<code>sess_commit(cfg_session_id)</code>","text":"<p>Commit a configuration session.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.table_get","title":"<code>table_get(tablename, condition_key, condition_value)</code>","text":"<p>Get a row from a table.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.table_up","title":"<code>table_up(tablename, cfg_session_id, condition, values)</code>","text":"<p>Update a row in a table.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.table_insert","title":"<code>table_insert(tablename, cfg_session_id, row)</code>","text":"<p>Insert a new row into a table.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.table_del","title":"<code>table_del(tablename, cfg_session_id, condition)</code>","text":"<p>Delete a row from a table.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.config_get","title":"<code>config_get(keys)</code>","text":"<p>Get the values of configuration variables.</p> <p>Parameters:</p> Name Type Description Default <code>keys</code> <p>List of configuration keys to retrieve.</p> required <p>Returns:</p> Type Description <p>Dictionary of key-value pairs.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.config_set","title":"<code>config_set(cfg_session_id, values)</code>","text":"<p>Set configuration variables.</p> <p>Parameters:</p> Name Type Description Default <code>cfg_session_id</code> <p>Active configuration session ID.</p> required <code>values</code> <p>Dictionary of key-value pairs to set.</p> required <code>verbose</code> <p>Whether to enable verbose error reporting.</p> required <p>Returns:</p> Type Description <p>Result of the set operation.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.config_update","title":"<code>config_update(cfg_session_id, values, condition)</code>","text":"<p>Update configuration variables based on a condition.</p> <p>Parameters:</p> Name Type Description Default <code>cfg_session_id</code> <p>Active configuration session ID.</p> required <code>values</code> <p>Dictionary of key-value pairs to update.</p> required <code>condition</code> <p>Dictionary specifying the condition for the update.</p> required <p>Returns:</p> Type Description <p>Result of the update operation.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.status","title":"<code>status(property, param1='', param2='')</code>","text":"<p>Get system status information for a specific property with optional parameters.</p> <p>Parameters:</p> Name Type Description Default <code>property</code> <p>The status property to query (e.g., 'uptime').</p> required <code>param1</code> <p>First optional parameter (default: \"\").</p> <code>''</code> <code>param2</code> <p>Second optional parameter (default: \"\").</p> <code>''</code> <p>Returns:</p> Type Description <p>The status value for the specified property.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.AdstecJSONRPCDevice.convert_to_ifname","title":"<code>convert_to_ifname(interfaces_arr)</code>","text":"<p>Convert interface names to their corresponding ifname values.</p> <p>Parameters:</p> Name Type Description Default <code>interfaces_arr</code> <p>List of interface names (e.g., ['wan', 'docker', 'vpn10'])</p> required <p>Returns:</p> Type Description <p>Space-separated string of interface names (e.g., 'br1 lxcbr0 l3tap10')</p>"},{"location":"api-reference/python-client/#module-level-functions","title":"Module-Level Functions","text":""},{"location":"api-reference/python-client/#jsonrpcdevice.check_host","title":"<code>jsonrpcdevice.check_host(host, timeout=5)</code>","text":"<p>Check if a host is online by making an HTTPS request.</p> <p>Parameters:</p> Name Type Description Default <code>host</code> <p>Hostname or IP address.</p> required <code>timeout</code> <p>Request timeout in seconds (default: 5).</p> <code>5</code> <p>Returns:</p> Type Description <p>A tuple (is_online, info). is_online: Boolean indicating if the host is reachable. info: Status code if online, or error message if offline.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.wait_for_reboot","title":"<code>jsonrpcdevice.wait_for_reboot(host, username, password, check_interval=3)</code>","text":"<p>Wait for a device to reboot and finish its boot process.</p> <p>Parameters:</p> Name Type Description Default <code>host</code> <p>Hostname or IP address of the device.</p> required <code>username</code> <p>Username for authentication.</p> required <code>password</code> <p>Password for authentication.</p> required <code>check_interval</code> <p>Time to wait between checks in seconds (default: 3).</p> <code>3</code> <p>Returns:</p> Type Description <p>An instance of AdstecJSONRPCDevice once the device is ready.</p>"},{"location":"api-reference/python-client/#jsonrpcdevice.wait_for_host_is_online","title":"<code>jsonrpcdevice.wait_for_host_is_online(host, timeout=300, interval=5)</code>","text":"<p>Wait for a host to become online by checking its HTTPS URL.</p> <p>Parameters:</p> Name Type Description Default <code>host</code> <p>Hostname or IP address.</p> required <code>timeout</code> <p>Maximum time to wait in seconds (default: 300).</p> <code>300</code> <code>interval</code> <p>Time to wait between checks in seconds (default: 5).</p> <code>5</code>"},{"location":"api-reference/schemas/","title":"JSON Schemas","text":"<p>Machine-readable JSON Schema files are available in the <code>schemas/</code> directory of the repository. These can be used for request validation, code generation, or integration with other tools.</p>"},{"location":"api-reference/schemas/#available-schemas","title":"Available Schemas","text":"File Description <code>jsonrpc-envelope.schema.json</code> Base JSON-RPC 2.0 request/response/error envelope <code>session.schema.json</code> <code>session.create</code>, <code>session.list</code>, <code>session.destroy</code> <code>config.schema.json</code> <code>config.get</code>, <code>config.get_values</code>, <code>config.get_default</code>, <code>config.set</code>, <code>config.export_pages</code>, <code>config.import_config</code>, session management, table operations <code>status.schema.json</code> <code>status.get</code> with all known property names <code>gpio.schema.json</code> <code>gpio.list</code>, <code>gpio.get</code>, <code>gpio.get_bool</code>, <code>gpio.get_pulses</code>, <code>gpio.on</code>, <code>gpio.off</code> (firewalls only) <code>ipsec.schema.json</code> <code>network.ipsec.control.up</code>, <code>network.ipsec.control.down</code> (firewalls only) <code>statusd.schema.json</code> <code>statusd.blx_status</code>, <code>statusd.blx_vpn_up</code>, <code>statusd.vpn_down</code> <code>blxpush.schema.json</code> <code>blxpush.status</code>, <code>blxpush.push</code> <code>file-rpc.schema.json</code> <code>file.write</code>, <code>file.read</code>, <code>file.delete</code> <code>zxcvbn.schema.json</code> <code>zxcvbn.get</code> <code>file-transfer.schema.json</code> HTTP upload/download endpoints (not JSON-RPC)"},{"location":"api-reference/schemas/#request-envelope","title":"Request Envelope","text":"<p>All JSON-RPC calls use the same envelope. The top-level <code>method</code> is always <code>\"call\"</code> (or <code>\"list\"</code> to discover methods on an object), with <code>params</code> as a 4-element array:</p> <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"call\",\n  \"params\": [\n    \"&lt;session_id&gt;\",\n    \"&lt;object&gt;\",\n    \"&lt;method&gt;\",\n    { &lt;method_parameters&gt; }\n  ]\n}\n</code></pre> <p>Available objects: <code>session</code>, <code>config</code>, <code>status</code>, <code>gpio</code>, <code>network.ipsec.control</code>, <code>statusd</code>, <code>blxpush</code>, <code>file</code>, <code>zxcvbn</code>.</p> <p>Successful responses return <code>result</code> as <code>[0, {data}]</code>. Non-zero first element indicates an error.</p> SuccessError <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"result\": [0, {\"imageversion\": \"2.2.6\"}]\n}\n</code></pre> <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"error\": {\"code\": -32000, \"message\": \"error description\"}\n}\n</code></pre>"},{"location":"api-reference/schemas/#session-authentication","title":"session \u2014 Authentication","text":""},{"location":"api-reference/schemas/#sessioncreate","title":"session.create","text":"<p>Authenticate and obtain a session ID. This is the only call that may use the null SID.</p> RequestResponse <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"call\",\n  \"params\": [\n    \"00000000000000000000000000000000\",\n    \"session\", \"create\",\n    {\"user\": \"admin\", \"password\": \"admin\", \"timeout\": 600}\n  ]\n}\n</code></pre> <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"result\": [0, {\"sid\": \"a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4\", \"acls\": {}}]\n}\n</code></pre> Parameter Type Required Description <code>user</code> string yes Login username <code>password</code> string yes Login password <code>timeout</code> integer no Session timeout in seconds (default: 600) <p>Returns <code>sid</code> (32-char hex) and <code>acls</code> (access rights for this user).</p>"},{"location":"api-reference/schemas/#sessionlist","title":"session.list","text":"<p>List all active sessions on the device.</p> <pre><code>{\"id\": \"req-1\", \"jsonrpc\": \"2.0\", \"method\": \"call\",\n \"params\": [\"&lt;sid&gt;\", \"session\", \"list\", {}]}\n</code></pre>"},{"location":"api-reference/schemas/#sessiondestroy","title":"session.destroy","text":"<p>Invalidate the current session (logout).</p> <pre><code>{\"id\": \"req-1\", \"jsonrpc\": \"2.0\", \"method\": \"call\",\n \"params\": [\"&lt;sid&gt;\", \"session\", \"destroy\", {}]}\n</code></pre>"},{"location":"api-reference/schemas/#config-configuration","title":"config \u2014 Configuration","text":""},{"location":"api-reference/schemas/#configsess_start","title":"config.sess_start","text":"<p>Start a configuration session. Returns <code>cfg_session_id</code>.</p> <pre><code>{\"id\": \"req-1\", \"jsonrpc\": \"2.0\", \"method\": \"call\",\n \"params\": [\"&lt;sid&gt;\", \"config\", \"sess_start\", {}]}\n</code></pre>"},{"location":"api-reference/schemas/#configsess_commit","title":"config.sess_commit","text":"<p>Commit all changes in the session atomically. On conflict, the entire config set is discarded.</p> Parameter Type Required Description <code>cfg_session_id</code> string yes Session ID from <code>sess_start</code>"},{"location":"api-reference/schemas/#configsess_abort","title":"config.sess_abort","text":"<p>Cancel a configuration session and discard all pending changes.</p> Parameter Type Required Description <code>cfg_session_id</code> string yes Session ID from <code>sess_start</code>"},{"location":"api-reference/schemas/#configget","title":"config.get","text":"<p>Read configuration variables. Non-existing variables return empty string.</p> RequestResponse <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"call\",\n  \"params\": [\"&lt;sid&gt;\", \"config\", \"get\",\n    {\"keys\": [\"lan_ipaddr\", \"timezone\"]}]\n}\n</code></pre> <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"result\": [0, {\"result\": [\n    {\"lan_ipaddr\": \"192.168.0.254\"},\n    {\"timezone\": \"Europe/Berlin\"}\n  ]}]\n}\n</code></pre> Parameter Type Required Description <code>keys</code> string[] yes Configuration variable names"},{"location":"api-reference/schemas/#configget_values","title":"config.get_values","text":"<p>Extended read: returns default value, permissions, JSON-interpreted value, and raw string for each variable.</p> Parameter Type Required Description <code>keys</code> string[] yes Configuration variable names"},{"location":"api-reference/schemas/#configget_default","title":"config.get_default","text":"<p>Get the firmware/product-specific default value for each variable.</p> Parameter Type Required Description <code>keys</code> string[] yes Configuration variable names"},{"location":"api-reference/schemas/#configexport_pages","title":"config.export_pages","text":"<p>Export all settings for given page IDs. Output can be fed to <code>import_config</code>.</p> Parameter Type Required Description <code>pages</code> string[] yes Page IDs to export"},{"location":"api-reference/schemas/#configset","title":"config.set","text":"<p>Write configuration variables (requires active session). Values are regex-validated; on failure the entire call is aborted.</p> Parameter Type Required Description <code>cfg_session_id</code> string yes Active session ID <code>values</code> object yes Key-value pairs to set <code>verbose</code> boolean no Return all validation errors instead of just the first (default: <code>true</code>)"},{"location":"api-reference/schemas/#configimport_config","title":"config.import_config","text":"<p>Bulk import configuration. Does not require a config session. All-or-nothing \u2014 aborts on any error.</p> <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"call\",\n  \"params\": [\"&lt;sid&gt;\", \"config\", \"import_config\", {\n    \"jsondata\": {\n      \"configdata\": {\"timezone\": \"Europe/Berlin\"},\n      \"tableinsert\": {},\n      \"tableupdate\": {},\n      \"tabledelete\": {}\n    }\n  }]\n}\n</code></pre> Parameter Type Required Description <code>jsondata</code> object yes Import payload with <code>configdata</code>, <code>tableinsert</code>, <code>tableupdate</code>, <code>tabledelete</code>"},{"location":"api-reference/schemas/#configtable_get","title":"config.table_get","text":"<p>Read table rows matching a condition (max 2 keys, AND logic).</p> Parameter Type Required Description <code>tablename</code> string yes Table name (e.g. <code>\"users\"</code>, <code>\"ipgroups\"</code>, <code>\"macgroups\"</code>, <code>\"permissions\"</code>) <code>condition</code> object yes Match condition (max 2 keys)"},{"location":"api-reference/schemas/#configtable_set","title":"config.table_set","text":"<p>Insert a new row (requires active session). All columns required.</p> Parameter Type Required Description <code>tablename</code> string yes Table name <code>cfg_session_id</code> string yes Active session ID <code>row</code> string[] yes Ordered array of field values"},{"location":"api-reference/schemas/#configtable_up","title":"config.table_up","text":"<p>Update matching rows (requires active session).</p> Parameter Type Required Description <code>tablename</code> string yes Table name <code>cfg_session_id</code> string yes Active session ID <code>condition</code> object yes Match condition (max 2 keys) <code>values</code> object yes Fields to update"},{"location":"api-reference/schemas/#configtable_del","title":"config.table_del","text":"<p>Delete matching rows (requires active session).</p> Parameter Type Required Description <code>tablename</code> string yes Table name <code>cfg_session_id</code> string yes Active session ID <code>condition</code> object yes Match condition (max 2 keys)"},{"location":"api-reference/schemas/#status-device-status","title":"status \u2014 Device Status","text":""},{"location":"api-reference/schemas/#statusget","title":"status.get","text":"<p>Query a status property.</p> Simple (no params)With parametersInterface query <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"call\",\n  \"params\": [\"&lt;sid&gt;\", \"status\", \"get\",\n    {\"function\": \"imageversion\", \"parameters\": [\"\", \"\"]}]\n}\n</code></pre> <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"call\",\n  \"params\": [\"&lt;sid&gt;\", \"status\", \"get\",\n    {\"function\": \"ping4\", \"parameters\": [\"127.0.0.1\", \"3\"]}]\n}\n</code></pre> <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"call\",\n  \"params\": [\"&lt;sid&gt;\", \"status\", \"get\",\n    {\"function\": \"if_status\", \"parameters\": [\"eth0\", \"\"]}]\n}\n</code></pre> Parameter Type Required Description <code>function</code> string yes Status property name <code>parameters</code> string[] no Up to 2 optional parameters (default: <code>[\"\", \"\"]</code>)"},{"location":"api-reference/schemas/#gpio-gpio-control-firewalls-only","title":"gpio \u2014 GPIO Control (Firewalls Only)","text":"<p>Note</p> <p>Available on firewall models (IRF1000, IRF2000, IRF3000) only. See JSON-RPC Methods (Firewalls).</p> <p>All GPIO methods use <code>dev.call(\"gpio\", \"&lt;method&gt;\", signal=\"&lt;name&gt;\")</code>.</p> Method Parameters Description <code>list</code> \u2014 List all GPIO signals <code>get</code> <code>signal</code> Get signal value <code>get_bool</code> <code>signal</code> Get boolean state <code>get_pulses</code> <code>signal</code> Get pulse count (rising + falling edges; 1 button press = 2) <code>on</code> <code>signal</code> Activate signal <code>off</code> <code>signal</code> Deactivate signal"},{"location":"api-reference/schemas/#ipsec-vpn-firewalls-only","title":"IPsec VPN (Firewalls Only)","text":"<p>Note</p> <p>Available on firewall models (IRF1000, IRF2000, IRF3000) only. The IPsec policy must be configured as \"Active (Switched)\" before it can be controlled via API. See JSON-RPC Methods (Firewalls).</p> Method Parameters Description <code>up</code> policy identifier Activate an IPsec policy <code>down</code> policy identifier Deactivate an IPsec policy <pre><code>{\"id\": \"req-1\", \"jsonrpc\": \"2.0\", \"method\": \"call\",\n \"params\": [\"&lt;sid&gt;\", \"network.ipsec.control\", \"up\", {}]}\n</code></pre>"},{"location":"api-reference/schemas/#big-linx-vpn-control","title":"Big-LinX VPN Control","text":""},{"location":"api-reference/schemas/#statusdblx_status","title":"statusd.blx_status","text":"<p>Full Big-LinX diagnostic status.</p> RequestResponse <pre><code>{\"id\": \"req-1\", \"jsonrpc\": \"2.0\", \"method\": \"call\",\n \"params\": [\"&lt;sid&gt;\", \"statusd\", \"blx_status\", {}]}\n</code></pre> <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"result\": [0, {\n    \"cardstate\": \"VPNSC_CS_READY\",\n    \"tokenlabel\": \"device-001.biglinx.cloud\",\n    \"vpn_state_name\": \"CONNECTED\",\n    \"vpn_ip\": \"10.8.0.5\",\n    \"vpn_server_ip\": \"203.0.113.1:1194\",\n    \"vpn_ctrl_state\": 1\n  }]\n}\n</code></pre> Field Type Description <code>cardstate</code> string Smart card state. <code>\"VPNSC_CS_READY\"</code> = VPN can be activated <code>tokenlabel</code> string Common Name of Big-LinX X.509 certificate <code>vpn_state_name</code> string Current OpenVPN state <code>vpn_ip</code> string VPN interface IP (empty if down) <code>vpn_server_ip</code> string VPN server public IP and port <code>vpn_ctrl_state</code> integer Target state: <code>1</code> = should be up, <code>0</code> = should be down"},{"location":"api-reference/schemas/#statusdblx_vpn_up-statusdvpn_down","title":"statusd.blx_vpn_up / statusd.vpn_down","text":"<p>Start or stop the Big-LinX VPN connection.</p> <pre><code>{\"id\": \"req-1\", \"jsonrpc\": \"2.0\", \"method\": \"call\",\n \"params\": [\"&lt;sid&gt;\", \"statusd\", \"blx_vpn_up\", {}]}\n</code></pre> <pre><code>{\"id\": \"req-1\", \"jsonrpc\": \"2.0\", \"method\": \"call\",\n \"params\": [\"&lt;sid&gt;\", \"statusd\", \"vpn_down\", {}]}\n</code></pre>"},{"location":"api-reference/schemas/#big-linx-iiot-data-push","title":"Big-LinX IIoT Data Push","text":"<p>Note</p> <p>Requires Big-LinX connection configured and Big-LinX IoT feature enabled.</p>"},{"location":"api-reference/schemas/#blxpushstatus","title":"blxpush.status","text":"<p>Get connection state and buffer status.</p> <pre><code>{\"id\": \"req-1\", \"jsonrpc\": \"2.0\", \"method\": \"call\",\n \"params\": [\"&lt;sid&gt;\", \"blxpush\", \"status\", {}]}\n</code></pre>"},{"location":"api-reference/schemas/#blxpushpush","title":"blxpush.push","text":"<p>Push measurement data to the Big-LinX database.</p> Request <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"call\",\n  \"params\": [\"&lt;sid&gt;\", \"blxpush\", \"push\", {\n    \"measurement\": \"temperature\",\n    \"tags\": [\"sensor1\"],\n    \"values\": [{\"ts\": 1708099200000, \"temp_celsius\": 23.5}]\n  }]\n}\n</code></pre> Parameter Type Required Description <code>measurement</code> string yes Measurement name in the Big-LinX database <code>tags</code> string[] yes Additional tags for the data <code>values</code> object[] yes Data points. Each must include <code>ts</code> (millisecond timestamp) plus key-value pairs of integer/float data"},{"location":"api-reference/schemas/#base64-file-transfer-json-rpc","title":"Base64 File Transfer (JSON-RPC)","text":"<p>Upload and download files via JSON-RPC using Base64 encoding. Alternative to the HTTP file transfer endpoints.</p>"},{"location":"api-reference/schemas/#filewrite","title":"file.write","text":"<p>Upload a Base64-encoded file.</p> <pre><code>{\"id\": \"req-1\", \"jsonrpc\": \"2.0\", \"method\": \"call\",\n \"params\": [\"&lt;sid&gt;\", \"file\", \"write\",\n   {\"path\": \"/tmp/upcerts\", \"data\": \"&lt;base64-encoded-content&gt;\"}]}\n</code></pre>"},{"location":"api-reference/schemas/#fileread","title":"file.read","text":"<p>Download a file as Base64.</p> RequestResponse <pre><code>{\"id\": \"req-1\", \"jsonrpc\": \"2.0\", \"method\": \"call\",\n \"params\": [\"&lt;sid&gt;\", \"file\", \"read\",\n   {\"path\": \"/tmp/root/settings.cf2\"}]}\n</code></pre> <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"result\": [0, {\"data\": \"&lt;base64-encoded-content&gt;\"}]\n}\n</code></pre>"},{"location":"api-reference/schemas/#filedelete","title":"file.delete","text":"<p>Delete a file to free RAM.</p> <pre><code>{\"id\": \"req-1\", \"jsonrpc\": \"2.0\", \"method\": \"call\",\n \"params\": [\"&lt;sid&gt;\", \"file\", \"delete\",\n   {\"path\": \"/tmp/root/settings.cf2\"}]}\n</code></pre>"},{"location":"api-reference/schemas/#allowed-paths","title":"Allowed Paths","text":"Path Operations Purpose <code>/tmp/upsettigs</code> write Settings (.cf2) upload <code>/tmp/upcerts</code> write Certificate upload <code>/tmp/root/settings.cf2</code> read, delete Settings download"},{"location":"api-reference/schemas/#zxcvbn-password-strength","title":"zxcvbn \u2014 Password Strength","text":""},{"location":"api-reference/schemas/#zxcvbnget","title":"zxcvbn.get","text":"RequestResponse <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"call\",\n  \"params\": [\"&lt;sid&gt;\", \"zxcvbn\", \"get\",\n    {\"password\": \"1H_$X%rIjg(EIu+ecw9VCZ+T\"}]\n}\n</code></pre> <pre><code>{\n  \"id\": \"req-1\",\n  \"jsonrpc\": \"2.0\",\n  \"result\": [0, {\"entropy\": 132.7}]\n}\n</code></pre> Parameter Type Required Description <code>password</code> string yes Password to evaluate <p>Threshold: entropy &gt;= 75.0 = strong password.</p>"},{"location":"api-reference/schemas/#file-transfer-http","title":"File Transfer (HTTP)","text":"<p>File upload and download use HTTP endpoints, not JSON-RPC. Authentication is via the <code>ads_sid</code> cookie (session ID from <code>session.create</code>).</p>"},{"location":"api-reference/schemas/#upload","title":"Upload","text":"<p><code>POST https://&lt;device-ip&gt;/priv/script/php_rpc/upload.php</code></p> <ul> <li>Content-Type: <code>multipart/form-data</code></li> <li>Cookie: <code>ads_sid=&lt;session_id&gt;</code></li> <li>Form field name = file type, value = file binary</li> </ul> File Type Description <code>firmware</code> Firmware binary \u2014 triggers reboot <code>bootlogo</code> Custom boot logo <code>settings</code> Settings backup (.cf2) <code>customer_settings</code> Customer-specific settings <code>cert</code> Certificate (CA, server, client PEM) <code>wwan_update</code> WWAN modem firmware"},{"location":"api-reference/schemas/#download","title":"Download","text":"<p><code>GET https://&lt;device-ip&gt;/priv/script/php_rpc/download.php?file=&lt;filename&gt;</code></p> <ul> <li>Cookie: <code>ads_sid=&lt;session_id&gt;</code></li> </ul> Filename Prerequisite Description <code>diag.tar.gz</code> Set <code>generate_diag_now</code> = <code>\"1\"</code> first Diagnostic archive <code>settings.cf2</code> Set <code>save_settings_now</code> = <code>\"1\"</code> first Settings backup"},{"location":"api-reference/status-properties/","title":"Status Properties","text":"<p>Status properties are queried with <code>status.get()</code>. They are read-only and return current device state.</p>"},{"location":"api-reference/status-properties/#usage","title":"Usage","text":"<pre><code># Simple query (no parameters)\nversion = dev.status(\"imageversion\")\n\n# Query with parameters\nping_result = dev.status(\"ping4\", \"127.0.0.1\", \"3\")\n</code></pre>"},{"location":"api-reference/status-properties/#system-information","title":"System Information","text":"Property Parameters Returns Description <code>system_name</code> \u2014 string Device system name <code>imageversion</code> \u2014 string Current firmware version (e.g., <code>\"Ads-tec/IRF2xxx/2.6.5/SVN-R13781.B-69636\"</code>) <code>second_imageversion</code> \u2014 string Firmware version on second partition <code>firmwareupdate_prepared</code> \u2014 <code>\"yes\"</code> / <code>\"no\"</code> Whether second partition has a valid firmware ready to activate <code>firmwareupdate_progress</code> \u2014 <code>-1</code> or <code>0</code>\u2013<code>100</code> Flashing percent complete, or <code>-1</code> if no flashing is active <code>firmwareupdate_inprogress</code> \u2014 <code>\"yes\"</code> / <code>\"no\"</code> Whether a firmware update is currently in progress <code>firmware_version_downgrade_check</code> version string <code>\"yes\"</code> / <code>\"no\"</code> Whether a downgrade to the given version is possible (e.g., <code>dev.status(\"firmware_version_downgrade_check\", \"1.5.0\")</code>) <code>product</code> \u2014 string Device family identifier (e.g., <code>\"IRF2xxx\"</code>) \u2014 used for firmware file matching <code>version</code> \u2014 string Running firmware main version (e.g., <code>\"1.5.0\"</code>) <code>buildno</code> \u2014 string Detailed revision and build number <code>configstate</code> \u2014 string Configuration state (e.g., <code>\"notsaved\"</code> if unsaved changes exist) <code>redbootserial</code> \u2014 string Device serial number <code>redbootproduct</code> \u2014 string Hardware revision / product identifier <code>realproduct</code> \u2014 string Product designation (e.g., <code>\"IF1110\"</code>) <code>product_alias</code> \u2014 string Product alias name <code>versionbuild</code> \u2014 string Firmware version with build number (e.g., <code>\"2.0.6 (Build 55290)\"</code>) <code>boot_finished</code> \u2014 <code>\"yes\"</code> / <code>\"no\"</code> Whether the device has completed its boot process <code>uptime</code> \u2014 string Time since last reboot + load average <code>uptimesec</code> \u2014 string Uptime in seconds <code>cpustat</code> \u2014 string CPU load in percent <code>memstat</code> \u2014 string Main memory utilization in percent <code>meminfo</code> process name string Memory utilization of a specified process <code>simstate</code> \u2014 <code>\"no sim\"</code> / <code>\"synced\"</code> / <code>\"not synced\"</code> Memory card state <code>diag_log</code> category string string Internal diagnostic log for a subsystem (e.g., <code>dev.status(\"diag_log\", \"fw_update\")</code> for firmware update errors). Format may change between versions <code>eventlog</code> <code>lines</code> (int), <code>filter</code> (regex) multiline string Event log output. <code>lines</code> limits output (<code>0</code> = all); <code>filter</code> is an extended regex (grep -E). Both optional <code>reboot_timer</code> \u2014 seconds Time remaining until scheduled reboot <code>customersettings_size</code> \u2014 number (kB) Size of customer settings <code>customersettings_timestamp</code> \u2014 unix timestamp Change date of customer settings"},{"location":"api-reference/status-properties/#network-interfaces","title":"Network Interfaces","text":"Property Parameters Returns Description <code>interfaces</code> \u2014 string Space-separated list of Linux interface names currently available on the device based on its configuration. Interfaces appear here even if they are down \u2014 e.g. <code>wwan1</code> appears when mobile is configured but not connected, <code>ipsec0</code> appears when IPsec is configured. Example: <code>\"br1 ETH2 ETH3 ETH4 ETH5 ETH6 ETH7 lxcbr0 l3tap10 wwan1\"</code> <code>symbolic_ifnames_with_umts_with_ipsec</code> \u2014 string Space-separated list of symbolic interface names (e.g., <code>\"wan lan_port1 lan_port2 docker vpn10 umts\"</code>). Same interfaces as <code>interfaces</code> but using the symbolic names used internally for <code>{name}_name</code> config variable lookups <code>if_status</code> interface name string Physical interface status. Returns negotiated speed/duplex or <code>\"no link\"</code> <code>if_mac</code> interface name MAC address Hardware address (e.g., <code>\"00:CC:90:00:71:01\"</code>) <code>if_ip</code> interface name IP address Interface IP address <code>if_rxb</code> interface name number Bytes received via interface <code>if_txb</code> interface name number Bytes sent via interface <p>Valid interface names for <code>if_status</code>, <code>if_mac</code>, <code>if_ip</code>, <code>if_rxb</code>, <code>if_txb</code>:</p> <ul> <li>Physical: <code>eth0</code>, <code>eth1</code>, <code>ETH1</code>\u2013<code>ETH8</code> (IRF3000)</li> <li>Bridge: <code>br0</code>, <code>br1</code></li> <li>VPN: <code>l3tap0</code>\u2013<code>l3tap10</code>, <code>ipsec0</code></li> <li>Mobile: <code>wwan1</code></li> <li>Docker: <code>lxcbr0</code></li> </ul>"},{"location":"api-reference/status-properties/#network-diagnostics","title":"Network Diagnostics","text":"Property Parameters Returns Description <code>ping4</code> host, count string IPv4 ping. Example: <code>dev.status(\"ping4\", \"8.8.8.8\", \"3\")</code> <code>traceroute4</code> host string Traceroute to host <code>nslookup4</code> hostname string DNS lookup <code>arping</code> host <code>\"up\"</code> / <code>\"down\"</code> ARP-level host check <code>tcpping</code> host, port <code>\"Host is up\"</code> / <code>\"Host is down\"</code> TCP SYN check on a port <code>routes</code> \u2014 string System routing table <code>nameserver</code> \u2014 string Space-separated list of active DNS servers <code>dhcp_gateway</code> \u2014 IP address Current DHCP default gateway"},{"location":"api-reference/status-properties/#date-time","title":"Date &amp; Time","text":"Property Parameters Returns Description <code>date</code> \u2014 string Current system time and timezone (e.g., <code>\"Fri Oct 26 00:00:00 CEST 2012\"</code>) <code>timezone_list</code> \u2014 string Space-separated list of available timezones <code>ntpstat_sources</code> \u2014 string NTP sync sources (newline-separated CSV). <code>*</code> in second field = active source"},{"location":"api-reference/status-properties/#ntp-source-parsing","title":"NTP Source Parsing","text":"<pre><code>ntpstat = dev.status(\"ntpstat_sources\")\nfor line in ntpstat.split(\"\\n\"):\n    fields = line.split(\",\")\n    if fields[1] == \"*\":\n        print(f\"Synced to: {fields[2]}\")\n</code></pre>"},{"location":"api-reference/status-properties/#event-log","title":"Event Log","text":"<p>The <code>eventlog</code> status property returns the device's syslog. It reads from file-based syslog if enabled, from SD card if available, or from the kernel ring buffer as fallback.</p>"},{"location":"api-reference/status-properties/#parameters","title":"Parameters","text":"Parameter Position Type Description <code>lines</code> 1st integer as string Number of most recent lines to return. <code>\"0\"</code> = all lines <code>filter</code> 2nd string Extended regex pattern (grep -E) to filter log lines. Empty = no filter <p>Both parameters are optional. When omitted, the full unfiltered log is returned.</p>"},{"location":"api-reference/status-properties/#basic-usage","title":"Basic Usage","text":"<pre><code># Get the last 10 log lines\nlog = dev.status(\"eventlog\", \"10\")\nprint(log)\n\n# Get all log lines (can be large)\nfull_log = dev.status(\"eventlog\")\n</code></pre>"},{"location":"api-reference/status-properties/#filtering-with-regex","title":"Filtering with Regex","text":"<p>The filter parameter uses extended regular expressions (grep -E), supporting <code>|</code> for alternation, <code>()</code> for grouping, and other ERE syntax:</p> <pre><code># Authentication events\nauth_log = dev.status(\"eventlog\", \"20\", \"login|auth|session\")\n\n# Kernel messages\nkern_log = dev.status(\"eventlog\", \"50\", \"kernel:\")\n\n# Network-related events\nnet_log = dev.status(\"eventlog\", \"0\", \"eth[0-9]|br[0-9]|link\")\n</code></pre>"},{"location":"api-reference/status-properties/#audit-events","title":"Audit Events","text":"<p>The Linux audit subsystem (<code>audispd</code>) logs security-relevant events such as login attempts, configuration changes, and process executions. Filter for <code>audispd</code> to retrieve these:</p> <pre><code>audit_log = dev.status(\"eventlog\", \"100\", \"audispd\")\nfor line in audit_log.strip().split(\"\\n\"):\n    if line:\n        print(line)\n</code></pre>"},{"location":"api-reference/status-properties/#firewall-only-properties","title":"Firewall-Only Properties","text":"<p>OpenVPN, CUT &amp; ALARM, 3G/4G UMTS/LTE, and GNSS/GPS status properties are available on firewall models only. See Status Properties (Firewalls).</p>"},{"location":"api-reference/status-properties/#big-linx","title":"Big-LinX","text":"Property Parameters Returns Description <code>blxstat_vpnstate</code> \u2014 string Big-LinX VPN state (see values below) <code>blxstat</code> \u2014 JSON object Full Big-LinX diagnostic status (see fields below) <code>wwh_status</code> \u2014 <code>\"ERROR\"</code> / <code>\"ONLINE\"</code> / <code>\"OFFLINE\"</code> Big-LinX WWH connection status <code>pintries</code> \u2014 number PIN attempts remaining before smart card is blocked"},{"location":"api-reference/status-properties/#blxstat_vpnstate-values","title":"<code>blxstat_vpnstate</code> Values","text":"State Description <code>\"\"</code> (empty) Not running <code>\"OFF\"</code> VPN off <code>\"INITIAL\"</code> Initializing <code>\"CONNECTING\"</code> Connecting <code>\"ASSIGN_IP\"</code> Assigning IP <code>\"ADD_ROUTES\"</code> Adding routes <code>\"CONNECTED\"</code> Tunnel established <code>\"RECONNECTING\"</code> Reconnecting <code>\"EXITING\"</code> Shutting down <code>\"WAIT\"</code> Waiting <code>\"AUTH\"</code> Authenticating <code>\"GET_CONFIG\"</code> Retrieving config <code>\"RESOLVE\"</code> Resolving hostname <code>\"TCP_CONNECT\"</code> TCP connecting <code>\"WAITINGFORAPPROVAL\"</code> Pending approval (4-eyes principle)"},{"location":"api-reference/status-properties/#blxstat-json-fields","title":"<code>blxstat</code> JSON Fields","text":"Field Type Description <code>cardstate</code> string Smart card state machine state <code>tokenlabel</code> string Common Name of Big-LinX X.509 VPN certificate <code>vpn_state_name</code> string Current VPN process state <code>vpn_oldstate_name</code> string Previous VPN state <code>vpn_ip</code> string VPN interface IP (empty if down) <code>vpn_server_ip</code> string VPN server public IP and port <code>vpn_permanent</code> string Whether connection is permanent <code>vpn_ctrl_state</code> integer Target VPN state: <code>1</code> = should be up, <code>0</code> = should be down <code>wwh_lastbeat</code> string Last WWH heartbeat <code>wwh_service</code> string WWH service state <code>wwh_delay</code> string WWH delay <code>wwh_error</code> string WWH error info"},{"location":"api-reference/status-properties/#certificates","title":"Certificates","text":"Property Parameters Returns Description <code>cacerts</code> \u2014 string List of installed CA certificates <code>clcerts</code> \u2014 string List of installed client/server certificates <code>print_cacert</code> filename string Details of a CA certificate <code>print_cert</code> filename string Details of a client/server certificate"},{"location":"api-reference/status-properties/#scep","title":"SCEP","text":"Property Parameters Returns Description <code>scep</code> \u2014 <code>\"0\"</code> - <code>\"99\"</code> SCEP state machine: <code>0</code> = not activated; <code>10</code> = starting; <code>20</code> = waiting for CA certs; <code>40</code> = waiting for client certs; <code>50</code> = success; <code>60</code> = error"},{"location":"api-reference/tables/","title":"Tables","text":"<p>Some device data is stored in tables rather than flat configuration variables. Use the table operations to read, insert, update, and delete rows.</p>"},{"location":"api-reference/tables/#table-operations","title":"Table Operations","text":""},{"location":"api-reference/tables/#read-a-row","title":"Read a Row","text":"<pre><code>row = dev.table_get(\"users\", \"username\", \"admin\")\n</code></pre>"},{"location":"api-reference/tables/#insert-a-row","title":"Insert a Row","text":"<pre><code>cfg_session_id = dev.sess_start()\ndev.table_insert(\"users\", cfg_session_id, [\"newuser\", \"\", \"\", \"1\", \"\", \"1970-01-01\", \"1970-01-01\"])\ndev.sess_commit(cfg_session_id)\n</code></pre> <p>Integer <code>id</code> columns require explicit values</p> <p>Tables with an integer <code>id</code> primary key (e.g. <code>services</code>, <code>serv_Protocols</code>, <code>selected_services</code>) do not support auto-increment. Passing <code>\"\"</code> or <code>\"0\"</code> for the <code>id</code> field causes a <code>\"datatype mismatch\"</code> error at commit. Always provide a unique non-zero integer.</p> <p>Custom entries must use IDs starting at <code>1000</code> or higher. IDs below 1000 are reserved for factory defaults. Rules inserted with lower IDs may not appear in the device web UI and can conflict with firmware updates that add new factory defaults.</p> <p>Alternatively, use <code>config.import_config</code> with <code>tableinsert</code> which uses the same dict format as <code>export_pages</code> output \u2014 but the same <code>id</code> rule applies.</p>"},{"location":"api-reference/tables/#update-a-row","title":"Update a Row","text":"<pre><code>cfg_session_id = dev.sess_start()\ndev.table_up(\"users\", cfg_session_id,\n    condition={\"username\": \"testuser\"},\n    values={\"enabled\": \"1\"}\n)\ndev.sess_commit(cfg_session_id)\n</code></pre>"},{"location":"api-reference/tables/#delete-a-row","title":"Delete a Row","text":"<pre><code>cfg_session_id = dev.sess_start()\ndev.table_del(\"users\", cfg_session_id,\n    condition={\"username\": \"testuser\"}\n)\ndev.sess_commit(cfg_session_id)\n</code></pre>"},{"location":"api-reference/tables/#query-semantics","title":"Query Semantics","text":"<ul> <li><code>condition</code> supports up to 2 key-value pairs (AND logic)</li> <li>Example: <code>{\"username\": \"guest\", \"enabled\": \"0\"}</code> matches rows where both conditions are true</li> <li>Non-existing variables return empty string, not an error</li> </ul>"},{"location":"api-reference/tables/#known-tables","title":"Known Tables","text":""},{"location":"api-reference/tables/#users-user-accounts","title":"<code>users</code> \u2014 User Accounts","text":"<p>Row format for <code>table_insert</code> (all columns required):</p> Index Field Example Description 0 username <code>\"testuser\"</code> Login username 1 (reserved) <code>\"\"</code> 2 (reserved) <code>\"\"</code> 3 enabled <code>\"1\"</code> <code>\"1\"</code> = enabled, <code>\"0\"</code> = disabled 4 (reserved) <code>\"\"</code> 5 created <code>\"1970-01-01\"</code> Account creation date 6 expires <code>\"1970-01-01\"</code> Account expiration date <p>Setting the password</p> <p>After inserting a user row, set the password in the same configuration session:</p> <pre><code>cfg_session_id = dev.sess_start()\ndev.table_insert(\"users\", cfg_session_id,\n    [\"testuser\", \"\", \"\", \"1\", \"\", \"1970-01-01\", \"1970-01-01\"])\ndev.config_set(cfg_session_id, {\n    \"webpwd_user\": \"testuser\",\n    \"webpwd_user_new\": \"SecurePassword123!\",\n    \"webpwd_user_checked\": \"SecurePassword123!\"\n})\ndev.sess_commit(cfg_session_id)\n</code></pre>"},{"location":"api-reference/tables/#permissions-user-rights","title":"<code>permissions</code> \u2014 User Rights","text":"<p>Controls per-user read/write access to configuration variables and tables.</p> Column Type Constraint Description <code>username</code> string (max 14 chars) unique with <code>configid</code> Username <code>configid</code> <code>\"0\"</code> / <code>\"1\"-\"9999\"</code> / table name unique with <code>username</code> <code>0</code> = default permissions; <code>1-9999</code> = config variable ID; table name (e.g., <code>\"macgroups\"</code>) = table access <code>permission</code> <code>\"r\"</code> / <code>\"w\"</code> <code>r</code> = read; <code>w</code> = read + write <pre><code>cfg_session_id = dev.sess_start()\n# Give user \"operator\" write access to config variable #42\ndev.table_insert(\"permissions\", cfg_session_id, [\"operator\", \"42\", \"w\"])\ndev.sess_commit(cfg_session_id)\n</code></pre>"},{"location":"api-reference/firewall/config-variables/","title":"Configuration Variables (Firewalls)","text":"<p>Firewall models only</p> <p>The configuration variables on this page apply to IRF1000, IRF2000, and IRF3000 firewalls only. For variables available on all devices, see Configuration Variables.</p>"},{"location":"api-reference/firewall/config-variables/#openvpn","title":"OpenVPN","text":""},{"location":"api-reference/firewall/config-variables/#general-connection-configuration","title":"General Connection Configuration","text":"Variable Values Description <code>vpn_list_n</code> (n: 0-10) slash-separated string VPN connection definition. Format: <code>\"OpenVPN/Client\\|Master/TCP\\|UDP/DestIP:Port:Proto/ListenPort/CertName/tapN/active\\|deactive\\|switched\"</code>. Index 10 is reserved for Big-LinX <code>vpn_proxy</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Use HTTP proxy for OpenVPN client connections <code>vpn_proxyip</code> IP or hostname Proxy address <code>vpn_proxyport</code> TCP port Proxy port <code>vpn_proxyauthmeth</code> <code>\"ntlm\"</code> / <code>\"basic\"</code> / <code>\"none\"</code> Proxy authentication method <code>vpn_proxyuser</code> string Proxy username <code>vpn_proxypass</code> string Proxy password"},{"location":"api-reference/firewall/config-variables/#client-specific-openvpn","title":"Client-Specific OpenVPN","text":"Variable Values Description <code>vpn_clientpull_status</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Activate DHCP on VPN client interface <code>vpn_clientpull_routes</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Retrieve routing info from VPN master <code>vpn_clientpull_dev</code> <code>\"tap0\"</code> - <code>\"tap9\"</code> Interface for clientpull options"},{"location":"api-reference/firewall/config-variables/#master-specific-openvpn","title":"Master-Specific OpenVPN","text":"Variable Values Description <code>vpn_ippool_status</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Activate IP assignment to clients <code>vpn_ippool_startip</code> IP address Start of client IP range <code>vpn_ippool_endip</code> IP address End of client IP range <code>vpn_ippool_masterdev</code> <code>\"tap0\"</code> - <code>\"tap9\"</code> Interface for IP pool <code>vpn_ippool_pushgw</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Push master IP as default gateway to clients <code>vpn_ippool_pushsubnet</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Push static routes to clients"},{"location":"api-reference/firewall/config-variables/#manual-vpn-switching","title":"Manual VPN Switching","text":"<p>Requires VPN connection configured in <code>\"switched\"</code> state.</p> Variable Values Description <code>vpn_switch_on</code> <code>\"0\"</code> - <code>\"10\"</code> VPN connection index to activate <code>vpn_switch_off</code> <code>\"0\"</code> - <code>\"10\"</code> VPN connection index to deactivate <code>vpn_switch_now</code> any Trigger: execute the switch. Clears <code>vpn_switch_on</code>/<code>vpn_switch_off</code> afterwards"},{"location":"api-reference/firewall/config-variables/#cut-alarm","title":"CUT &amp; ALARM","text":"Variable Values Description <code>cutsignal_mode</code> <code>\"manual\"</code> / <code>\"auto\"</code> Manual or automatic CUT signal confirmation <code>alarmsignal_mode</code> <code>\"manual\"</code> / <code>\"auto\"</code> Manual or automatic ALARM signal confirmation <code>cutsignal_timeout</code> seconds Auto-confirm timeout for CUT signal <code>alarmsignal_timeout</code> seconds Auto-confirm timeout for ALARM signal <code>cutsignal_ack_now</code> any Trigger: immediately cancel CUT signal <code>alarmsignal_ack_now</code> any Trigger: immediately cancel ALARM signal <code>cutsignal_cut_now</code> any Trigger: activate CUT signal <code>alarm_signal_alarm_now</code> any Trigger: activate ALARM signal <code>cutandalrm_reset</code> <code>\"true\"</code> / <code>\"false\"</code> Auto-acknowledge CUT/ALARM if triggered by client monitoring <code>vpn_ovpn_enable_on_cut</code> <code>\"true\"</code> / <code>\"false\"</code> Activate/deactivate \"switched\" OpenVPN connections when CUT signal changes <code>vpn_ovpn_enb_on_cut_type</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> <code>\"enabled\"</code> = connect on CUT activation; <code>\"disabled\"</code> = connect on CUT deactivation"},{"location":"api-reference/firewall/config-variables/#gpio-automatic-control","title":"GPIO Automatic Control","text":"Variable Values Description <code>gpio_cut_auto</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Automatic CUT LED/signal control <code>gpio_alarm_auto</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Automatic ALARM signal control <code>gpio_vpn_auto</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Automatic VPN LED/signal control"},{"location":"api-reference/firewall/config-variables/#packet-filter","title":"Packet Filter","text":"Variable Values Description <code>l3_forward</code> any Trigger: reload Layer 3 (iptables) packet filter rules from database. Any value change triggers the reload; using <code>str(int(time.time()))</code> is a convenient way to ensure a unique value <code>l2_forward</code> any Trigger: reload Layer 2 (ebtables) packet filter rules from database. Same behavior as <code>l3_forward</code> <p>Required after table changes</p> <p>Modifying the packet filter tables (<code>services</code>, <code>serv_Protocols</code>, <code>selected_services</code>) does not automatically reload the running filter. You must write to <code>l3_forward</code> (for L3 rules) or <code>l2_forward</code> (for L2 rules) to apply changes. See the Packet Filter guide for details.</p>"},{"location":"api-reference/firewall/config-variables/#3g4g-umtslte","title":"3G/4G (UMTS/LTE)","text":"<p>Note</p> <p>Despite the <code>umts_</code> prefix, all variables apply to LTE as well.</p> Variable Values Description <code>umts_service</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Activate 3G/4G service <code>umts_apn</code> string Provider APN (e.g., <code>\"web.vodafone.de\"</code>) <code>umts_user</code> string Provider username <code>umts_pass</code> string Provider password <code>umts_apn2</code> string Fallback APN <code>umts_user2</code> string Fallback username <code>umts_pass2</code> string Fallback password <code>umts_dns</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Obtain DNS server via 3G/4G <code>umts_pin</code> string SIM card PIN <code>umts_puk</code> string SIM card PUK (for unblocking) <code>umts_permalink</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Maintain permanent connection <code>umts_ondemand</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> On-demand dialling (<code>umts_permalink</code> must be disabled) <code>umts_connect_now</code> any Trigger: manually connect (only with <code>ondemand</code>) <code>umts_disconnect_now</code> any Trigger: manually disconnect (only with <code>ondemand</code>) <code>umts_bands_2G</code> space-separated list or <code>\"any\"</code> 2G band selection (use band names from <code>umts_supported_bands_json</code> status) <code>umts_bands_3G</code> space-separated list or <code>\"any\"</code> 3G band selection <code>umts_bands_4G</code> space-separated list or <code>\"any\"</code> 4G band selection"},{"location":"api-reference/firewall/jsonrpc-methods/","title":"JSON-RPC Methods (Firewalls)","text":"<p>Firewall models only</p> <p>The methods on this page are available on IRF1000, IRF2000, and IRF3000 firewalls only. For methods available on all devices, see JSON-RPC Methods.</p>"},{"location":"api-reference/firewall/jsonrpc-methods/#gpio-gpio-control","title":"<code>gpio</code> \u2014 GPIO Control","text":"Method Parameters Description <code>list</code> \u2014 List all available GPIO signals <code>get</code> <code>signal</code> Get the current value of a signal <code>get_bool</code> <code>signal</code> Get the boolean state of a signal <code>get_pulses</code> <code>signal</code> Get pulse count (counts rising + falling edges; one button press = 2) <code>on</code> <code>signal</code> Turn a signal on <code>off</code> <code>signal</code> Turn a signal off"},{"location":"api-reference/firewall/jsonrpc-methods/#irf2000-signals","title":"IRF2000 Signals","text":"<p>Output signals (on/off):</p> Signal Alias Description <code>alarm</code> <code>x1out</code> Alarm output <code>vpnup</code> <code>x2out</code> VPN status output <code>vpnled</code> VPN LED <code>cutled</code> CUT LED <code>statusled</code> Status LED <p>Input signals (get/get_bool):</p> Signal Alias Description <code>cut</code> <code>x1in</code> CUT input <code>vpnkey</code> <code>x2in</code> VPN key input <code>button</code> Front reset button"},{"location":"api-reference/firewall/jsonrpc-methods/#irf3000-signals","title":"IRF3000 Signals","text":"Signal Description <code>DI1</code>, <code>DI2</code>, ... Digital inputs <code>LED2_RED</code>, ... LEDs <p>Use <code>gpio.list</code> to discover all signals on your device.</p> <p>Python:</p> <pre><code>signals = dev.call(\"gpio\", \"list\")\nstate = dev.call(\"gpio\", \"get_bool\", signal=\"DI2\")\ndev.call(\"gpio\", \"on\", signal=\"LED2_RED\")\ndev.call(\"gpio\", \"off\", signal=\"LED2_RED\")\npulses = dev.call(\"gpio\", \"get_pulses\", signal=\"button\")\n</code></pre>"},{"location":"api-reference/firewall/jsonrpc-methods/#networkipseccontrol-ipsec-vpn","title":"<code>network.ipsec.control</code> \u2014 IPsec VPN","text":"<p>Control IPsec VPN policies configured as \"Active (Switched)\" in the web interface.</p> Method Parameters Description <code>up</code> policy identifier Activate an IPsec policy <code>down</code> policy identifier Deactivate an IPsec policy <p>Note</p> <p>The IPsec policy must be configured as \"Active (Switched)\" before it can be controlled via API.</p>"},{"location":"api-reference/firewall/status-properties/","title":"Status Properties (Firewalls)","text":"<p>Firewall models only</p> <p>The status properties on this page apply to IRF1000, IRF2000, and IRF3000 firewalls only. For properties available on all devices, see Status Properties.</p>"},{"location":"api-reference/firewall/status-properties/#openvpn","title":"OpenVPN","text":"Property Parameters Returns Description <code>vpnconnstat</code> <code>tap0</code> - <code>tap9</code> <code>\"up\"</code> / <code>\"down\"</code> VPN connection status for a specific interface <code>vpnclients</code> <code>tap0</code> - <code>tap9</code> number Number of connected clients on a VPN interface"},{"location":"api-reference/firewall/status-properties/#cut-alarm","title":"CUT &amp; ALARM","text":"Property Parameters Returns Description <code>alarm</code> \u2014 <code>\"off\"</code> / <code>\"on\"</code> ALARM signal state <code>intcut</code> \u2014 <code>\"off\"</code> / <code>\"on\"</code> Internal CUT signal state <code>extcut</code> \u2014 <code>\"off\"</code> / <code>\"on\"</code> External CUT signal state"},{"location":"api-reference/firewall/status-properties/#3g4g-umtslte","title":"3G/4G (UMTS/LTE)","text":"Property Parameters Returns Description <code>umts_multistat</code> \u2014 multiline string Full detailed UMTS/LTE module status <code>umts_iccid</code> \u2014 string SIM card ICCID; <code>\"Error\"</code> if no card <code>umts_pinstate</code> \u2014 string <code>\"READY\"</code> if PIN correct; <code>\"bad pin\"</code> if incorrect <code>umts_signal</code> \u2014 dBm value Reception strength in dBm <code>umts_regstate</code> \u2014 <code>\"0\"</code> - <code>\"5\"</code> Registration state: <code>0</code> = not registered; <code>1</code> = home network; <code>2</code> = searching; <code>3</code> = denied; <code>4</code> = unknown; <code>5</code> = roaming <code>umts_localip</code> \u2014 IP address Device IP if connected <code>umts_remoteip</code> \u2014 IP address Remote station IP <code>umts_operator</code> \u2014 string Operator name (e.g., <code>\"vodafone.de\"</code>); <code>\"0\"</code> on error <code>umts_stat</code> \u2014 string Connection status: <code>\"connected\"</code> / <code>\"standby - connect on demand\"</code> / <code>\"not connected\"</code> / <code>\"connecting...\"</code> <code>umts_serving_system</code> \u2014 JSON object Contains: <code>registration</code>, <code>plmn_mcc</code>, <code>plmn_mnc</code>, <code>plmn_description</code>, <code>roaming</code> <code>umts_supported_bands_json</code> \u2014 JSON object Nested object with <code>\"2G\"</code> / <code>\"3G\"</code> / <code>\"4G\"</code> keys, each containing band-name:value pairs. Band names are valid values for <code>umts_bands_*</code> config variables"},{"location":"api-reference/firewall/status-properties/#gnss-gps","title":"GNSS / GPS","text":"Property Parameters Returns Description <code>gnss_devices</code> \u2014 string List of GNSS modems <code>gnss_tpv</code> \u2014 JSON object Position data: <code>time</code> (ISO8601), <code>lat</code>, <code>lon</code>, <code>alt</code> (meters), <code>track</code> (m/s) <code>gnss_sky</code> \u2014 JSON array Received satellites. Each entry has <code>PRN</code> (satellite ID)"},{"location":"api-reference/firewall/status-properties/#packet-filter-log-format","title":"Packet Filter Log Format","text":"<p>When a packet filter rule has <code>log_active=\"1\"</code>, matched packets are logged to syslog in standard iptables/ebtables LOG format. These entries can be retrieved via the <code>eventlog</code> status property.</p> <p>The log prefix is <code>{services.name}.{serv_Protocols.description}</code>, allowing you to identify which ruleset and rule matched the packet.</p>"},{"location":"api-reference/firewall/status-properties/#examples","title":"Examples","text":"<p>ICMP (echo reply):</p> <pre><code>Feb 19 19:19:30 IRF3851-AX20291598 kernel: [13460.442264] LOG_ALL.LOG_ALL\n  IN=ETH7 OUT=ETH2\n  MAC=3e:18:92:08:1c:79:2a:18:92:07:d2:fb:08:00\n  SRC=192.168.12.254 DST=192.168.0.190\n  LEN=84 TOS=0x00 PREC=0x00 TTL=63 ID=50556\n  PROTO=ICMP TYPE=0 CODE=0 ID=5 SEQ=452\n</code></pre> <p>TCP (SYN \u2014 connection initiation to port 80):</p> <pre><code>Feb 19 19:23:20 IRF3851-AX20291598 kernel: [13689.627510] LOG_ALL.LOG_ALL\n  IN=ETH2 OUT=ETH7\n  MAC=2a:18:92:08:1c:79:cc:96:e5:40:d0:52:08:00\n  SRC=192.168.0.190 DST=192.168.12.254\n  LEN=60 TOS=0x00 PREC=0x00 TTL=63 ID=46464 DF\n  PROTO=TCP SPT=34440 DPT=80 WINDOW=64240 RES=0x00 SYN URGP=0\n</code></pre>"},{"location":"api-reference/firewall/status-properties/#common-fields","title":"Common Fields","text":"Field Description <code>LOG_ALL.LOG_ALL</code> Log prefix: <code>{services.name}.{serv_Protocols.description}</code> <code>IN=ETH7</code> Ingress interface (uses UI alias name) <code>OUT=ETH2</code> Egress interface (uses UI alias name) <code>MAC=3e:18:...</code> Ethernet header: destination MAC (6 bytes), source MAC (6 bytes), EtherType (<code>08:00</code> = IPv4) <code>SRC=192.168.12.254</code> Source IP address <code>DST=192.168.0.190</code> Destination IP address <code>LEN=84</code> Total IP packet length (bytes) <code>TOS=0x00</code> Type of Service / DSCP field <code>PREC=0x00</code> IP Precedence <code>TTL=63</code> Time to Live (decremented by each hop) <code>ID=50556</code> IP identification field <code>DF</code> Don't Fragment flag (present or absent) <code>PROTO=ICMP</code> IP protocol (<code>ICMP</code>, <code>TCP</code>, <code>UDP</code>, or numeric)"},{"location":"api-reference/firewall/status-properties/#protocol-specific-fields","title":"Protocol-Specific Fields","text":"Protocol Additional Fields ICMP <code>TYPE=</code> (e.g., <code>8</code>=echo request, <code>0</code>=echo reply), <code>CODE=</code>, <code>ID=</code>, <code>SEQ=</code> TCP <code>SPT=</code> (source port), <code>DPT=</code> (dest port), <code>WINDOW=</code> (TCP window size), <code>RES=</code> (reserved bits), flags (<code>SYN</code>, <code>ACK</code>, <code>FIN</code>, <code>RST</code>, <code>PSH</code>, <code>URG</code>), <code>URGP=</code> (urgent pointer) UDP <code>SPT=</code> (source port), <code>DPT=</code> (dest port), <code>LEN=</code> (UDP payload length)"},{"location":"api-reference/firewall/tables/","title":"Tables (Firewall)","text":"<p>Firewall models only</p> <p>The tables on this page are available on IRF1000, IRF2000, and IRF3000 firewalls.</p>"},{"location":"api-reference/firewall/tables/#ipgroups-network-groups","title":"<code>ipgroups</code> \u2014 Network Groups","text":"<p>Used for grouping IP subnets (e.g., for packet filter rules with <code>@groupname</code> syntax).</p> Column Type Constraint Description <code>name</code> string (max 14 chars) unique with <code>network</code> Name of the network group <code>network</code> IP/mask unique with <code>name</code> Subnet (e.g., <code>\"192.168.1.0/24\"</code>) <pre><code>cfg_session_id = dev.sess_start()\ndev.table_insert(\"ipgroups\", cfg_session_id, [\"office\", \"192.168.1.0/24\"])\ndev.table_insert(\"ipgroups\", cfg_session_id, [\"office\", \"10.0.0.0/8\"])\ndev.sess_commit(cfg_session_id)\n</code></pre>"},{"location":"api-reference/firewall/tables/#macgroups-hardware-groups","title":"<code>macgroups</code> \u2014 Hardware Groups","text":"<p>Used for grouping devices by MAC address (e.g., for L2 packet filter rules with <code>@groupname</code> syntax).</p> Column Type Constraint Description <code>name</code> string (max 14 chars) unique with <code>hwaddr</code> Name of the hardware group <code>hwaddr</code> MAC address unique with <code>name</code> Hardware address (e.g., <code>\"00:10:20:45:67:89\"</code>) <pre><code>cfg_session_id = dev.sess_start()\ndev.table_insert(\"macgroups\", cfg_session_id, [\"printers\", \"00:10:20:45:67:89\"])\ndev.sess_commit(cfg_session_id)\n</code></pre>"},{"location":"api-reference/firewall/tables/#services-packet-filter-rulesets","title":"<code>services</code> \u2014 Packet Filter Rulesets","text":"<p>Defines rulesets (groups of rules) for the packet filter. Each ruleset operates at Layer 2 (ebtables) or Layer 3 (iptables). 8 columns.</p> Index Column Type Description 0 <code>id</code> integer Primary key \u2014 unique non-zero integer (no auto-increment); custom rulesets must use <code>1000</code>+ 1 <code>name</code> string Ruleset name (max 32, <code>[-0-9A-Za-z_]</code>) 2 <code>description</code> string Human-readable description (max 255) 3 <code>layer_id</code> <code>\"1\"</code> / <code>\"2\"</code> <code>\"1\"</code> = L2 (ebtables), <code>\"2\"</code> = L3 (iptables) 4 <code>def_serv</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = factory default; <code>\"0\"</code> = custom 5 <code>src_interf_name</code> string Source interface or <code>\"*\"</code> for any 6 <code>des_interf_name</code> string Destination interface or <code>\"*\"</code> for any 7 <code>fac_def_pos</code> integer Factory default position (leave <code>\"\"</code> for custom) <p>See the Packet Filter guide for factory defaults, interface names, and examples.</p>"},{"location":"api-reference/firewall/tables/#serv_protocols-packet-filter-rules","title":"<code>serv_Protocols</code> \u2014 Packet Filter Rules","text":"<p>Individual filter rules within a packet filter ruleset. Each rule specifies match criteria (protocol, addresses, ports) and an action. 35 columns, grouped by function.</p> <p>Core (index 0\u201310):</p> Index Column Type Description 0 <code>id</code> integer Primary key \u2014 unique non-zero integer (no auto-increment); custom rules must use <code>1000</code>+ 1 <code>service_id</code> integer FK to <code>services.id</code> 2 <code>protocol</code> string <code>\"TCP\"</code>, <code>\"UDP\"</code>, <code>\"ICMP\"</code>, <code>\"*\"</code> for any; prefix <code>\"! \"</code> to negate 3 <code>action_id</code> <code>\"1\"</code>\u2013<code>\"8\"</code> <code>1</code>=ACCEPT, <code>2</code>=DROP, <code>5</code>=CUT, <code>6</code>=REJECT, <code>7</code>=INACTIVE, <code>8</code>=CUTANDACCEPT 4 <code>log_active</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = log matched packets 5 <code>alarm_active</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = trigger alarm signal 6 <code>description</code> string Rule name (max 32); also used as LOG prefix 7 <code>icmp_type</code> string ICMP type (e.g. <code>\"echo-request\"</code>, <code>\"any\"</code>); empty for non-ICMP 8 <code>icmp_rej_type</code> string ICMP reject type; only for REJECT action 9 <code>limitpack</code> integer Rate limit (packets/sec); empty for no limit 10 <code>position</code> integer Rule order within ruleset; lowest first <p>Addresses (index 11\u201318):</p> Index Column Type Description 11 <code>src_mac_add</code> string Source MAC, <code>\"*\"</code>, <code>\"@groupname\"</code>, or <code>\"\"</code> (L2 only) 12 <code>src_ip_add</code> string Source IP, <code>\"*\"</code>, <code>\"@groupname\"</code>, or <code>\"\"</code> 13 <code>src_netmask</code> string Source netmask (e.g. <code>\"255.255.255.0\"</code>), <code>\"*\"</code>, or <code>\"\"</code> 14 <code>src_port</code> string Source port, range (<code>\"80:443\"</code>), <code>\"*\"</code>, or <code>\"\"</code> 15 <code>des_mac_add</code> string Destination MAC (L2 only) 16 <code>des_ip_add</code> string Destination IP, <code>\"*\"</code>, <code>\"@groupname\"</code>, or <code>\"\"</code> 17 <code>des_netmask</code> string Destination netmask 18 <code>des_port</code> string Destination port or range <p>Behavior (index 19\u201326):</p> Index Column Type Description 19 <code>prot_hex</code> string L2 protocol hex (e.g. <code>\"0800\"</code>); empty for L3 20 <code>prot_transport</code> string L2 transport protocol number; empty for L3 21 <code>state_type_id</code> <code>\"1\"</code>\u2013<code>\"4\"</code> / <code>\"\"</code> <code>\"1\"</code>/<code>\"3\"</code> = conntrack; <code>\"2\"</code> = stateless (TCP flags) 22 <code>nat_ip</code> string Reserved \u2014 must be <code>\"\"</code> 23 <code>nat_port</code> string Reserved \u2014 must be <code>\"\"</code> 24 <code>states</code> string Conntrack states or TCP flags (depends on <code>state_type_id</code>) 25 <code>statevalue</code> integer L2 TCP flag bitmask; empty for L3 26 <code>revert</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = auto-generate reverse conntrack rule <p>Signal &amp; Visibility (index 27\u201334):</p> <p>All <code>sigcheck_*</code>, <code>sig_*</code>, and <code>audit_active</code> fields must be <code>\"0\"</code> or <code>\"1\"</code> \u2014 never empty string. See the Table Reference for details.</p> Index Column Type Description 27 <code>hide</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = suppress ALARM/CUT targets and logging 28 <code>sigcheck_vpn</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = apply VPN signal condition; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 29 <code>sig_vpn</code> <code>\"0\"</code> / <code>\"1\"</code> Expected VPN signal value; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 30 <code>sigcheck_cut</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = apply CUT signal condition; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 31 <code>sig_cut</code> <code>\"0\"</code> / <code>\"1\"</code> Expected CUT signal value; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 32 <code>sigcheck_vpnup</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = apply VPN-up signal condition; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 33 <code>sig_vpnup</code> <code>\"0\"</code> / <code>\"1\"</code> Expected VPN-up signal value; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 34 <code>audit_active</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = enable AUDIT target; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty <p>See the Packet Filter guide for action IDs, rule modes, and examples.</p>"},{"location":"api-reference/firewall/tables/#selected_services-active-packet-filter-rulesets","title":"<code>selected_services</code> \u2014 Active Packet Filter Rulesets","text":"<p>Activates a packet filter ruleset with optional time-based scheduling. 7 columns.</p> Index Column Type Description 0 <code>id</code> integer Primary key \u2014 unique non-zero integer (no auto-increment); custom entries must use <code>1000</code>+ 1 <code>serv_id</code> integer FK to <code>services.id</code> 2 <code>days</code> string Comma-separated weekdays (e.g. <code>\"Mon,Tue,Wed,Thu,Fri\"</code>) or <code>\"\"</code> for all 3 <code>time_active</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = enable time restriction 4 <code>time_start</code> string Start time <code>HH:MM</code> (e.g. <code>\"08:00\"</code>) or <code>\"\"</code> 5 <code>time_stop</code> string Stop time <code>HH:MM</code> (e.g. <code>\"17:00\"</code>) or <code>\"\"</code> 6 <code>position</code> integer Ruleset evaluation order; lowest first <p>See the Packet Filter guide for scheduling details and examples.</p>"},{"location":"api-reference/terminal/config-variables/","title":"Configuration Variables (Web Terminals)","text":"<p>Web terminals only</p> <p>The configuration variables on this page apply to ads-tec Web terminals only. For variables available on all devices, see Configuration Variables.</p>"},{"location":"api-reference/terminal/config-variables/#web-panel","title":"Web Panel","text":"Variable Values Description <code>browser_url</code> URL string URL displayed on the web terminal <code>browser_activate_url_now</code> <code>\"1\"</code> Trigger immediate navigation to <code>browser_url</code> <code>browser_switch_gesture</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Allow gesture to switch between browser and config UI <code>browser_context_menu</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Enable browser right-click context menu <code>browser_persistent_cache</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Persist browser cache across reboots <code>browser_keyboard</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Show on-screen keyboard <code>browser_keyboard_scale</code> string Keyboard scale factor (e.g., <code>\"1.0\"</code>) <code>keyboard_layout</code> string Keyboard layout (e.g., <code>\"en\"</code>, <code>\"de\"</code>) <code>display_orientation</code> <code>\"0\"</code> / <code>\"90\"</code> / <code>\"180\"</code> / <code>\"270\"</code> Display rotation in degrees <code>display_brightness</code> <code>\"0\"</code> - <code>\"100\"</code> Display brightness percentage <code>terminal_gui_locale</code> string GUI language (e.g., <code>\"en\"</code>, <code>\"de\"</code>)"},{"location":"guides/certificates/","title":"Certificates","text":""},{"location":"guides/certificates/#uploading-a-ca-certificate","title":"Uploading a CA Certificate","text":"<pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# Upload\ndev.upload_file(\"cert\", \"ca-cert.pem\")\n\n# Verify it's installed\nca_certs = dev.status(\"cacerts\")\nprint(f\"Installed CA certs: {ca_certs}\")\n\n# Print certificate details\ndetails = dev.status(\"print_cacert\", \"ca-cert.pem\")\nprint(details)\n\ndev.logout()\n</code></pre>"},{"location":"guides/certificates/#uploading-a-serverclient-certificate","title":"Uploading a Server/Client Certificate","text":"<pre><code>dev.upload_file(\"cert\", \"server-cert.pem\")\n\n# Verify\nclient_certs = dev.status(\"clcerts\")\nprint(f\"Installed certs: {client_certs}\")\n\n# Print details\ndetails = dev.status(\"print_cert\", \"server-cert.pem\")\nprint(details)\n</code></pre>"},{"location":"guides/certificates/#upload-with-overwrite","title":"Upload with Overwrite","text":"<p>If a certificate with the same filename already exists, delete it first:</p> <pre><code>def upload_cert(dev, cert_type, filename, overwrite=False):\n    certs_before = dev.status(cert_type)\n    if filename in certs_before:\n        if overwrite:\n            # Delete existing cert\n            cfg_session_id = dev.sess_start()\n            dev.config_set(cfg_session_id, {\n                \"to_be_deleted\": \"ca/\" + filename,\n                \"cert_delete\": \"1\"\n            })\n            dev.sess_commit(cfg_session_id)\n        else:\n            print(f\"Certificate already exists: {filename}\")\n            return\n\n    dev.upload_file(\"cert\", filename)\n    certs_after = dev.status(cert_type)\n    if filename in certs_after:\n        print(f\"Certificate uploaded: {filename}\")\n\n# Usage\nupload_cert(dev, \"cacerts\", \"ca-cert.pem\", overwrite=True)\nupload_cert(dev, \"clcerts\", \"server-cert.pem\")\n</code></pre>"},{"location":"guides/certificates/#deleting-a-certificate","title":"Deleting a Certificate","text":"<pre><code>cfg_session_id = dev.sess_start()\ndev.config_set(cfg_session_id, {\n    \"to_be_deleted\": \"ca/ca-cert.pem\",\n    \"cert_delete\": \"1\"\n})\ndev.sess_commit(cfg_session_id)\n</code></pre>"},{"location":"guides/certificates/#certificate-status-properties","title":"Certificate Status Properties","text":"Property Description <code>cacerts</code> List of installed CA certificates <code>clcerts</code> List of installed client/server certificates <code>print_cacert</code> Print CA certificate details (param: filename) <code>print_cert</code> Print client/server certificate details (param: filename)"},{"location":"guides/datetime/","title":"Date &amp; Time / NTP","text":""},{"location":"guides/datetime/#setting-the-timezone","title":"Setting the Timezone","text":"<pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# List available timezones\navailable = dev.status(\"timezone_list\")\ntimezones = available.split(\" \")\nprint(f\"Available: {timezones[:5]}...\")  # e.g., ['Europe/Berlin', 'UTC', ...]\n\n# Set timezone\ndev.config_set_commit({\"timezone\": \"Europe/Berlin\"})\n\ndev.logout()\n</code></pre>"},{"location":"guides/datetime/#configuring-ntp-automatic-time-sync","title":"Configuring NTP (Automatic Time Sync)","text":"<pre><code>import time\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\ndev.config_set_commit({\n    \"ntp_service\": \"enabled\",\n    \"ntp_server\": \"ptbtime1.ptb.de\",\n    \"ntp_server2\": \"ptbtime2.ptb.de\"\n})\n\n# Wait for NTP synchronization\nfor i in range(10):\n    time.sleep(2)\n    ntpstat = dev.status(\"ntpstat_sources\")\n    for line in ntpstat.split(\"\\n\"):\n        fields = line.split(\",\")\n        if fields[1] == \"*\":\n            print(f\"Synced to: {fields[2]}\")\n            break\n    else:\n        continue\n    break\n\ndev.logout()\n</code></pre>"},{"location":"guides/datetime/#setting-time-manually","title":"Setting Time Manually","text":"<p>When NTP is not available, set the date and time directly:</p> <pre><code>dev.config_set_commit({\n    \"ntp_service\": \"disabled\",\n    \"day\": \"15\",\n    \"month\": \"03\",\n    \"year\": \"2026\",\n    \"hour\": \"14\",\n    \"minute\": \"30\",\n    \"second\": \"00\"\n})\n</code></pre> <p>Note</p> <p>Date and time fields are strings. Day, month, hour, minute, and second should be zero-padded (e.g., <code>\"01\"</code>, not <code>\"1\"</code>).</p>"},{"location":"guides/diagnostics/","title":"Status &amp; Diagnostics","text":""},{"location":"guides/diagnostics/#querying-device-information","title":"Querying Device Information","text":"<pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\nsystem_name = dev.status(\"system_name\")\nprint(f\"System name: {system_name}\")\n\nimageversion = dev.status(\"imageversion\")\nprint(f\"Firmware version: {imageversion}\")\n\ncpustat = dev.status(\"cpustat\")\nprint(f\"CPU stats: {cpustat}\")\n\nserial = dev.status(\"redbootserial\")\nprint(f\"Serial number: {serial}\")\n\nhardware = dev.status(\"redbootproduct\")\nprint(f\"Hardware revision: {hardware}\")\n\ndev.logout()\n</code></pre>"},{"location":"guides/diagnostics/#status-with-parameters","title":"Status with Parameters","text":"<p>Some status properties accept parameters:</p> <pre><code># Ping a host 3 times\nping_result = dev.status(\"ping4\", \"127.0.0.1\", \"3\")\nprint(f\"Ping result: {ping_result}\")\n</code></pre>"},{"location":"guides/diagnostics/#event-log","title":"Event Log","text":"<p>The <code>eventlog</code> status property returns the device's syslog. For full API documentation including parameters, regex filtering, and audit events, see the Event Log reference.</p> <pre><code># Get the last 10 log lines\nlog = dev.status(\"eventlog\", \"10\")\nprint(log)\n\n# Filter for authentication events\nauth_log = dev.status(\"eventlog\", \"20\", \"login|auth|session\")\n</code></pre> <p>Packet filter logging</p> <p>On firewall models, packet filter rules with <code>log_active=\"1\"</code> produce syslog entries for every matched packet. See the log format specification and the logging &amp; troubleshooting guide.</p>"},{"location":"guides/diagnostics/#downloading-diagnostic-archive","title":"Downloading Diagnostic Archive","text":"<p>The diagnostic archive (<code>diag.tar.gz</code>) contains system information including CPU, memory, network, and temperature data.</p> <pre><code>from datetime import datetime\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# Trigger diagnostic generation\ndev.config_set_commit({\"generate_diag_now\": \"1\"})\n\n# Build a descriptive filename\nsystem_name = dev.status(\"system_name\")\ntimestamp = datetime.now().strftime(\"%Y_%m_%d_%H_%M\")\noutput_filename = f\"diag_{system_name}_{timestamp}.tar.gz\"\n\n# Download\ndev.download_file(\"diag.tar.gz\", output_filename)\nprint(f\"Downloaded: {output_filename}\")\n\ndev.logout()\n</code></pre> <p>Tip</p> <p>The diagnostic archive is generated on-demand. Always call <code>config_set_commit({\"generate_diag_now\": \"1\"})</code> before downloading to ensure you get current data.</p>"},{"location":"guides/firmware-update/","title":"Firmware Update","text":""},{"location":"guides/firmware-update/#overview","title":"Overview","text":"<p>ads-tec devices support two firmware update methods:</p> Method Trigger Reboot Use Case HTTP POST Upload Python <code>upload_file()</code> Automatic Simple, direct upload from a connected machine Server Pull (JSON-RPC) Config variable <code>fw_update_now</code> Automatic Device pulls from FTP/TFTP/HTTP server <p>All methods flash to the secondary partition. The bootloader switches to the new firmware on reboot. Avoid power loss during flashing.</p>"},{"location":"guides/firmware-update/#method-1-http-post-upload","title":"Method 1: HTTP POST Upload","text":"<p>Upload a firmware binary directly to the device. The device reboots automatically after flashing completes. This is the method used by the ads-tec web interface.</p> <pre><code>import jsonrpcdevice\n\nhost = \"192.168.0.254\"\nusername = \"admin\"\npassword = \"admin\"\nfirmware_filename = \"Ads-tec-IRF3xxx-2.2.6-SVN-R63743.B-181926.bin\"\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(host, username, password)\n\n# Check current version\ninitial_version = dev.status(\"imageversion\")\nprint(f\"Current firmware: {initial_version}\")\n\n# Upload firmware \u2014 device will reboot automatically\nupload_result = dev.upload_file(\"firmware\", firmware_filename)\nprint(f\"Upload result: {upload_result}\")\n\n# Wait for device to reboot and finish booting\ndev = jsonrpcdevice.wait_for_reboot(host, username, password, check_interval=3)\n\n# Verify new version\nnew_version = dev.status(\"imageversion\")\nprint(f\"New firmware: {new_version}\")\n\ndev.logout()\n</code></pre>"},{"location":"guides/firmware-update/#how-wait_for_reboot-works","title":"How <code>wait_for_reboot</code> Works","text":"<ol> <li>Monitors the device going offline (reboot started)</li> <li>Waits for the device to come back online (HTTPS reachable)</li> <li>Polls <code>boot_finished</code> status until it returns <code>\"yes\"</code></li> <li>Returns a new authenticated <code>AdstecJSONRPCDevice</code> instance</li> </ol>"},{"location":"guides/firmware-update/#method-2-server-pull-via-json-rpc","title":"Method 2: Server Pull via JSON-RPC","text":"<p>The device pulls a firmware image from an FTP, TFTP, or HTTP server that you control. Available on all IRF1000, IRF3000, and IRF2000 (firmware &gt;= 2.5.0).</p> <p>The device reboots automatically after flashing. Secondary services with high RAM usage may be shut down during download to free memory. There is no retry on network interruption.</p> <p>Security</p> <p>Firmware files are always encrypted and signed by ads-tec, so an unprotected transport link (plain HTTP, FTP, TFTP) does not expose firmware contents. However, this does not prevent a man-in-the-middle from serving an older, authentic ads-tec firmware that may have known security vulnerabilities (downgrade attack). Use a trusted network or authenticated transport where possible.</p>"},{"location":"guides/firmware-update/#configuration-variables","title":"Configuration Variables","text":"Variable Values Description <code>update_proto</code> <code>\"http\"</code> / <code>\"ftp\"</code> / <code>\"tftp\"</code> Protocol for firmware download <code>update_server</code> IP or hostname Server providing the firmware file <code>update_restoredefaults</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Reset to factory defaults after update (default: disabled) <code>fw_update_now</code> any Trigger: start firmware download and flash"},{"location":"guides/firmware-update/#example","title":"Example","text":"<pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# Configure and trigger server-based update\ndev.config_set_commit({\n    \"update_proto\": \"http\",\n    \"update_server\": \"192.168.0.100\",\n    \"fw_update_now\": \"1\"\n})\n\n# Device will download firmware, flash it, and reboot automatically\ndev = jsonrpcdevice.wait_for_reboot(\"192.168.0.254\", \"admin\", \"admin\")\n\nprint(f\"New firmware: {dev.status('imageversion')}\")\ndev.logout()\n</code></pre> <p>Permissions</p> <p>Which user accounts are allowed to trigger this method can be configured via the Permissions feature.</p>"},{"location":"guides/firmware-update/#legacy-http-post-to-netflash","title":"Legacy: HTTP POST to netflash","text":"<p>Note</p> <p>This endpoint only exists on IRF firmware versions &lt; 2.0.0 that do not yet have the newer <code>upload.php</code>. Firmware versions &gt;= 2.0.0 no longer provide this endpoint \u2014 use Method 1 instead.</p> <p>For devices running firmware &lt; 2.0.0, the firmware can be sent as an HTTP POST directly to the device's <code>netflash</code> CGI endpoint.</p> <ul> <li>Only the <code>admin</code> user account is allowed</li> <li>HTTP Digest authentication only</li> </ul> <pre><code>curl -v --digest -u admin:$password \\\n    https://$ip//cgi-bin/netflash?cgi://file, \\\n    -F file=\"@$filename\"\n</code></pre>"},{"location":"guides/gpio/","title":"GPIO","text":"<p>Firewall models only</p> <p>GPIO functionality is available on IRF1000, IRF2000, and IRF3000 firewalls.</p>"},{"location":"guides/gpio/#listing-available-signals","title":"Listing Available Signals","text":"<pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\nsignals = dev.call(\"gpio\", \"list\")\nfor signal in signals[\"signals\"]:\n    print(signal)\n\ndev.logout()\n</code></pre>"},{"location":"guides/gpio/#reading-digital-inputs","title":"Reading Digital Inputs","text":"<pre><code># Get boolean state of digital input 2\ndi2_state = dev.call(\"gpio\", \"get_bool\", signal=\"DI2\")\nprint(f\"DI2: {di2_state}\")\n</code></pre>"},{"location":"guides/gpio/#controlling-leds","title":"Controlling LEDs","text":"<pre><code>import time\n\n# Turn on the red LED on LED2\ndev.call(\"gpio\", \"on\", signal=\"LED2_RED\")\n\n# Check the state\nstate = dev.call(\"gpio\", \"get\", signal=\"LED2_RED\")\nprint(f\"LED2_RED: {state}\")\n\n# Wait, then turn off\ntime.sleep(1)\ndev.call(\"gpio\", \"off\", signal=\"LED2_RED\")\n</code></pre>"},{"location":"guides/gpio/#gpio-methods","title":"GPIO Methods","text":"Method Parameters Description <code>gpio.list</code> \u2014 List all available GPIO signals <code>gpio.get</code> <code>signal</code> Get current value of a signal <code>gpio.get_bool</code> <code>signal</code> Get boolean state of a signal <code>gpio.on</code> <code>signal</code> Turn a signal on <code>gpio.off</code> <code>signal</code> Turn a signal off"},{"location":"guides/gpio/#signal-naming","title":"Signal Naming","text":"Type Pattern Example Digital Inputs <code>DI&lt;n&gt;</code> <code>DI1</code>, <code>DI2</code> LEDs <code>LED&lt;n&gt;_&lt;color&gt;</code> <code>LED2_RED</code>"},{"location":"guides/networking/","title":"Networking &amp; IP Change","text":""},{"location":"guides/networking/#changing-the-device-ip-address","title":"Changing the Device IP Address","text":"<p>Changing the device IP requires special handling because the device becomes unreachable at the old address after the change.</p> <p>Use <code>config_set_commit_with_ip_change()</code> which:</p> <ol> <li>Applies the configuration change</li> <li>Expects and handles the resulting timeout</li> <li>Waits for the device to become reachable at the new IP</li> <li>Updates the internal target address</li> </ol> <pre><code>import jsonrpcdevice\n\nhost = \"192.168.0.254\"\nhost_new = \"192.168.0.253\"\n\n# Use a short timeout so the expected timeout doesn't block too long\ndev = jsonrpcdevice.AdstecJSONRPCDevice(host, \"admin\", \"admin\", timeout=5)\n\nvalues = {\n    \"lan_ipaddr\": host_new,\n    \"lan_netmask\": \"255.255.255.0\",\n    \"lan_gateway\": \"192.168.0.1\"\n}\n\ndev.config_set_commit_with_ip_change(values, host_new)\n# dev.target is now host_new\n\ndev.logout()\n</code></pre> <p>Warning</p> <p>Set a short timeout (e.g., 5 seconds) when you expect an IP change. The default 120-second timeout would cause a long wait before the library detects the expected disconnect.</p>"},{"location":"guides/networking/#checking-host-availability","title":"Checking Host Availability","text":"<pre><code>is_online, info = jsonrpcdevice.check_host(\"192.168.0.254\", timeout=5)\nif is_online:\n    print(f\"Device online, status code: {info}\")\nelse:\n    print(f\"Device offline: {info}\")\n</code></pre>"},{"location":"guides/networking/#waiting-for-a-host-to-come-online","title":"Waiting for a Host to Come Online","text":"<pre><code># Blocks until the host responds or times out (default: 300 seconds)\njsonrpcdevice.wait_for_host_is_online(\"192.168.0.254\", timeout=300, interval=5)\n</code></pre>"},{"location":"guides/password-management/","title":"Password Management","text":""},{"location":"guides/password-management/#password-strength-check","title":"Password Strength Check","text":"<p>ads-tec devices include a built-in password strength checker based on the zxcvbn algorithm. Always validate a password before setting it \u2014 if the device has <code>password_policy</code> enabled, weak passwords will be rejected.</p> <pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\nresult = dev.call(\"zxcvbn\", \"get\", password=\"weak123\")\nprint(f\"Entropy: {result['entropy']}\")\n# Entropy: ~25.0 (weak)\n\nresult = dev.call(\"zxcvbn\", \"get\", password=\"1H_$X%rIjg(EIu+ecw9VCZ+T\")\nprint(f\"Entropy: {result['entropy']}\")\n# Entropy: &gt;75.0 (strong)\n</code></pre>"},{"location":"guides/password-management/#strength-threshold","title":"Strength Threshold","text":"Entropy Strength &lt; 75.0 Not strong enough &gt;= 75.0 Strong"},{"location":"guides/password-management/#helper-function","title":"Helper Function","text":"<pre><code>def check_password_strength(dev, password):\n    result = dev.call(\"zxcvbn\", \"get\", password=password)\n    entropy = result[\"entropy\"]\n    if entropy &gt; 75.0:\n        print(f'\"{password}\" \u2014 entropy {entropy:.1f} \u2014 STRONG')\n        return True\n    else:\n        print(f'\"{password}\" \u2014 entropy {entropy:.1f} \u2014 TOO WEAK')\n        return False\n</code></pre>"},{"location":"guides/password-management/#changing-a-user-password","title":"Changing a User Password","text":"<pre><code>import jsonrpcdevice\n\nhost = \"192.168.0.254\"\nusername = \"admin\"\nold_password = \"admin\"\nnew_password = \"NewSecurePassword!\"\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(host, username, old_password)\n\n# Check strength before changing\nresult = dev.call(\"zxcvbn\", \"get\", password=new_password)\nif result[\"entropy\"] &lt; 75.0:\n    print(\"Password too weak, choose a stronger one\")\n    dev.logout()\n    exit(1)\n\n# Change password\ncfg_session_id = dev.sess_start()\ndev.config_set(cfg_session_id, {\n    \"webpwd_user\": username,\n    \"webpwd_user_old\": old_password,\n    \"webpwd_user_new\": new_password,\n    \"webpwd_user_checked\": new_password\n})\ndev.sess_commit(cfg_session_id)\ndev.logout()\n\n# Verify: log in with the new password\ndev = jsonrpcdevice.AdstecJSONRPCDevice(host, username, new_password)\ndev.logout()\nprint(\"Password changed successfully\")\n</code></pre> <p>Important</p> <p>All four password fields must be set in a single <code>config_set</code> call within one session:</p> <ul> <li><code>webpwd_user</code> \u2014 the username</li> <li><code>webpwd_user_old</code> \u2014 the current password</li> <li><code>webpwd_user_new</code> \u2014 the new password</li> <li><code>webpwd_user_checked</code> \u2014 confirmation (must match <code>webpwd_user_new</code>)</li> </ul>"},{"location":"guides/password-management/#migrating-to-argon2-password-mode","title":"Migrating to Argon2 Password Mode","text":"<p>Note</p> <p>This is only needed on IRF devices that were updated from firmware versions older than 2.0.0. Devices shipped with firmware &gt;= 2.0.0 already use Argon2.</p> <p>To upgrade password hashing to Argon2, the password mode, policy, and admin password must be changed atomically in one session:</p> <pre><code>dev = jsonrpcdevice.AdstecJSONRPCDevice(host, \"admin\", old_password)\n\ncfg_session_id = dev.sess_start()\ndev.config_set(cfg_session_id, {\n    \"password_mode\": \"argon2\",\n    \"password_policy\": \"enabled\",\n    \"webpwd_user\": \"admin\",\n    \"webpwd_user_new\": new_password,\n    \"webpwd_user_checked\": new_password\n})\ndev.sess_commit(cfg_session_id)\n</code></pre> <p>Warning</p> <p>Changing <code>password_mode</code> is irreversible. Ensure you have the new password noted before committing.</p>"},{"location":"guides/remote-capture/","title":"Remote Capture","text":""},{"location":"guides/remote-capture/#overview","title":"Overview","text":"<p>ads-tec devices support remote packet capture (rpcap) which allows tools like Wireshark to capture traffic directly from device interfaces.</p>"},{"location":"guides/remote-capture/#setting-up-remote-capture","title":"Setting Up Remote Capture","text":"<pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# Get available interfaces\nifaces = dev.status(\"symbolic_ifnames_with_umts_with_ipsec\").split(\" \")\nprint(f\"Available interfaces: {ifaces}\")\n# e.g., ['lan', 'wan', 'docker', 'vpn10']\n\n# Block all interfaces except 'lan' from capture\nifaces.remove(\"lan\")\nnative_block_list = dev.convert_to_ifname(ifaces)\n\n# Enable remote capture\ndev.config_set_commit({\n    \"rpcap_status\": \"enabled\",\n    \"rpcap_hostlist\": \"192.168.0.190\",        # Allowed capture host\n    \"rpcap_access\": native_block_list          # Interfaces to block\n})\n\ndev.logout()\n</code></pre>"},{"location":"guides/remote-capture/#interface-name-conversion","title":"Interface Name Conversion","text":"<p>Device interfaces have two names:</p> <ul> <li>Symbolic names: Human-readable (<code>lan</code>, <code>wan</code>, <code>docker</code>, <code>vpn10</code>)</li> <li>Native names: System-level (<code>br0</code>, <code>br1</code>, <code>lxcbr0</code>, <code>l3tap10</code>)</li> </ul> <p>The <code>rpcap_access</code> configuration requires native names. Use <code>convert_to_ifname()</code> to convert:</p> <pre><code>symbolic = [\"wan\", \"docker\", \"vpn10\"]\nnative = dev.convert_to_ifname(symbolic)\n# Returns: \"br1 lxcbr0 l3tap10\"\n</code></pre>"},{"location":"guides/remote-capture/#configuration-variables","title":"Configuration Variables","text":"Variable Description <code>rpcap_status</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> \u2014 Enable remote capture service <code>rpcap_hostlist</code> Comma-separated list of IPs allowed to capture <code>rpcap_access</code> Space-separated native interface names to block from capture"},{"location":"guides/settings-backup/","title":"Settings Backup","text":""},{"location":"guides/settings-backup/#downloading-device-settings","title":"Downloading Device Settings","text":"<pre><code>import jsonrpcdevice\nfrom datetime import datetime\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# 1. Trigger settings preparation\ndev.config_set_commit({\"save_settings_now\": \"1\"})\n\n# 2. Build a descriptive filename\nserial = dev.status(\"redbootserial\")\nproduct = dev.status(\"product_alias\")\ntimestamp = datetime.now().strftime(\"%Y_%m_%d_%H_%M\")\noutput_filename = f\"settings_{product}_{serial}_{timestamp}.cf2\"\n\n# 3. Download\ndev.download_file(\"settings.cf2\", output_filename)\nprint(f\"Settings saved to: {output_filename}\")\n\ndev.logout()\n</code></pre>"},{"location":"guides/settings-backup/#restoring-settings","title":"Restoring Settings","text":"<p>Upload a previously saved <code>.cf2</code> file:</p> <pre><code>dev.upload_file(\"settings\", \"settings_IRF3000_ABC123_2026_01_15_14_30.cf2\")\n</code></pre> <p>Tip</p> <p>Always trigger <code>save_settings_now</code> before downloading. This ensures the settings file reflects the current device configuration.</p>"},{"location":"guides/settings-backup/#downloadable-files","title":"Downloadable Files","text":"Filename Description <code>settings.cf2</code> Device configuration backup <code>diag.tar.gz</code> Diagnostic archive (see Diagnostics)"},{"location":"guides/user-management/","title":"User Management","text":""},{"location":"guides/user-management/#creating-a-new-user","title":"Creating a New User","text":"<p>User creation requires two steps within a single configuration session:</p> <ol> <li>Insert a row into the <code>users</code> table</li> <li>Set the password for the new user</li> </ol> <pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\nnew_username = \"testuser\"\nnew_password = \"SecurePassword123!\"\n\n# Both operations must happen in the same session\ncfg_session_id = dev.sess_start()\n\n# 1. Create the user entry\ndev.table_insert(\"users\", cfg_session_id,\n    [new_username, \"\", \"\", \"1\", \"\", \"1970-01-01\", \"1970-01-01\"])\n\n# 2. Set the password\ndev.config_set(cfg_session_id, {\n    \"webpwd_user\": new_username,\n    \"webpwd_user_new\": new_password,\n    \"webpwd_user_checked\": new_password\n})\n\n# Apply\ndev.sess_commit(cfg_session_id)\ndev.logout()\n</code></pre>"},{"location":"guides/user-management/#user-row-format","title":"User Row Format","text":"Index Field Example Description 0 username <code>\"testuser\"</code> Login username 1 (reserved) <code>\"\"</code> 2 (reserved) <code>\"\"</code> 3 enabled <code>\"1\"</code> <code>\"1\"</code> = enabled, <code>\"0\"</code> = disabled 4 (reserved) <code>\"\"</code> 5 created <code>\"1970-01-01\"</code> Account creation date 6 expires <code>\"1970-01-01\"</code> Account expiration date"},{"location":"guides/user-management/#verify-the-new-account","title":"Verify the New Account","text":"<pre><code># Log in as the new user\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", new_username, new_password)\nversion = dev.status(\"imageversion\")\nprint(f\"Logged in as {new_username}, firmware: {version}\")\ndev.logout()\n</code></pre>"},{"location":"guides/vpn-approval/","title":"VPN Approval","text":""},{"location":"guides/vpn-approval/#overview","title":"Overview","text":"<p>ads-tec firewalls support a VPN approval workflow where VPN connections must be explicitly approved before they are established. When set to <code>\"api\"</code> mode, this approval can be automated via the JSON-RPC API.</p>"},{"location":"guides/vpn-approval/#vpn-states","title":"VPN States","text":"State Description <code>WAITINGFORAPPROVAL</code> VPN connection is pending approval <code>CONNECTED</code> VPN tunnel is established"},{"location":"guides/vpn-approval/#automated-approval-workflow","title":"Automated Approval Workflow","text":"<pre><code>import time\nimport jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# 1. Enable API-based approval (one-time setup)\ndev.config_set_commit({\"vpn_approval_mode\": \"api\"})\n\n# 2. Wait for a VPN connection request\nvpn_state = \"\"\nwhile vpn_state != \"WAITINGFORAPPROVAL\":\n    vpn_state = dev.status(\"blxstat_vpnstate\")\n    print(f\"VPN state: {vpn_state}\")\n    time.sleep(3)\n\n# 3. Approve the connection\ndev.config_set_commit({\"vpn_approve_now\": \"1\"})\n\n# 4. Wait for connection to establish\nwhile vpn_state != \"CONNECTED\":\n    vpn_state = dev.status(\"blxstat_vpnstate\")\n    print(f\"VPN state: {vpn_state}\")\n    time.sleep(1)\n\nprint(\"VPN connected\")\ndev.logout()\n</code></pre> <p>Tip</p> <p>Set <code>vpn_approval_mode</code> to <code>\"api\"</code> only once. It persists across reboots.</p>"},{"location":"guides/web-panel/","title":"Web Panel (Terminals)","text":"<p>Web terminals only</p> <p>These settings apply to ads-tec Web terminals, not firewall models.</p>"},{"location":"guides/web-panel/#configuring-the-web-panel","title":"Configuring the Web Panel","text":"<pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\ndev.config_set_commit({\n    \"browser_url\": \"http://192.168.0.190\",\n    \"browser_activate_url_now\": \"1\",\n    \"browser_switch_gesture\": \"enabled\",\n    \"browser_context_menu\": \"enabled\",\n    \"browser_persistent_cache\": \"enabled\",\n    \"display_orientation\": \"0\",\n    \"display_brightness\": \"80\",\n    \"browser_keyboard\": \"enabled\",\n    \"browser_keyboard_scale\": \"1.0\",\n    \"keyboard_layout\": \"en\",\n    \"terminal_gui_locale\": \"en\",\n})\nprint(\"Web panel settings applied\")\n\ndev.logout()\n</code></pre>"},{"location":"guides/web-panel/#showing-the-config-ui-again","title":"Showing the Config UI Again","text":"<p>To switch the terminal back to the built-in configuration interface:</p> <pre><code>dev.config_set_commit({\n    \"browser_url\": \"http://localhost\",\n    \"browser_activate_url_now\": \"1\",\n})\n</code></pre>"},{"location":"guides/web-panel/#available-settings","title":"Available Settings","text":"Variable Values Description <code>browser_url</code> URL string URL to display on the terminal <code>browser_activate_url_now</code> <code>\"1\"</code> Navigate to the URL immediately <code>browser_switch_gesture</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Allow gesture to switch between browser and config UI <code>browser_context_menu</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Enable right-click context menu <code>browser_persistent_cache</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Persist browser cache across reboots <code>browser_keyboard</code> <code>\"enabled\"</code> / <code>\"disabled\"</code> Show on-screen keyboard <code>browser_keyboard_scale</code> <code>\"0.5\"</code> to <code>\"2.0\"</code> Keyboard size scale factor <code>keyboard_layout</code> <code>\"en\"</code>, <code>\"de\"</code>, etc. Keyboard layout <code>display_orientation</code> <code>\"0\"</code>, <code>\"90\"</code>, <code>\"180\"</code>, <code>\"270\"</code> Display rotation in degrees <code>display_brightness</code> <code>\"0\"</code> to <code>\"100\"</code> Display brightness percentage <code>terminal_gui_locale</code> <code>\"en\"</code>, <code>\"de\"</code>, etc. GUI language"},{"location":"guides/web-panel/#changing-ip-with-web-panel-setup","title":"Changing IP with Web Panel Setup","text":"<p>When setting up a new terminal, you often need to change the IP address first:</p> <pre><code>host_new = \"192.168.0.253\"\n\n# Use short timeout for IP change\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\", timeout=5)\n\n# Change IP first\ndev.config_set_commit_with_ip_change(\n    {\"lan_ipaddr\": host_new, \"lan_netmask\": \"255.255.255.0\", \"lan_gateway\": \"192.168.0.1\"},\n    host_new\n)\n\n# Then configure the web panel\ndev.config_set_commit({\"browser_url\": \"http://my-app.local\", \"browser_activate_url_now\": \"1\"})\n\ndev.logout()\n</code></pre>"},{"location":"guides/packet-filter/","title":"Packet Filter","text":"<p>Firewall models only</p> <p>Packet filter configuration is available on IRF1000, IRF2000, and IRF3000 firewalls.</p> <p>The packet filter controls forwarded traffic through the firewall. It uses three interrelated tables that define rulesets, individual rules, and which rulesets are active.</p>"},{"location":"guides/packet-filter/#data-model-overview","title":"Data Model Overview","text":"<p>The packet filter uses a 3-tier table architecture:</p> <pre><code>erDiagram\n    services ||--o{ serv_Protocols : \"contains\"\n    services ||--o{ selected_services : \"activated by\"\n\n    services {\n        int id PK\n        string name\n        string description\n        smallint layer_id \"1=L2  2=L3\"\n        smallint def_serv \"0=custom  1=factory\"\n        string src_interf_name\n        string des_interf_name\n        int fac_def_pos\n    }\n\n    serv_Protocols {\n        int id PK\n        int service_id FK\n        string protocol \"TCP  UDP  ICMP  etc\"\n        smallint action_id FK \"1=ACCEPT  2=DROP  etc\"\n        string src_ip_add\n        string des_ip_add\n        string src_port\n        string des_port\n        int position \"rule order\"\n    }\n\n    selected_services {\n        int id PK\n        int serv_id FK\n        string days \"Mon  Tue  etc\"\n        smallint time_active \"0=off  1=on\"\n        string time_start \"HH:MM\"\n        string time_stop \"HH:MM\"\n        int position \"ruleset order\"\n    }</code></pre> <ul> <li><code>services</code> \u2014 Rulesets (groups of rules). Each ruleset operates at either Layer 2 (ebtables) or Layer 3 (iptables).</li> <li><code>serv_Protocols</code> \u2014 Individual filter rules within a ruleset. Each rule specifies match criteria (protocol, addresses, ports) and an action.</li> <li><code>selected_services</code> \u2014 Activates a ruleset with an optional time-based schedule.</li> </ul> <p>Two read-only lookup tables provide reference data:</p> <ul> <li><code>protocols</code> \u2014 Maps protocol names (<code>TCP</code>, <code>UDP</code>, <code>ICMP</code>) to numeric values for iptables</li> <li><code>actions</code> \u2014 Maps action IDs to names (<code>ACCEPT</code>, <code>DROP</code>, etc.)</li> </ul> <p>Address groups from the <code>ipgroups</code> and <code>macgroups</code> tables can be referenced in rules using the <code>@groupname</code> syntax.</p>"},{"location":"guides/packet-filter/#scope-and-interfaces","title":"Scope and Interfaces","text":"<p>FORWARD chain only \u2014 traffic to the device is not filtered</p> <p>The packet filter applies exclusively to the iptables/ebtables FORWARD chain \u2014 only packets that pass through the device from one interface to another. Traffic addressed to the device itself (e.g. management access, web UI, SSH, ping to the device's own IP) uses the INPUT chain and is not subject to packet filter rules. You cannot use the packet filter to log or block traffic destined for the device's own IP addresses.</p> <p>The available interfaces depend on the device model, the operating mode, and the filter layer:</p> <ul> <li>Layer 2 (ebtables) operates on bridge member ports \u2014 only interfaces that are part of a bridge (<code>br0</code>, <code>br1</code>) can be filtered at L2.</li> <li>Layer 3 (iptables) operates on standalone interfaces that are not part of a bridge (e.g. routed interfaces, VPN tunnels).</li> </ul>"},{"location":"guides/packet-filter/#irf1000","title":"IRF1000","text":"<p>The IRF1000 has 3 LAN ports and 1 WAN port. The 3 LAN ports are connected through a hardware switch and appear as a single interface (<code>eth0</code>) to the operating system \u2014 traffic between the LAN ports cannot be filtered.</p> Operating Mode <code>eth0</code> (LAN) <code>eth1</code> (WAN) Bridges L2 Filtering L3 Filtering Transparent Bridge member of <code>br0</code> member of <code>br0</code> <code>br0</code> = eth0 + eth1 Yes, between eth0 and eth1 Not available IP-Router standalone standalone none Not available Yes <p>In Transparent Bridge mode, both interfaces are members of <code>br0</code>. Traffic flowing between the LAN ports (<code>eth0</code>) and the WAN port (<code>eth1</code>) passes through the bridge and can be filtered at L2. L3 filtering is not available since there are no standalone interfaces.</p> <p>In IP-Router mode, <code>eth0</code> and <code>eth1</code> are separate routed interfaces. Only L3 filtering is available.</p>"},{"location":"guides/packet-filter/#irf2000","title":"IRF2000","text":"<p>The IRF2000 comes in two hardware variants: IRF22xx (2 Ethernet ports: 1 LAN, 1 WAN) and IRF26xx (6 Ethernet ports). The IRF2000 has separate LAN and WAN bridges, enabling L2 filtering between the two segments.</p> Operating Mode LAN WAN Bridges L2 Filtering L3 Filtering Transparent Bridge members of <code>br0</code> members of <code>br1</code> <code>br0</code> (LAN), <code>br1</code> (WAN) Yes, between <code>br0</code> and <code>br1</code> Not available IP-Router members of <code>br0</code> standalone <code>br0</code> (LAN) Between <code>br0</code> members only Yes IP-Router Extended all standalone by default <code>br1</code> available, empty by default <code>br1</code> (optional) Between <code>br1</code> members (if configured) Yes <p>In IP-Router Extended mode, all interfaces are standalone routed interfaces by default. The <code>br1</code> bridge is available but not started \u2014 the user can optionally assign interfaces to it. L3 filtering works on standalone interfaces; L2 filtering is available between <code>br1</code> members if any are configured.</p>"},{"location":"guides/packet-filter/#irf3000","title":"IRF3000","text":"<p>The IRF3000 comes in two hardware variants: IRF34xx (4 Ethernet ports) and IRF38xx (8 Ethernet ports). Interface names are uppercase (<code>ETH1</code>, <code>ETH2</code>, ..., <code>ETH8</code>), matching the labels printed on the device hardware.</p> <p>The IRF3000 supports three operating modes:</p> Operating Mode LAN Interfaces WAN Interfaces Bridges L2 Filtering L3 Filtering Transparent Bridge members of <code>br0</code> members of <code>br1</code> <code>br0</code> (LAN), <code>br1</code> (WAN) Yes, between <code>br0</code> and <code>br1</code> Not available IP-Router <code>ETH1</code>\u2013<code>ETH4</code> (or <code>ETH8</code>) on <code>br0</code> <code>br1</code> freely configurable <code>br0</code> (LAN), <code>br1</code> (WAN) Between bridge members Yes IP-Router Extended all standalone by default <code>br1</code> available, empty by default <code>br1</code> (optional) Between <code>br1</code> members (if configured) Yes <p>In IP-Router mode, the LAN bridge (<code>br0</code>) contains <code>ETH1</code> through <code>ETH4</code> (IRF34xx) or <code>ETH8</code> (IRF38xx). The WAN bridge (<code>br1</code>) can be freely configured with any remaining interfaces. L2 filtering operates between bridge members, L3 filtering on standalone interfaces.</p> <p>In IP-Router Extended mode, all interfaces are standalone routed interfaces by default. The <code>br1</code> bridge is available but not started \u2014 the user can optionally assign interfaces to it. L3 filtering works on standalone interfaces; L2 filtering is available between <code>br1</code> members if any are configured.</p> <p>IP-Router Extended for maximum filter granularity</p> <p>IP-Router Extended mode (available on IRF2000 and IRF3000) gives the most control \u2014 each physical port is a separate L3 interface that can be used in directional rulesets. This is the recommended mode when per-port filtering is required.</p>"},{"location":"guides/packet-filter/#additional-interfaces","title":"Additional Interfaces","text":"<p>Beyond the physical Ethernet ports, the following virtual interfaces can appear in filter rules when their respective features are enabled:</p> Interface Type Description <code>wwan1</code> L3 standalone Mobile network (cellular modem) <code>l3tap0</code>\u2013<code>l3tap9</code> L3 standalone OpenVPN tunnels in Layer 3 (TAP) mode <code>l3tap10</code> L3 standalone Big-LinX VPN tunnel <code>ipsec0</code> L3 standalone Virtual interface for all IPsec traffic <code>docker0</code> L3 standalone Bridge to the device's Docker engine <code>l2tap0</code>\u2013<code>l2tap9</code> L2 bridged to <code>br0</code> OpenVPN tunnels in Layer 2 mode <p>L3 standalone interfaces can be used in L3 filter rules like any physical port. The L2 OpenVPN tunnels (<code>l2tap0</code>\u2013<code>l2tap9</code>) are always bridged to <code>br0</code> and can be filtered at L2 as bridge members.</p> <p>No interface validation</p> <p>The packet filter accepts any interface name in <code>src_interf_name</code> and <code>des_interf_name</code> \u2014 including interfaces that do not exist on the current device model or are not valid for the active operating mode. Rules referencing non-existent interfaces are silently ignored. It is the user's responsibility to ensure that the interface names used in rulesets match the actual device configuration.</p>"},{"location":"guides/packet-filter/#interface-name-aliases","title":"Interface Name Aliases","text":"<p>The web UI displays user-friendly aliases (e.g., \"LAN\", \"WAN\", \"WWAN\") instead of the Linux interface names (e.g., <code>br0</code>, <code>br1</code>, <code>wwan1</code>). The packet filter tables and the event log both use the alias names \u2014 so <code>IN=ETH7</code> in a log line matches the label you see in the web UI.</p> <p>On IRF3000 devices, the physical port names (<code>ETH1</code>\u2013<code>ETH8</code>) are the same in both the UI and Linux, so no translation is needed. For other interfaces, the mapping is stored in <code>{interface}_name</code> configuration variables:</p> <pre><code># Query interface alias mappings\naliases = [\n    \"br0_name\", \"br1_name\", \"bond0_name\", \"wwan1_name\",\n    \"l3tap0_name\", \"l3tap10_name\", \"ipsec0_name\",\n    \"docker_name\", \"ppp0_name\",\n    \"lan_port1_name\", \"lan_port2_name\", \"lan_port3_name\",\n    \"lan_port4_name\", \"lan_port5_name\", \"lan_port6_name\",\n    \"lan_port7_name\",\n]\nfor name in aliases:\n    result = dev.config_get([name])\n    value = result.get(\"result\", [{}])[0].get(name, \"\")\n    if value:\n        iface = name.replace(\"_name\", \"\")\n        print(f\"{iface:15s} -&gt; {value}\")\n</code></pre> <p>Example output on an IRF3851 (8-port):</p> <pre><code>br0             -&gt; LAN (int.)\nbr1             -&gt; WAN\nbond0           -&gt; WAN\nwwan1           -&gt; WWAN\nl3tap0          -&gt; L3-VPN1\nl3tap10         -&gt; BLX-VPN\nipsec0          -&gt; IPsec\ndocker          -&gt; DOCKER\nppp0            -&gt; WAN (DSL)\nlan_port1       -&gt; ETH2\nlan_port2       -&gt; ETH3\nlan_port3       -&gt; ETH4\nlan_port4       -&gt; ETH5\nlan_port5       -&gt; ETH6\nlan_port6       -&gt; ETH7\nlan_port7       -&gt; ETH8\n</code></pre>"},{"location":"guides/packet-filter/#discovering-available-interfaces","title":"Discovering Available Interfaces","text":"<p>The <code>interfaces</code> status property returns all interface names currently available on the device based on its configuration. Interfaces appear even if they are currently down (e.g., <code>wwan1</code> is listed when mobile networking is configured but not connected, <code>ipsec0</code> when IPsec is configured but the tunnel is down):</p> <pre><code>ifaces = dev.status(\"interfaces\").split()\nfor iface in ifaces:\n    alias = dev.config_get([f\"{iface}_name\"]).get(\"result\", [{}])[0].get(f\"{iface}_name\", iface)\n    print(f\"{iface:15s} -&gt; {alias}\")\n</code></pre> <p>Example output on an IRF3851:</p> <pre><code>br1             -&gt; WAN\nETH2            -&gt; ETH2\nETH3            -&gt; ETH3\nETH4            -&gt; ETH4\nETH5            -&gt; ETH5\nETH6            -&gt; ETH6\nETH7            -&gt; ETH7\nlxcbr0          -&gt; DOCKER\nl3tap10         -&gt; BLX-VPN\nwwan1           -&gt; WWAN\n</code></pre> <p>Finding the correct interface names for filter rules</p> <p>To discover the exact names used in the packet filter tables, use the web UI to create a test rule referencing the interfaces of interest, then export the configuration and inspect the <code>src_interf_name</code> / <code>des_interf_name</code> values.</p>"},{"location":"guides/packet-filter/#applying-changes","title":"Applying Changes","text":"<p>Table changes do not take effect automatically</p> <p>Modifying the packet filter tables (<code>services</code>, <code>serv_Protocols</code>, <code>selected_services</code>) does not reload the running filter. You must trigger a reload by writing to the <code>l3_forward</code> configuration variable:</p> <pre><code>import time\ndev.config_set_commit({\"l3_forward\": str(int(time.time()))})\n</code></pre> <p>The value itself is ignored \u2014 any change triggers the reload. Using the current timestamp is a convenient way to ensure a unique value. Without this step, the device continues using the previous filter rules.</p> <p>The same applies to L2 filter changes \u2014 use <code>l2_forward</code> instead of <code>l3_forward</code>.</p>"},{"location":"guides/packet-filter/#key-behaviors","title":"Key Behaviors","text":"<ul> <li>Default FORWARD policy is DROP \u2014 all forwarded traffic is blocked unless a rule explicitly allows it</li> <li>Rule evaluation order: <code>selected_services.position</code> determines ruleset order; within each ruleset, <code>serv_Protocols.position</code> determines individual rule order (lowest value first)</li> <li>Protocol resolution: string names like <code>\"TCP\"</code> are resolved via the <code>protocols</code> table; numeric values are used directly as fallback</li> <li>IP groups: <code>@groupname</code> references are implemented as <code>ipset</code> sets internally</li> <li>Directional rulesets: when <code>src_interf_name</code> or <code>des_interf_name</code> is not <code>*</code>, the firewall creates both forward and reverse chains</li> </ul> <p>Position determines evaluation order \u2014 first match wins</p> <p>Rulesets are evaluated in ascending <code>selected_services.position</code> order. A catch-all ruleset like Allow_L3 (which accepts all traffic) will prevent any ruleset with a higher position number from ever seeing traffic. If you add a custom ruleset for logging or selective filtering, it must have a lower position than any catch-all ACCEPT ruleset, otherwise it will never match any packets.</p> <p>Performance: use directional rulesets for high-throughput interfaces</p> <p>The primary filter criteria are the input and output interfaces. Rulesets bound to specific interfaces (e.g. <code>src_interf_name=\"eth0\"</code>, <code>des_interf_name=\"eth1\"</code>) create per-interface-pair chains in iptables/ebtables. Traffic on a given interface pair only enters the matching chains \u2014 all other rulesets are skipped entirely.</p> <p>Wildcard rulesets (<code>src_interf_name=\"*\"</code>, <code>des_interf_name=\"*\"</code>) are evaluated for every packet on every interface. On high-throughput links this means the kernel traverses all rules in those rulesets for each packet.</p> <p>For best performance, place high-volume traffic rules in directional rulesets with explicit interface names and reserve wildcard rulesets for catch-all policies.</p>"},{"location":"guides/packet-filter/#next-steps","title":"Next Steps","text":"<ul> <li>Rule Modes \u2014 L3 easy/stateful/stateless modes and L2 filtering specifics</li> <li>Table Reference \u2014 full column schemas for all three tables</li> <li>Examples \u2014 export, import, CRUD operations, IP groups, scheduling</li> <li>Monitoring Counters \u2014 verify rules are matching traffic using real-time byte counters</li> </ul>"},{"location":"guides/packet-filter/examples/","title":"Examples","text":"<p>All examples use table operations on the packet filter tables (<code>services</code>, <code>serv_Protocols</code>, <code>selected_services</code>). See the Table Reference for full column schemas.</p>"},{"location":"guides/packet-filter/examples/#exporting-the-entire-packet-filter","title":"Exporting the Entire Packet Filter","text":"<p>Use <code>config.export_pages</code> with page ID <code>FILTERCONF</code> to export all three tables and related config variables in one call. The output format is compatible with <code>config.import_config</code>.</p> <pre><code>import json\nimport jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\nexport = dev.call(\"config\", \"export_pages\", pages=[\"FILTERCONF\"])\nprint(json.dumps(export, indent=2))\n\ndev.logout()\n</code></pre>"},{"location":"guides/packet-filter/examples/#importing-a-complete-filter-configuration","title":"Importing a Complete Filter Configuration","text":"<p>Use <code>config.import_config</code> to apply an entire packet filter configuration in one atomic call. This is the counterpart to <code>export_pages</code> \u2014 useful for deploying a known-good configuration to multiple devices.</p> <p>Flush all three tables before insert to keep foreign keys consistent</p> <p>Use <code>tableflush</code> on all three tables (<code>selected_services</code>, <code>serv_Protocols</code>, <code>services</code>) before re-inserting. This ensures a clean state where all foreign key references (<code>serv_id</code>, <code>service_id</code>) match the actual IDs in the inserted data. The factory default rulesets are automatically re-created by the system after flushing <code>services</code>.</p> <p>The example below rebuilds the entire packet filter from scratch: it flushes all three tables, re-inserts the factory default rulesets and rules, adds a custom L3 ruleset that drops and logs TCP port 80, and activates everything.</p> <pre><code>import json\nimport jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\nfilter_config = {\n    \"tableflush\": [\n        {\"tablename\": \"selected_services\"},\n        {\"tablename\": \"serv_Protocols\"},\n        {\"tablename\": \"services\"}\n    ],\n    \"tableinsert\": [\n        {\n            \"tablename\": \"services\",\n            \"data\": [\n                # Factory default rulesets\n                {\"id\": \"1\", \"name\": \"ARP\", \"description\": \"ARP address resolution\",\n                 \"layer_id\": \"1\", \"def_serv\": \"1\",\n                 \"src_interf_name\": \"*\", \"des_interf_name\": \"*\", \"fac_def_pos\": \"1\"},\n                {\"id\": \"2\", \"name\": \"ICMP_L2\",\n                 \"description\": \"Allow all Layer 2 ICMP packets\",\n                 \"layer_id\": \"1\", \"def_serv\": \"1\",\n                 \"src_interf_name\": \"*\", \"des_interf_name\": \"*\", \"fac_def_pos\": \"\"},\n                {\"id\": \"3\", \"name\": \"ICMP_L3\",\n                 \"description\": \"Allow all Layer 3 ICMP packets\",\n                 \"layer_id\": \"2\", \"def_serv\": \"1\",\n                 \"src_interf_name\": \"*\", \"des_interf_name\": \"*\", \"fac_def_pos\": \"\"},\n                {\"id\": \"4\", \"name\": \"Allow_L2\",\n                 \"description\": \"Allow all L2 traffic\",\n                 \"layer_id\": \"1\", \"def_serv\": \"1\",\n                 \"src_interf_name\": \"*\", \"des_interf_name\": \"*\", \"fac_def_pos\": \"2\"},\n                {\"id\": \"5\", \"name\": \"Allow_L3\",\n                 \"description\": \"Allow all L3 traffic\",\n                 \"layer_id\": \"2\", \"def_serv\": \"1\",\n                 \"src_interf_name\": \"*\", \"des_interf_name\": \"*\", \"fac_def_pos\": \"3\"},\n                {\"id\": \"6\", \"name\": \"Block_L2\",\n                 \"description\": \"Block all L2 traffic\",\n                 \"layer_id\": \"1\", \"def_serv\": \"1\",\n                 \"src_interf_name\": \"*\", \"des_interf_name\": \"*\", \"fac_def_pos\": \"\"},\n                {\"id\": \"7\", \"name\": \"Block_L3\",\n                 \"description\": \"Block all L3 traffic\",\n                 \"layer_id\": \"2\", \"def_serv\": \"1\",\n                 \"src_interf_name\": \"*\", \"des_interf_name\": \"*\", \"fac_def_pos\": \"\"},\n                {\"id\": \"8\", \"name\": \"Log_L2\",\n                 \"description\": \"Log and block all packets.\",\n                 \"layer_id\": \"1\", \"def_serv\": \"1\",\n                 \"src_interf_name\": \"*\", \"des_interf_name\": \"*\", \"fac_def_pos\": \"\"},\n                {\"id\": \"999\", \"name\": \"Log_L3\",\n                 \"description\": \"Log and block all packets.\",\n                 \"layer_id\": \"2\", \"def_serv\": \"1\",\n                 \"src_interf_name\": \"*\", \"des_interf_name\": \"*\", \"fac_def_pos\": \"\"},\n                # Custom ruleset\n                {\"id\": \"1000\", \"name\": \"FATT_Block_TCP80\",\n                 \"description\": \"Drop and Log TCP Port 80\",\n                 \"layer_id\": \"2\", \"def_serv\": \"0\",\n                 \"src_interf_name\": \"*\", \"des_interf_name\": \"*\", \"fac_def_pos\": \"\"}\n            ]\n        },\n        {\n            \"tablename\": \"serv_Protocols\",\n            \"data\": [\n                # Factory default rules\n                {\"id\": \"1\", \"service_id\": \"1\", \"protocol\": \"ARP\",\n                 \"action_id\": \"1\", \"log_active\": \"0\", \"alarm_active\": \"0\",\n                 \"description\": \"allow_all_arp\", \"icmp_type\": \"\", \"icmp_rej_type\": \"\",\n                 \"limitpack\": \"\", \"position\": \"1\",\n                 \"src_mac_add\": \"*\", \"src_ip_add\": \"\", \"src_netmask\": \"\",\n                 \"src_port\": \"\", \"des_mac_add\": \"*\", \"des_ip_add\": \"\",\n                 \"des_netmask\": \"\", \"des_port\": \"\",\n                 \"prot_hex\": \"10\", \"prot_transport\": \"\", \"state_type_id\": \"\",\n                 \"nat_ip\": \"\", \"nat_port\": \"\", \"states\": \"\", \"statevalue\": \"\",\n                 \"revert\": \"\", \"hide\": \"\",\n                 \"sigcheck_vpn\": \"\", \"sig_vpn\": \"\",\n                 \"sigcheck_cut\": \"\", \"sig_cut\": \"\",\n                 \"sigcheck_vpnup\": \"\", \"sig_vpnup\": \"\", \"audit_active\": \"0\"},\n                {\"id\": \"2\", \"service_id\": \"2\", \"protocol\": \"IPV4\",\n                 \"action_id\": \"1\", \"log_active\": \"0\", \"alarm_active\": \"0\",\n                 \"description\": \"any_ICMP_type\", \"icmp_type\": \"\", \"icmp_rej_type\": \"\",\n                 \"limitpack\": \"\", \"position\": \"1\",\n                 \"src_mac_add\": \"*\", \"src_ip_add\": \"*\", \"src_netmask\": \"*\",\n                 \"src_port\": \"\", \"des_mac_add\": \"*\", \"des_ip_add\": \"*\",\n                 \"des_netmask\": \"*\", \"des_port\": \"\",\n                 \"prot_hex\": \"\", \"prot_transport\": \"1\", \"state_type_id\": \"\",\n                 \"nat_ip\": \"\", \"nat_port\": \"\", \"states\": \"\", \"statevalue\": \"\",\n                 \"revert\": \"\", \"hide\": \"\",\n                 \"sigcheck_vpn\": \"\", \"sig_vpn\": \"\",\n                 \"sigcheck_cut\": \"\", \"sig_cut\": \"\",\n                 \"sigcheck_vpnup\": \"\", \"sig_vpnup\": \"\", \"audit_active\": \"0\"},\n                {\"id\": \"3\", \"service_id\": \"3\", \"protocol\": \"ICMP\",\n                 \"action_id\": \"1\", \"log_active\": \"0\", \"alarm_active\": \"0\",\n                 \"description\": \"ICMP_L3\", \"icmp_type\": \"any\", \"icmp_rej_type\": \"\",\n                 \"limitpack\": \"\", \"position\": \"1\",\n                 \"src_mac_add\": \"\", \"src_ip_add\": \"*\", \"src_netmask\": \"*\",\n                 \"src_port\": \"\", \"des_mac_add\": \"\", \"des_ip_add\": \"*\",\n                 \"des_netmask\": \"*\", \"des_port\": \"\",\n                 \"prot_hex\": \"\", \"prot_transport\": \"\", \"state_type_id\": \"1\",\n                 \"nat_ip\": \"\", \"nat_port\": \"\", \"states\": \"\", \"statevalue\": \"\",\n                 \"revert\": \"\", \"hide\": \"\",\n                 \"sigcheck_vpn\": \"\", \"sig_vpn\": \"\",\n                 \"sigcheck_cut\": \"\", \"sig_cut\": \"\",\n                 \"sigcheck_vpnup\": \"\", \"sig_vpnup\": \"\", \"audit_active\": \"0\"},\n                {\"id\": \"4\", \"service_id\": \"4\", \"protocol\": \"*\",\n                 \"action_id\": \"1\", \"log_active\": \"0\", \"alarm_active\": \"0\",\n                 \"description\": \"allow_all\", \"icmp_type\": \"\", \"icmp_rej_type\": \"\",\n                 \"limitpack\": \"\", \"position\": \"1\",\n                 \"src_mac_add\": \"*\", \"src_ip_add\": \"\", \"src_netmask\": \"\",\n                 \"src_port\": \"\", \"des_mac_add\": \"*\", \"des_ip_add\": \"\",\n                 \"des_netmask\": \"\", \"des_port\": \"\",\n                 \"prot_hex\": \"\", \"prot_transport\": \"\", \"state_type_id\": \"\",\n                 \"nat_ip\": \"\", \"nat_port\": \"\", \"states\": \"\", \"statevalue\": \"\",\n                 \"revert\": \"\", \"hide\": \"\",\n                 \"sigcheck_vpn\": \"\", \"sig_vpn\": \"\",\n                 \"sigcheck_cut\": \"\", \"sig_cut\": \"\",\n                 \"sigcheck_vpnup\": \"\", \"sig_vpnup\": \"\", \"audit_active\": \"0\"},\n                {\"id\": \"5\", \"service_id\": \"5\", \"protocol\": \"*\",\n                 \"action_id\": \"1\", \"log_active\": \"0\", \"alarm_active\": \"0\",\n                 \"description\": \"allow_all\", \"icmp_type\": \"\", \"icmp_rej_type\": \"\",\n                 \"limitpack\": \"\", \"position\": \"1\",\n                 \"src_mac_add\": \"\", \"src_ip_add\": \"*\", \"src_netmask\": \"*\",\n                 \"src_port\": \"\", \"des_mac_add\": \"\", \"des_ip_add\": \"*\",\n                 \"des_netmask\": \"*\", \"des_port\": \"\",\n                 \"prot_hex\": \"\", \"prot_transport\": \"\", \"state_type_id\": \"1\",\n                 \"nat_ip\": \"\", \"nat_port\": \"\", \"states\": \"\", \"statevalue\": \"\",\n                 \"revert\": \"\", \"hide\": \"\",\n                 \"sigcheck_vpn\": \"\", \"sig_vpn\": \"\",\n                 \"sigcheck_cut\": \"\", \"sig_cut\": \"\",\n                 \"sigcheck_vpnup\": \"\", \"sig_vpnup\": \"\", \"audit_active\": \"0\"},\n                {\"id\": \"6\", \"service_id\": \"6\", \"protocol\": \"*\",\n                 \"action_id\": \"2\", \"log_active\": \"0\", \"alarm_active\": \"0\",\n                 \"description\": \"drop_all\", \"icmp_type\": \"\", \"icmp_rej_type\": \"\",\n                 \"limitpack\": \"\", \"position\": \"1\",\n                 \"src_mac_add\": \"*\", \"src_ip_add\": \"\", \"src_netmask\": \"\",\n                 \"src_port\": \"\", \"des_mac_add\": \"*\", \"des_ip_add\": \"\",\n                 \"des_netmask\": \"\", \"des_port\": \"\",\n                 \"prot_hex\": \"\", \"prot_transport\": \"\", \"state_type_id\": \"\",\n                 \"nat_ip\": \"\", \"nat_port\": \"\", \"states\": \"\", \"statevalue\": \"\",\n                 \"revert\": \"\", \"hide\": \"\",\n                 \"sigcheck_vpn\": \"\", \"sig_vpn\": \"\",\n                 \"sigcheck_cut\": \"\", \"sig_cut\": \"\",\n                 \"sigcheck_vpnup\": \"\", \"sig_vpnup\": \"\", \"audit_active\": \"0\"},\n                {\"id\": \"7\", \"service_id\": \"7\", \"protocol\": \"*\",\n                 \"action_id\": \"2\", \"log_active\": \"0\", \"alarm_active\": \"0\",\n                 \"description\": \"drop_all\", \"icmp_type\": \"\", \"icmp_rej_type\": \"\",\n                 \"limitpack\": \"\", \"position\": \"1\",\n                 \"src_mac_add\": \"\", \"src_ip_add\": \"*\", \"src_netmask\": \"*\",\n                 \"src_port\": \"\", \"des_mac_add\": \"\", \"des_ip_add\": \"*\",\n                 \"des_netmask\": \"*\", \"des_port\": \"\",\n                 \"prot_hex\": \"\", \"prot_transport\": \"\", \"state_type_id\": \"1\",\n                 \"nat_ip\": \"\", \"nat_port\": \"\", \"states\": \"\", \"statevalue\": \"\",\n                 \"revert\": \"\", \"hide\": \"\",\n                 \"sigcheck_vpn\": \"\", \"sig_vpn\": \"\",\n                 \"sigcheck_cut\": \"\", \"sig_cut\": \"\",\n                 \"sigcheck_vpnup\": \"\", \"sig_vpnup\": \"\", \"audit_active\": \"0\"},\n                {\"id\": \"8\", \"service_id\": \"8\", \"protocol\": \"*\",\n                 \"action_id\": \"2\", \"log_active\": \"1\", \"alarm_active\": \"0\",\n                 \"description\": \"Log\", \"icmp_type\": \"\", \"icmp_rej_type\": \"\",\n                 \"limitpack\": \"\", \"position\": \"1\",\n                 \"src_mac_add\": \"*\", \"src_ip_add\": \"\", \"src_netmask\": \"\",\n                 \"src_port\": \"\", \"des_mac_add\": \"*\", \"des_ip_add\": \"\",\n                 \"des_netmask\": \"\", \"des_port\": \"\",\n                 \"prot_hex\": \"\", \"prot_transport\": \"\", \"state_type_id\": \"\",\n                 \"nat_ip\": \"\", \"nat_port\": \"\", \"states\": \"\", \"statevalue\": \"\",\n                 \"revert\": \"\", \"hide\": \"\",\n                 \"sigcheck_vpn\": \"\", \"sig_vpn\": \"\",\n                 \"sigcheck_cut\": \"\", \"sig_cut\": \"\",\n                 \"sigcheck_vpnup\": \"\", \"sig_vpnup\": \"\", \"audit_active\": \"0\"},\n                {\"id\": \"9\", \"service_id\": \"999\", \"protocol\": \"*\",\n                 \"action_id\": \"2\", \"log_active\": \"1\", \"alarm_active\": \"0\",\n                 \"description\": \"Log\", \"icmp_type\": \"\", \"icmp_rej_type\": \"\",\n                 \"limitpack\": \"\", \"position\": \"1\",\n                 \"src_mac_add\": \"\", \"src_ip_add\": \"*\", \"src_netmask\": \"*\",\n                 \"src_port\": \"\", \"des_mac_add\": \"\", \"des_ip_add\": \"*\",\n                 \"des_netmask\": \"*\", \"des_port\": \"\",\n                 \"prot_hex\": \"\", \"prot_transport\": \"\", \"state_type_id\": \"1\",\n                 \"nat_ip\": \"\", \"nat_port\": \"\", \"states\": \"\", \"statevalue\": \"\",\n                 \"revert\": \"\", \"hide\": \"\",\n                 \"sigcheck_vpn\": \"\", \"sig_vpn\": \"\",\n                 \"sigcheck_cut\": \"\", \"sig_cut\": \"\",\n                 \"sigcheck_vpnup\": \"\", \"sig_vpnup\": \"\", \"audit_active\": \"0\"},\n                # Custom forward rule\n                {\"id\": \"1000\", \"service_id\": \"1000\", \"protocol\": \"TCP\",\n                 \"action_id\": \"2\", \"log_active\": \"1\", \"alarm_active\": \"1\",\n                 \"description\": \"drop80\", \"icmp_type\": \"\", \"icmp_rej_type\": \"\",\n                 \"limitpack\": \"\", \"position\": \"1\",\n                 \"src_mac_add\": \"\", \"src_ip_add\": \"*\", \"src_netmask\": \"255.255.255.255\",\n                 \"src_port\": \"*\", \"des_mac_add\": \"\", \"des_ip_add\": \"*\",\n                 \"des_netmask\": \"255.255.255.255\", \"des_port\": \"80\",\n                 \"prot_hex\": \"\", \"prot_transport\": \"\", \"state_type_id\": \"1\",\n                 \"nat_ip\": \"\", \"nat_port\": \"\",\n                 \"states\": \"NEW,RELATED,ESTABLISHED\", \"statevalue\": \"\",\n                 \"revert\": \"\", \"hide\": \"\",\n                 \"sigcheck_vpn\": \"0\", \"sig_vpn\": \"0\",\n                 \"sigcheck_cut\": \"1\", \"sig_cut\": \"1\",\n                 \"sigcheck_vpnup\": \"0\", \"sig_vpnup\": \"0\",\n                 \"audit_active\": \"1\"}\n            ]\n        },\n        {\n            \"tablename\": \"selected_services\",\n            \"data\": [\n                # Activate factory defaults\n                {\"id\": \"1\", \"serv_id\": \"1\", \"days\": \"\", \"time_active\": \"0\",\n                 \"time_start\": \"\", \"time_stop\": \"\", \"position\": \"1\"},     # ARP\n                {\"id\": \"2\", \"serv_id\": \"4\", \"days\": \"\", \"time_active\": \"0\",\n                 \"time_start\": \"\", \"time_stop\": \"\", \"position\": \"2\"},     # Allow_L2\n                {\"id\": \"3\", \"serv_id\": \"5\", \"days\": \"\", \"time_active\": \"0\",\n                 \"time_start\": \"\", \"time_stop\": \"\", \"position\": \"2\"},     # Allow_L3\n                # Activate custom ruleset\n                {\"id\": \"4\", \"serv_id\": \"1000\", \"days\": \"\", \"time_active\": \"0\",\n                 \"time_start\": \"\", \"time_stop\": \"\", \"position\": \"1\"}\n            ]\n        }\n    ]\n}\n\ndev.call(\"config\", \"import_config\", jsondata=filter_config)\nprint(\"Packet filter configuration imported successfully\")\n\n# Reload both L3 and L2 filters to apply changes\nimport time\ntrigger = str(int(time.time()))\ndev.config_set_commit({\"l3_forward\": trigger, \"l2_forward\": trigger})\n\ndev.logout()\n</code></pre> <p>Export \u2192 edit \u2192 import workflow</p> <p>A practical workflow is to export the current configuration with <code>export_pages</code>, modify the JSON, then apply it with <code>import_config</code>. Add <code>tableflush</code> entries for any tables where you need to replace (not just append) rows.</p>"},{"location":"guides/packet-filter/examples/#reading-existing-rulesets","title":"Reading Existing Rulesets","text":"<pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# Get the ARP ruleset\narp_ruleset = dev.table_get(\"services\", \"name\", \"ARP\")\nprint(arp_ruleset)\n\n# Get all rules in the ARP ruleset (service_id = \"1\")\narp_rules = dev.table_get(\"serv_Protocols\", \"service_id\", \"1\")\nprint(arp_rules)\n\n# List active rulesets\nactive = dev.table_get(\"selected_services\", \"serv_id\", \"1\")\nprint(active)\n\ndev.logout()\n</code></pre>"},{"location":"guides/packet-filter/examples/#creating-a-ruleset-with-an-l3-rule","title":"Creating a Ruleset with an L3 Rule","text":"<p>This example creates an L3 ruleset that allows TCP traffic from <code>192.168.1.0/24</code> to port 443, then activates it.</p> <p>Integer <code>id</code> columns require explicit values \u2014 <code>1000</code>+ for custom entries</p> <p>Tables with an <code>id</code> primary key do not auto-increment. You must provide a unique non-zero integer for every insert. Custom entries must use IDs starting at <code>1000</code> or higher. IDs below 1000 are reserved for factory defaults \u2014 rules inserted with lower IDs may not appear in the device web UI.</p> <p>Step 1 \u2014 Create the ruleset:</p> <pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\nSERVICE_ID = \"1000\"      # custom ruleset ID (must not conflict with existing)\nRULE_ID = \"1000\"         # custom rule ID\nACTIVATION_ID = \"1000\"   # custom activation ID\n\n# Create the ruleset in a config session\ncfg = dev.sess_start()\ndev.table_insert(\"services\", cfg, [\n    SERVICE_ID,          # id (explicit, unique, non-zero)\n    \"HTTPS_Allow\",       # name\n    \"Allow HTTPS from LAN\",  # description\n    \"2\",                 # layer_id: L3 (iptables)\n    \"0\",                 # def_serv: custom ruleset\n    \"*\",                 # src_interf_name: any\n    \"*\",                 # des_interf_name: any\n    \"\"                   # fac_def_pos: not a factory default\n])\ndev.sess_commit(cfg)\n</code></pre> <p>Step 2 \u2014 Add a forward rule and its reverse rule:</p> <p>Always consider the reverse path</p> <p>For ACCEPT rules, you must handle return traffic. The web UI creates a pair of rules: a forward rule matching <code>NEW,RELATED,ESTABLISHED</code> and a hidden companion reverse rule matching <code>RELATED,ESTABLISHED</code> with <code>revert=\"1\"</code> and <code>hide=\"1\"</code>. Follow the same pattern when inserting rules via the API.</p> <p>DROP rules do not need a reverse rule \u2014 there is no return traffic to handle.</p> <pre><code>REVERSE_RULE_ID = \"1001\"  # companion reverse rule\n\n# Add an L3 rule: allow TCP to port 443 from 192.168.1.0/24\ncfg = dev.sess_start()\n\n# Forward rule\ndev.table_insert(\"serv_Protocols\", cfg, [\n    RULE_ID,             # id (explicit, unique, &gt;= 1000)\n    SERVICE_ID,          # service_id\n    \"TCP\",               # protocol\n    \"1\",                 # action_id: ACCEPT\n    \"0\",                 # log_active\n    \"0\",                 # alarm_active\n    \"Allow_HTTPS\",       # description\n    \"\",                  # icmp_type (not ICMP)\n    \"\",                  # icmp_rej_type\n    \"\",                  # limitpack (no rate limit)\n    \"1\",                 # position\n    \"\",                  # src_mac_add (L3, not used)\n    \"192.168.1.0\",       # src_ip_add\n    \"255.255.255.0\",     # src_netmask\n    \"\",                  # src_port (any)\n    \"\",                  # des_mac_add (L3, not used)\n    \"*\",                 # des_ip_add (any destination)\n    \"255.255.255.255\",   # des_netmask\n    \"443\",               # des_port\n    \"\",                  # prot_hex (L3, not used)\n    \"\",                  # prot_transport (L3, not used)\n    \"1\",                 # state_type_id: conntrack\n    \"\",                  # nat_ip (reserved)\n    \"\",                  # nat_port (reserved)\n    \"NEW,RELATED,ESTABLISHED\",  # states\n    \"\",                  # statevalue (L3, not used)\n    \"\",                  # revert: not set on forward rule\n    \"0\",                 # hide\n    \"0\",                 # sigcheck_vpn\n    \"0\",                 # sig_vpn\n    \"0\",                 # sigcheck_cut\n    \"0\",                 # sig_cut\n    \"0\",                 # sigcheck_vpnup\n    \"0\",                 # sig_vpnup\n    \"0\"                  # audit_active\n])\n\n# Companion reverse rule (return traffic)\ndev.table_insert(\"serv_Protocols\", cfg, [\n    REVERSE_RULE_ID,     # id\n    SERVICE_ID,          # service_id (same ruleset)\n    \"TCP\",               # protocol\n    \"1\",                 # action_id: ACCEPT\n    \"0\",                 # log_active\n    \"0\",                 # alarm_active\n    \"\",                  # description (empty for reverse rules)\n    \"\",                  # icmp_type\n    \"\",                  # icmp_rej_type\n    \"\",                  # limitpack\n    \"1\",                 # position\n    \"\",                  # src_mac_add\n    \"*\",                 # src_ip_add\n    \"255.255.255.255\",   # src_netmask\n    \"\",                  # src_port\n    \"\",                  # des_mac_add\n    \"*\",                 # des_ip_add\n    \"255.255.255.255\",   # des_netmask\n    \"\",                  # des_port\n    \"\",                  # prot_hex\n    \"\",                  # prot_transport\n    \"1\",                 # state_type_id: conntrack\n    \"\",                  # nat_ip\n    \"\",                  # nat_port\n    \"RELATED,ESTABLISHED\",  # states (return traffic only)\n    \"\",                  # statevalue\n    \"1\",                 # revert: marks this as a reverse rule\n    \"1\",                 # hide: hidden in web UI\n    \"\",                  # sigcheck_vpn (empty for reverse rules)\n    \"\",                  # sig_vpn\n    \"\",                  # sigcheck_cut\n    \"\",                  # sig_cut\n    \"\",                  # sigcheck_vpnup\n    \"\",                  # sig_vpnup\n    \"0\"                  # audit_active\n])\n\ndev.sess_commit(cfg)\n</code></pre> <p>Step 3 \u2014 Activate the ruleset:</p> <pre><code>cfg = dev.sess_start()\ndev.table_insert(\"selected_services\", cfg, [\n    ACTIVATION_ID,       # id (explicit, unique, non-zero)\n    SERVICE_ID,          # serv_id\n    \"\",                  # days (all days)\n    \"0\",                 # time_active (no time restriction)\n    \"\",                  # time_start\n    \"\",                  # time_stop\n    \"10\"                 # position\n])\ndev.sess_commit(cfg)\n</code></pre> <p>Step 4 \u2014 Reload the packet filter:</p> <pre><code>import time\ndev.config_set_commit({\"l3_forward\": str(int(time.time()))})\n\ndev.logout()\n</code></pre> <p>Note</p> <p>Without the <code>l3_forward</code> trigger, table changes are stored but the running filter is not updated. See Applying Changes.</p>"},{"location":"guides/packet-filter/examples/#modifying-a-rule","title":"Modifying a Rule","text":"<p>Update specific fields of an existing rule using <code>table_up</code>:</p> <pre><code>cfg = dev.sess_start()\ndev.table_up(\"serv_Protocols\", cfg,\n    condition={\"description\": \"Allow_HTTPS\"},\n    values={\"des_port\": \"8443\", \"log_active\": \"1\"}\n)\ndev.sess_commit(cfg)\n\n# Reload the filter to apply changes\ndev.config_set_commit({\"l3_forward\": str(int(time.time()))})\n</code></pre>"},{"location":"guides/packet-filter/examples/#deleting-a-rule","title":"Deleting a Rule","text":"<p>Delete a rule and its companion reverse rule (if any). Reverse rules have <code>revert=\"1\"</code> and the same <code>service_id</code>/<code>position</code>:</p> <pre><code>cfg = dev.sess_start()\n# Delete the forward rule\ndev.table_del(\"serv_Protocols\", cfg,\n    condition={\"description\": \"Allow_HTTPS\"}\n)\n# Delete the companion reverse rule (revert=\"1\", same service_id)\ndev.table_del(\"serv_Protocols\", cfg,\n    condition={\"id\": \"1001\"}\n)\ndev.sess_commit(cfg)\n\n# Reload the filter to apply changes\ndev.config_set_commit({\"l3_forward\": str(int(time.time()))})\n</code></pre>"},{"location":"guides/packet-filter/examples/#deleting-a-ruleset","title":"Deleting a Ruleset","text":"<p>Deletion order matters</p> <p>Always delete in this order: deactivate the ruleset, delete its rules, then delete the ruleset itself. Deleting a ruleset while it still has rules or is still active may leave orphaned data.</p> <pre><code>ruleset = dev.table_get(\"services\", \"name\", \"HTTPS_Allow\")\nservice_id = ruleset[\"id\"]\n\ncfg = dev.sess_start()\n\n# 1. Deactivate: remove from selected_services\ndev.table_del(\"selected_services\", cfg,\n    condition={\"serv_id\": service_id}\n)\n\n# 2. Delete all rules in the ruleset\ndev.table_del(\"serv_Protocols\", cfg,\n    condition={\"service_id\": service_id}\n)\n\n# 3. Delete the ruleset itself\ndev.table_del(\"services\", cfg,\n    condition={\"name\": \"HTTPS_Allow\"}\n)\n\ndev.sess_commit(cfg)\n\n# Reload the filter to apply changes\ndev.config_set_commit({\"l3_forward\": str(int(time.time()))})\n</code></pre>"},{"location":"guides/packet-filter/examples/#using-ip-groups","title":"Using IP Groups","text":"<p>Reference entries from the <code>ipgroups</code> table using the <code>@groupname</code> syntax in address fields:</p> <pre><code># First, create the IP group\ncfg = dev.sess_start()\ndev.table_insert(\"ipgroups\", cfg, [\"office\", \"192.168.1.0/24\"])\ndev.table_insert(\"ipgroups\", cfg, [\"office\", \"10.0.0.0/8\"])\ndev.sess_commit(cfg)\n\n# Then reference it in a rule's src_ip_add field\ncfg = dev.sess_start()\ndev.table_insert(\"serv_Protocols\", cfg, [\n    \"1002\",              # id (explicit, unique, &gt;= 1000)\n    service_id,          # service_id\n    \"TCP\",               # protocol\n    \"1\",                 # action_id: ACCEPT\n    \"0\", \"0\",            # log_active, alarm_active\n    \"Office_HTTPS\",      # description\n    \"\", \"\",              # icmp_type, icmp_rej_type\n    \"\",                  # limitpack\n    \"1\",                 # position\n    \"\",                  # src_mac_add\n    \"@office\",           # src_ip_add: reference IP group\n    \"\",                  # src_netmask (ignored with groups)\n    \"\",                  # src_port\n    \"\",                  # des_mac_add\n    \"*\", \"255.255.255.255\",  # des_ip_add, des_netmask\n    \"443\",               # des_port\n    \"\", \"\",              # prot_hex, prot_transport\n    \"1\",                 # state_type_id\n    \"\", \"\",              # nat_ip, nat_port\n    \"NEW,RELATED,ESTABLISHED\",  # states\n    \"\",                  # statevalue\n    \"\",                  # revert (not set on forward rule)\n    \"0\",                 # hide\n    \"0\", \"0\",            # sigcheck_vpn, sig_vpn\n    \"0\", \"0\",            # sigcheck_cut, sig_cut\n    \"0\", \"0\",            # sigcheck_vpnup, sig_vpnup\n    \"0\"                  # audit_active\n])\ndev.sess_commit(cfg)\n</code></pre>"},{"location":"guides/packet-filter/examples/#time-based-scheduling","title":"Time-Based Scheduling","text":"<p>Restrict a ruleset to business hours on weekdays:</p> <pre><code>cfg = dev.sess_start()\ndev.table_insert(\"selected_services\", cfg, [\n    \"1001\",                      # id (explicit, unique, non-zero)\n    service_id,                  # serv_id\n    \"Mon,Tue,Wed,Thu,Fri\",       # days\n    \"1\",                         # time_active: enabled\n    \"08:00\",                     # time_start\n    \"17:00\",                     # time_stop\n    \"10\"                         # position\n])\ndev.sess_commit(cfg)\n</code></pre>"},{"location":"guides/packet-filter/examples/#logging-troubleshooting","title":"Logging &amp; Troubleshooting","text":"<p>Enable <code>log_active=\"1\"</code> on a rule to log matched packets to syslog. Retrieve them via the <code>eventlog</code> status property:</p> <pre><code># Get recent packet filter log entries\npf_log = dev.status(\"eventlog\", \"50\", \"FILTER|IN=.*OUT=\")\nfor line in pf_log.strip().split(\"\\n\"):\n    if line:\n        print(line)\n</code></pre> <p>Each logged packet appears as a kernel syslog line with the prefix <code>{ruleset_name}.{rule_description}</code> \u2014 for example, <code>HTTPS_Allow.Allow_HTTPS IN=ETH7 OUT=ETH2 ...</code>. See the Packet Filter Log Format reference for the full field specification.</p> <p>Move a LOG rule through the ruleset order</p> <p>Create a dedicated LOG ruleset (e.g., <code>log_active=\"1\"</code>, action ACCEPT, matching all traffic) and change its <code>selected_services.position</code> to insert it before or after specific rulesets. This lets you observe which packets reach a given point in the filter chain \u2014 if a packet appears in the log at position 2 but not at position 4, it was consumed by a ruleset in between. Move the LOG ruleset up and down to isolate exactly where traffic is being accepted, dropped, or redirected.</p> <p>Combine with datacollection counters</p> <p>Use the packet filter counters from the <code>datacollection</code> API for real-time byte/packet counts without per-packet overhead. Use the event log for detailed per-packet inspection when <code>log_active</code> is enabled on a rule.</p>"},{"location":"guides/packet-filter/examples/#monitoring-packet-filter-counters","title":"Monitoring Packet Filter Counters","text":"<p>The <code>datacollection</code> API provides real-time byte counters for every active packet filter rule. This is essential for verifying that rules are matching traffic as expected \u2014 confirming that packets are being accepted, dropped, or rejected by the correct rules.</p>"},{"location":"guides/packet-filter/examples/#how-metric-names-map-to-rules","title":"How Metric Names Map to Rules","text":"<p>When a ruleset is activated, the device creates iptables/ebtables chains and tracks byte counts per rule. These counters are exposed as <code>datacollection</code> metrics with the following naming pattern:</p> Pattern Example Description <code>filter.rule._{ruleset}.{action}.{index}.bcnt</code> <code>filter.rule._Allow_L3.ACCEPT.0.bcnt</code> Bytes matched by a rule inside the ruleset's chain <code>filter.rule.FORWARD._{ruleset}.{index}.bcnt</code> <code>filter.rule.FORWARD._Allow_L3.2.bcnt</code> Bytes hitting the jump from FORWARD into the ruleset's chain <code>filter.policy.FORWARD.DROP.bcnt</code> <code>filter.policy.FORWARD.DROP.bcnt</code> Bytes hitting the FORWARD chain's default policy (DROP) <p>Note the leading underscore (<code>_</code>) before the ruleset name \u2014 this is how the device names its internal iptables chains.</p> <p>Use counters to debug rules</p> <p>If a rule's counter stays at zero while you expect traffic to match, check the rule's position, protocol, and address fields. If the FORWARD DROP policy counter increases instead, traffic is reaching the end of the chain without matching any ACCEPT rule.</p>"},{"location":"guides/packet-filter/examples/#discovering-available-filter-metrics","title":"Discovering Available Filter Metrics","text":"<p>List all filter-related metrics on the device:</p> <pre><code>import jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\nraw = dev.call(\"datacollection\", \"get_metrics\")\nfilter_metrics = sorted(\n    m for m in raw[\"result\"] if m.startswith(\"filter.\")\n)\nfor m in filter_metrics:\n    print(m)\n\ndev.logout()\n</code></pre> <p>Example output on an IRF3000 with <code>Allow_L3</code> and a custom <code>FATT_Block_TCP80</code> ruleset active:</p> <pre><code>filter.policy.FORWARD.DROP.bcnt\nfilter.policy.INPUT.ACCEPT.bcnt\nfilter.policy.OUTPUT.ACCEPT.bcnt\nfilter.rule.FORWARD.ACCEPT.0.bcnt\nfilter.rule.FORWARD._Allow_L3.2.bcnt\nfilter.rule.FORWARD._FATT_Block_TCP80.3.bcnt\nfilter.rule._Allow_L3.ACCEPT.0.bcnt\nfilter.rule._FATT_Block_TCP80.DROP.0.bcnt\n</code></pre>"},{"location":"guides/packet-filter/examples/#querying-counters-for-a-specific-ruleset","title":"Querying Counters for a Specific Ruleset","text":"<p>Query the byte counters of the <code>Allow_L3</code> ruleset from the last 10 minutes:</p> <pre><code>import time\nimport jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# Find all metrics for Allow_L3\nraw = dev.call(\"datacollection\", \"get_metrics\")\nallow_l3_metrics = sorted(\n    m for m in raw[\"result\"]\n    if \"_Allow_L3\" in m\n)\nprint(f\"Allow_L3 metrics: {allow_l3_metrics}\")\n\n# Query the last 10 minutes of data\nnow = int(time.time())\nraw = dev.call(\"datacollection\", \"get_values_as_table\",\n    metrics=allow_l3_metrics,\n    **{\"from\": now - 600, \"to\": now, \"resolution\": 1})\ndata = raw[\"result\"]\n\nfor metric, points in data.items():\n    non_null = [p for p in points if p[\"val\"] is not None]\n    total = sum(p[\"val\"] for p in non_null)\n    print(f\"{metric}: {len(non_null)} samples, {total:.0f} bytes total\")\n\ndev.logout()\n</code></pre>"},{"location":"guides/packet-filter/examples/#monitoring-the-custom-rule-from-the-import-example","title":"Monitoring the Custom Rule from the Import Example","text":"<p>The import example above creates a ruleset <code>FATT_Block_TCP80</code> (service ID 1000) that drops and logs TCP port 80 traffic. Once deployed, you can verify it is catching packets:</p> <pre><code>import time\nimport jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# The custom ruleset's metrics\nmetrics = [\n    \"filter.rule._FATT_Block_TCP80.DROP.0.bcnt\",   # the DROP rule itself\n    \"filter.rule.FORWARD._FATT_Block_TCP80.3.bcnt\", # jump from FORWARD\n    \"filter.policy.FORWARD.DROP.bcnt\"                # default policy\n]\n\nnow = int(time.time())\nraw = dev.call(\"datacollection\", \"get_values_as_table\",\n    metrics=metrics,\n    **{\"from\": now - 600, \"to\": now, \"resolution\": 1})\ndata = raw[\"result\"]\n\nfor metric in metrics:\n    points = data.get(metric, [])\n    non_null = [p for p in points if p[\"val\"] is not None]\n    total = sum(p[\"val\"] for p in non_null)\n    latest = non_null[-1][\"val\"] if non_null else 0\n    label = metric.replace(\"filter.rule.\", \"\").replace(\"filter.policy.\", \"\").replace(\".bcnt\", \"\")\n    print(f\"{label:45s}  total={total:&gt;10.0f} B  latest={latest:&gt;8.0f} B\")\n\ndev.logout()\n</code></pre> <p>Example output when HTTP traffic is being blocked:</p> <pre><code>_FATT_Block_TCP80.DROP.0                        total=     24680 B  latest=     1240 B\nFORWARD._FATT_Block_TCP80.3                     total=     24680 B  latest=     1240 B\nFORWARD.DROP                                    total=         0 B  latest=        0 B\n</code></pre> <p>In this output:</p> <ul> <li>The <code>DROP.0</code> counter confirms the rule is matching and dropping TCP port 80 traffic.</li> <li>The <code>FORWARD._FATT_Block_TCP80.3</code> counter matches \u2014 all traffic that enters the ruleset chain hits the rule.</li> <li>The <code>FORWARD.DROP</code> policy counter is zero \u2014 no traffic is falling through to the default policy, which means all forwarded traffic is handled by explicit rules.</li> </ul>"},{"location":"guides/packet-filter/examples/#continuous-monitoring-loop","title":"Continuous Monitoring Loop","text":"<p>Poll counters every 10 seconds and print non-zero deltas:</p> <pre><code>import time\nimport jsonrpcdevice\n\ndev = jsonrpcdevice.AdstecJSONRPCDevice(\"192.168.0.254\", \"admin\", \"admin\")\n\n# Collect all filter metrics\nraw = dev.call(\"datacollection\", \"get_metrics\")\nfilter_metrics = sorted(m for m in raw[\"result\"] if m.startswith(\"filter.\"))\n\nprev = {}\nprint(\"Monitoring filter counters (Ctrl+C to stop)...\\n\")\n\ntry:\n    while True:\n        now = int(time.time())\n        raw = dev.call(\"datacollection\", \"get_values_as_table\",\n            metrics=filter_metrics,\n            **{\"from\": now - 30, \"to\": now, \"resolution\": 1})\n        data = raw[\"result\"]\n\n        ts = time.strftime(\"%H:%M:%S\")\n        for metric in filter_metrics:\n            points = data.get(metric, [])\n            # Use the latest non-null value\n            current = None\n            for p in reversed(points):\n                if p[\"val\"] is not None:\n                    current = p[\"val\"]\n                    break\n            if current is None:\n                continue\n\n            delta = current - prev.get(metric, current)\n            prev[metric] = current\n\n            if delta != 0:\n                label = metric.replace(\"filter.\", \"\")\n                print(f\"[{ts}] {label:50s} delta={delta:&gt;+10.0f} B\")\n\n        time.sleep(10)\nexcept KeyboardInterrupt:\n    pass\nfinally:\n    dev.logout()\n</code></pre> <p>Data collection interval</p> <p>The device collects counter data every 10 seconds. Polling faster than this interval will not produce additional data points. Each value represents the byte count delta for that 10-second interval, not an absolute counter.</p> <p>See also the <code>examples/filter_monitor.py</code> script for a ready-to-run version that auto-discovers metrics for a given ruleset.</p>"},{"location":"guides/packet-filter/rule-modes/","title":"Rule Modes","text":"<p>The columns referenced below (<code>state_type_id</code>, <code>revert</code>, <code>states</code>, <code>statevalue</code>) are part of the <code>serv_Protocols</code> table. See the Table Reference for full column schemas.</p>"},{"location":"guides/packet-filter/rule-modes/#l3-rule-modes-easy-stateful-and-stateless","title":"L3 Rule Modes: Easy, Stateful, and Stateless","text":"<p>Layer 3 (iptables) rulesets support three distinct modes for handling connection state and return traffic. Each mode represents a different trade-off between simplicity, flexibility, and performance.</p> <p>Do not mix modes within a ruleset</p> <p>All rules within a single ruleset should use the same mode. Mixing modes (e.g., a stateful rule and a stateless rule in the same ruleset) leads to unpredictable behavior because the return-traffic handling assumptions conflict. Create separate rulesets if you need different modes.</p>"},{"location":"guides/packet-filter/rule-modes/#easy-mode-default","title":"Easy Mode (Default)","text":"<p>Fields: <code>revert=\"1\"</code>, <code>state_type_id=\"\"</code>, <code>states=\"\"</code></p> <p>This is the default mode in the device web UI. The user defines a rule for one direction only, and the system automatically generates a hidden reverse rule using conntrack to allow the return traffic. The user never has to think about connection states or return packets.</p> <p>How it works: When a rule has <code>revert=\"1\"</code>, the device automatically creates a second iptables rule in a reverse chain that uses conntrack (<code>-m conntrack --ctstate RELATED,ESTABLISHED</code>) to match return traffic for connections allowed by the forward rule.</p> <p>Pros:</p> <ul> <li>Simplest to configure \u2014 define one direction, return traffic is handled automatically</li> <li>Lowest risk of misconfiguration \u2014 no state or flag parameters to get wrong</li> <li>Default in the web UI, suitable for most use cases</li> </ul> <p>Cons:</p> <ul> <li>Uses conntrack, which has a finite connection table (can overflow under very high connection rates)</li> <li>Less control \u2014 you cannot fine-tune which return traffic is allowed</li> <li>The hidden reverse rule is not visible in the table, which can be confusing when debugging via API</li> </ul> <p>Example rule values: <pre><code>revert=\"1\", state_type_id=\"\", states=\"\"\n</code></pre></p>"},{"location":"guides/packet-filter/rule-modes/#stateful-mode","title":"Stateful Mode","text":"<p>Fields: <code>revert=\"0\"</code>, <code>state_type_id=\"1\"</code> or <code>\"3\"</code>, <code>states=\"NEW,RELATED,ESTABLISHED\"</code></p> <p>Classic iptables stateful filtering using the conntrack module. The user explicitly specifies which connection states to match (e.g., <code>NEW</code>, <code>ESTABLISHED</code>, <code>RELATED</code>, <code>INVALID</code>). The user is responsible for creating matching rules for both directions or using appropriate state combinations.</p> <p>How it works: The rule translates directly to <code>-m conntrack --ctstate &lt;states&gt;</code> in iptables. <code>state_type_id=\"1\"</code> and <code>\"3\"</code> both use conntrack; <code>\"3\"</code> additionally applies to auto-generated reverse chains for directional rulesets.</p> <p>Pros:</p> <ul> <li>Full control over which connection states are matched</li> <li>Well-understood iptables paradigm \u2014 extensive documentation and tooling available</li> <li>Can create precise rules like \"allow only established return traffic\" or \"block invalid packets\"</li> </ul> <p>Cons:</p> <ul> <li>More complex to configure correctly \u2014 the user must understand conntrack states</li> <li>Requires explicit rules for return traffic (or careful use of <code>ESTABLISHED,RELATED</code>)</li> <li>Still uses conntrack, so the same connection table limits apply as easy mode</li> </ul> <p>Example rule values: <pre><code>revert=\"0\", state_type_id=\"1\", states=\"NEW,RELATED,ESTABLISHED\"\n</code></pre></p>"},{"location":"guides/packet-filter/rule-modes/#stateless-mode","title":"Stateless Mode","text":"<p>Fields: <code>revert=\"0\"</code>, <code>state_type_id=\"2\"</code>, <code>states=&lt;tcp-flags&gt;</code></p> <p>Low-level stateless filtering using TCP flags only, bypassing the conntrack module entirely. Rules match individual packets based on their TCP flag combination (SYN, ACK, FIN, RST, etc.) without any connection tracking.</p> <p>How it works: The rule translates to <code>--tcp-flags &lt;flags-to-check&gt; &lt;expected-flags&gt;</code> in iptables. The <code>states</code> field contains the flag specification (e.g., <code>SYN,ACK,FIN,RST SYN</code> to match SYN-only packets). On L2 (ebtables), the <code>statevalue</code> field encodes flags as a 12-bit integer instead.</p> <p>Pros:</p> <ul> <li>Highest performance \u2014 no conntrack overhead, no connection table, no per-connection memory</li> <li>Ideal for high-throughput scenarios or DDoS mitigation where conntrack would be a bottleneck</li> <li>Deterministic \u2014 each packet is evaluated independently, no state table to overflow</li> </ul> <p>Cons:</p> <ul> <li>Most complex to configure \u2014 requires deep understanding of TCP flag combinations</li> <li>The user must create explicit rules for every traffic direction and packet type (SYN, SYN+ACK, ACK, FIN, etc.)</li> <li>No automatic handling of related traffic (e.g., ICMP error messages for TCP connections)</li> <li>Easy to misconfigure \u2014 a missing flag combination silently drops legitimate traffic</li> </ul> <p>Example rule values: <pre><code>revert=\"0\", state_type_id=\"2\", states=\"SYN,ACK,FIN,RST SYN\"\n</code></pre></p>"},{"location":"guides/packet-filter/rule-modes/#mode-comparison","title":"Mode Comparison","text":"Easy Stateful Stateless Complexity Low Medium High Performance Good Good Best Conntrack Yes (hidden) Yes (explicit) No Return traffic Automatic Manual (via states) Manual (via TCP flags) <code>revert</code> <code>\"1\"</code> <code>\"0\"</code> <code>\"0\"</code> <code>state_type_id</code> <code>\"\"</code> <code>\"1\"</code> or <code>\"3\"</code> <code>\"2\"</code> <code>states</code> <code>\"\"</code> <code>NEW,RELATED,...</code> TCP flag spec Web UI default Yes Selectable Selectable Recommended for General use Fine-grained control High-throughput, DDoS"},{"location":"guides/packet-filter/rule-modes/#l2-filtering-ebtables","title":"L2 Filtering (ebtables)","text":"<p>Layer 2 rulesets (<code>layer_id=\"1\"</code>) use ebtables instead of iptables and operate on Ethernet frames. L2 filtering has fundamental differences from L3 that affect how rules are constructed and how state is handled.</p>"},{"location":"guides/packet-filter/rule-modes/#no-native-conntrack","title":"No Native Conntrack","text":"<p>Ebtables has no conntrack module. The three L3 modes (easy, stateful, stateless) do not apply to L2 in the same way. On L2:</p> <ul> <li>Easy mode (<code>revert=\"1\"</code>) still works for directional rulesets \u2014 the reverse rule is placed in a separate chain. However, this is a simple directional reversal, not conntrack-based return traffic matching.</li> <li>Stateful mode (<code>state_type_id=\"1\"</code>) is not available on L2 \u2014 ebtables has no conntrack.</li> <li>TCP flag matching is supported on L2 via the <code>states</code> and <code>statevalue</code> fields. Set <code>states</code> to the human-readable flag specification (e.g., <code>\"SYN,ACK,FIN,RST SYN\"</code>) and <code>statevalue</code> to the corresponding numeric encoding. The system handles the translation internally.</li> </ul>"},{"location":"guides/packet-filter/rule-modes/#protocol-handling","title":"Protocol Handling","text":"<p>L2 rules use the <code>protocol</code> field differently from L3:</p> <code>protocol</code> <code>prot_transport</code> <code>prot_hex</code> Meaning <code>\"ARP\"</code> \u2014 opcode (e.g. <code>\"10\"</code> = any) ARP frames; <code>prot_hex</code> is the ARP opcode <code>\"IPV4\"</code> <code>\"6\"</code> \u2014 IPv4 + TCP (<code>--ip-protocol 6</code>) <code>\"IPV4\"</code> <code>\"17\"</code> \u2014 IPv4 + UDP (<code>--ip-protocol 17</code>) <code>\"IPV4\"</code> <code>\"1\"</code> \u2014 IPv4 + ICMP (<code>--ip-protocol 1</code>) <code>\"IPV4\"</code> <code>\"*\"</code> \u2014 IPv4 any transport <code>\"802_1Q\"</code> \u2014 \u2014 VLAN-tagged frames (uses <code>vlan_data</code> table for VLAN ID/priority) (other) \u2014 hex value Raw Ethernet protocol by hex; <code>\"0000\"</code> = LENGTH (legacy Ethernet II)"},{"location":"guides/packet-filter/rule-modes/#mac-and-ip-groups-on-l2","title":"MAC and IP Groups on L2","text":"<p>Group handling differs from L3:</p> <ul> <li>MAC groups (<code>@groupname</code> in <code>src_mac_add</code>/<code>des_mac_add</code>): resolved from the <code>macgroups</code> table and applied using ebtables <code>--among-src</code>/<code>--among-dst</code> (comma-separated MAC list in a single rule).</li> <li>IP groups (<code>@groupname</code> in <code>src_ip_add</code>/<code>des_ip_add</code>): since ebtables has no <code>ipset</code> support, each IP/network entry from the <code>ipgroups</code> table is expanded into a separate ebtables rule. Large IP groups generate many rules, which can impact performance.</li> </ul> <p>Prefer MAC groups over IP groups on L2</p> <p>MAC groups are efficient on L2 because ebtables handles them in a single rule with <code>--among</code>. IP groups are expanded into individual rules, so large groups significantly increase the rule count and evaluation time.</p>"},{"location":"guides/packet-filter/tables/","title":"Table Reference","text":"<p>See also the Firewall Tables API Reference for the table schemas alongside <code>ipgroups</code> and <code>macgroups</code>. For table operations (<code>table_get</code>, <code>table_insert</code>, <code>table_up</code>, <code>table_del</code>), see Tables.</p>"},{"location":"guides/packet-filter/tables/#services","title":"<code>services</code>","text":"<p>Rulesets group related filter rules. Each ruleset is either Layer 2 (ebtables) or Layer 3 (iptables).</p> Index Column Type Constraint Description 0 <code>id</code> integer unique, non-zero Primary key (no auto-increment); custom rulesets must use <code>1000</code>+ 1 <code>name</code> string max 32, <code>[-0-9A-Za-z_]</code> Ruleset name 2 <code>description</code> string max 255 Human-readable description 3 <code>layer_id</code> <code>\"1\"</code> / <code>\"2\"</code> required <code>\"1\"</code> = L2 (ebtables), <code>\"2\"</code> = L3 (iptables) 4 <code>def_serv</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = factory default (read-only); must be <code>\"0\"</code> or <code>\"1\"</code>, not emptyets 5 <code>src_interf_name</code> string Source interface or <code>\"*\"</code> for any 6 <code>des_interf_name</code> string Destination interface or <code>\"*\"</code> for any 7 <code>fac_def_pos</code> integer Factory default position (leave <code>\"\"</code> for custom rulesets)"},{"location":"guides/packet-filter/tables/#factory-default-rulesets","title":"Factory Default Rulesets","text":"<p>The device ships with these pre-configured rulesets (<code>def_serv=\"1\"</code>):</p> ID Name Layer Description 1 <code>ARP</code> L2 ARP address resolution 2 <code>ICMP_L2</code> L2 Allow all Layer 2 ICMP packets 3 <code>ICMP_L3</code> L3 Allow all Layer 3 ICMP packets 4 <code>Allow_L2</code> L2 Allow all L2 traffic 5 <code>Allow_L3</code> L3 Allow all L3 traffic 6 <code>Block_L2</code> L2 Block all L2 traffic 7 <code>Block_L3</code> L3 Block all L3 traffic 8 <code>Log_L2</code> L2 Log and block all packets 999 <code>Log_L3</code> L3 Log and block all packets <p>By default, only <code>ARP</code> (position 1) and <code>Allow_L2</code> (position 2) are activated in <code>selected_services</code>.</p>"},{"location":"guides/packet-filter/tables/#serv_protocols","title":"<code>serv_Protocols</code>","text":"<p>Individual filter rules within a ruleset. Each rule has 35 columns, grouped here by function.</p>"},{"location":"guides/packet-filter/tables/#core-columns","title":"Core Columns","text":"Index Column Type Description 0 <code>id</code> integer Primary key (no auto-increment); custom rules must use <code>1000</code>+ 1 <code>service_id</code> integer FK to <code>services.id</code> 2 <code>protocol</code> string Protocol name (<code>\"TCP\"</code>, <code>\"UDP\"</code>, <code>\"ICMP\"</code>, <code>\"*\"</code> for any); prefix <code>\"! \"</code> to negate 3 <code>action_id</code> <code>\"1\"</code>\u2013<code>\"8\"</code> Action to take (see Action IDs) 4 <code>log_active</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = log matched packets 5 <code>alarm_active</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = trigger alarm signal 6 <code>description</code> string Rule name (max 32 chars); also used as LOG prefix 7 <code>icmp_type</code> string ICMP type (e.g. <code>\"echo-request\"</code>, <code>\"any\"</code>); empty for non-ICMP 8 <code>icmp_rej_type</code> string ICMP reject type (e.g. <code>\"port-unreachable\"</code>); only for REJECT action 9 <code>limitpack</code> integer Rate limit in packets/second; empty for no limit 10 <code>position</code> integer Rule order within ruleset; lowest value first"},{"location":"guides/packet-filter/tables/#address-columns","title":"Address Columns","text":"Index Column Type Description 11 <code>src_mac_add</code> string Source MAC, <code>\"*\"</code>, <code>\"@groupname\"</code>, or <code>\"\"</code> (L2 only) 12 <code>src_ip_add</code> string Source IP, <code>\"*\"</code>, <code>\"@groupname\"</code>, or <code>\"\"</code> 13 <code>src_netmask</code> string Source netmask (e.g. <code>\"255.255.255.0\"</code>), <code>\"*\"</code>, or <code>\"\"</code> 14 <code>src_port</code> string Source port, range (<code>\"80:443\"</code>), <code>\"*\"</code>, or <code>\"\"</code> (TCP/UDP only) 15 <code>des_mac_add</code> string Destination MAC (L2 only) 16 <code>des_ip_add</code> string Destination IP, <code>\"*\"</code>, <code>\"@groupname\"</code>, or <code>\"\"</code> 17 <code>des_netmask</code> string Destination netmask 18 <code>des_port</code> string Destination port or range"},{"location":"guides/packet-filter/tables/#behavior-columns","title":"Behavior Columns","text":"Index Column Type Description 19 <code>prot_hex</code> string L2 protocol hex (e.g. <code>\"0800\"</code> for IPv4); empty for L3 20 <code>prot_transport</code> string L2 transport protocol number (e.g. <code>\"6\"</code> for TCP); empty for L3 21 <code>state_type_id</code> <code>\"1\"</code>\u2013<code>\"4\"</code> / <code>\"\"</code> <code>\"1\"</code>/<code>\"3\"</code> = conntrack; <code>\"2\"</code> = stateless (TCP flags) 22 <code>nat_ip</code> string Reserved \u2014 must be <code>\"\"</code> 23 <code>nat_port</code> string Reserved \u2014 must be <code>\"\"</code> 24 <code>states</code> string Conntrack states or TCP flags (depends on <code>state_type_id</code>) 25 <code>statevalue</code> integer L2 TCP flag bitmask; empty for L3 26 <code>revert</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"0\"</code> = normal; <code>\"1\"</code> = auto-generate reverse conntrack rule"},{"location":"guides/packet-filter/tables/#signal-visibility-columns","title":"Signal &amp; Visibility Columns","text":"<p>Signal fields must be <code>\\\"0\\\"</code> or <code>\\\"1\\\"</code>, never empty</p> <p>All <code>sigcheck_*</code>, <code>sig_*</code>, and <code>audit_active</code> fields must be set to <code>\"0\"</code> or <code>\"1\"</code> explicitly \u2014 never left as empty string <code>\"\"</code>. Factory default rules use empty strings internally, but the web UI expects all custom rules to have explicit values. Rules with empty signal fields may not display correctly in the web UI.</p> Index Column Type Description 27 <code>hide</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = suppress ALARM/CUT targets and logging for this rule 28 <code>sigcheck_vpn</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = apply VPN signal condition; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 29 <code>sig_vpn</code> <code>\"0\"</code> / <code>\"1\"</code> Expected VPN signal value; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 30 <code>sigcheck_cut</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = apply CUT signal condition; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 31 <code>sig_cut</code> <code>\"0\"</code> / <code>\"1\"</code> Expected CUT signal value; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 32 <code>sigcheck_vpnup</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = apply VPN-up signal condition; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 33 <code>sig_vpnup</code> <code>\"0\"</code> / <code>\"1\"</code> Expected VPN-up signal value; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty 34 <code>audit_active</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = enable AUDIT target; must be <code>\"0\"</code> or <code>\"1\"</code>, not empty"},{"location":"guides/packet-filter/tables/#action-ids","title":"Action IDs","text":"<code>action_id</code> Name Description <code>\"1\"</code> ACCEPT Allow the packet <code>\"2\"</code> DROP Silently discard the packet <code>\"5\"</code> CUT Drop the packet and activate the CUT signal <code>\"6\"</code> REJECT Reject with ICMP response (uses <code>icmp_rej_type</code>) <code>\"7\"</code> INACTIVE Rule is disabled \u2014 generates no iptables rule <code>\"8\"</code> CUTANDACCEPT Accept the packet and activate the CUT signal <p>Info</p> <p>Action IDs 3 and 4 do not exist.</p>"},{"location":"guides/packet-filter/tables/#selected_services","title":"<code>selected_services</code>","text":"<p>Activates a ruleset and optionally restricts it to a time window.</p> Index Column Type Description 0 <code>id</code> integer Primary key (no auto-increment); custom entries must use <code>1000</code>+ 1 <code>serv_id</code> integer FK to <code>services.id</code> 2 <code>days</code> string Comma-separated weekdays (e.g. <code>\"Mon,Tue,Wed,Thu,Fri\"</code>) or <code>\"\"</code> for all days 3 <code>time_active</code> <code>\"0\"</code> / <code>\"1\"</code> <code>\"1\"</code> = enable time restriction 4 <code>time_start</code> string Start time <code>HH:MM</code> (e.g. <code>\"08:00\"</code>) or <code>\"\"</code> 5 <code>time_stop</code> string Stop time <code>HH:MM</code> (e.g. <code>\"17:00\"</code>) or <code>\"\"</code> 6 <code>position</code> integer Ruleset evaluation order; lowest value first"},{"location":"guides/packet-filter/tables/#quick-reference","title":"Quick Reference","text":""},{"location":"guides/packet-filter/tables/#wildcard-and-negation-syntax","title":"Wildcard and Negation Syntax","text":"Syntax Applies to Meaning <code>\"*\"</code> IP, MAC, port, interface Match any <code>\"\"</code> (empty) IP, MAC, port, netmask Same as <code>\"*\"</code> (match any) <code>\"! value\"</code> IP, MAC, protocol, ICMP type Negation (space after <code>!</code> is required) <code>\"@groupname\"</code> IP, MAC Reference an <code>ipgroups</code> / <code>macgroups</code> entry <code>\"! @groupname\"</code> IP, MAC Negated group reference <code>\"80:443\"</code> port Port range <code>\":1024\"</code> port Ports up to 1024 <code>\"1024:\"</code> port Ports from 1024"},{"location":"guides/packet-filter/tables/#layer-ids","title":"Layer IDs","text":"<code>layer_id</code> Layer Backend Use for <code>\"1\"</code> L2 ebtables MAC-level filtering, ARP, non-IP protocols <code>\"2\"</code> L3 iptables IP-level filtering, TCP/UDP/ICMP"}]}